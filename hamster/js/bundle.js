!function(){"use strict";var e,t,i,a,n,s,o,r,h,l,d,c,g,m,u=Laya.View,v=Laya.Dialog,p=Laya.Scene,S=Laya.ClassUtils.regClass;!function(e){class t extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("AchievementView")}}e.AchievementViewUI=t,S("ui.AchievementViewUI",t);class i extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("ClothHamsterView")}}e.ClothHamsterViewUI=i,S("ui.ClothHamsterViewUI",i);class a extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("EggView")}}e.EggViewUI=a,S("ui.EggViewUI",a);class n extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("HamsterView")}}e.HamsterViewUI=n,S("ui.HamsterViewUI",n);class s extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("LoadingView")}}e.LoadingViewUI=s,S("ui.LoadingViewUI",s);class o extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("MainView")}}e.MainViewUI=o,S("ui.MainViewUI",o);class r extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("MissionView")}}e.MissionViewUI=r,S("ui.MissionViewUI",r);class h extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("NewGuideView")}}e.NewGuideViewUI=h,S("ui.NewGuideViewUI",h);class l extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("NewUserGiftView")}}e.NewUserGiftViewUI=l,S("ui.NewUserGiftViewUI",l);class d extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("OfflineRewardView")}}e.OfflineRewardViewUI=d,S("ui.OfflineRewardViewUI",d);class c extends v{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("ShopView")}}e.ShopViewUI=c,S("ui.ShopViewUI",c);class g extends v{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("SignView")}}e.SignViewUI=g,S("ui.SignViewUI",g);class m extends v{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("TopDialog")}}e.TopDialogUI=m,S("ui.TopDialogUI",m);class p extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("TreasureView")}}e.TreasureViewUI=p,S("ui.TreasureViewUI",p);class I extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("UpgradeIsland1")}}e.UpgradeIsland1UI=I,S("ui.UpgradeIsland1UI",I);class w extends u{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("UpgradeIslandView")}}e.UpgradeIslandViewUI=w,S("ui.UpgradeIslandViewUI",w)}(e||(e={})),function(e){!function(e){class t extends p{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("test/TestScene")}}e.TestSceneUI=t,S("ui.test.TestSceneUI",t)}(e.test||(e.test={}))}(e||(e={}));class I{constructor(){}static get instance(){return null==I._instance&&(I._instance=new I),I._instance}init(){this.event=new Laya.EventDispatcher}on(e,t,i){this.event.on(e,t,i)}off(e,t,i){this.event.off(e,t,i,!1)}fire(e,t){this.event.event(e,t)}fire2(e,t,i,a){let n=[];null!=t&&n.push(t),null!=i&&n.push(i),null!=a&&n.push(a),this.event.event(e,n)}}!function(e){e.updateGold="updateGold",e.addGold="addGold",e.subPackageLoadComplete="subPackageLoadComplete",e.subPackageLoadCompleteHamster="subPackageLoadCompleteHamster",e.subPackageLoadCompleteNpc="subPackageLoadCompleteNpc",e.updateHamsterCount="updateHamsterCount",e.diamondNotEnough="diamondNotEnough",e.goldNotEnough="goldNotEnough",e.signComplete="signComplete",e.newGuide_StartNextStep="newGuideStartNextStep",e.newGuide_CompleteStep="newGuideCompleteStep",e.newGuide_allComplete="newGuide_allComplete",e.newGuide_Start="newGuide_Start",e.newGuide_guideBowComplete="newGuide_guideBowComplete",e.newGuide_Click="newGuide_Click",e.newGuide_cgComplete="newGuide_cgComplete",e.ui_unlockIsland="ui_unlockIsland",e.ui_unlockIslandComplete="ui_unlockIslandComplete",e.ui_upgradeIsland="ui_upgradeIsland",e.ui_upgradeManager="ui_upgradeManager",e.ui_unlockManager="ui_unlockManager",e.ui_buyHamster="ui_buyHamster",e.ui_buyHamsterComplete="ui_buyHamsterComplete",e.ui_openUpgradeIslandView="ui_openUpgradeIslandView",e.ui_closeUpgradeIslandView="ui_closeUpgradeIslandView",e.ui_openHamsterView="ui_openHamsterView",e.ui_closeHamsterView="ui_closeHamsterView",e.ui_buyHamsterCloth="ui_buyHamsterCloth",e.ui_buyHamsterClothComplete="ui_buyHamsterClothComplete",e.ui_openMissionView="ui_openMissionView",e.ui_closeMissionView="ui_closeMissionView",e.ui_closeClothHamsterView="ui_closeClothHamsterView",e.ui_openClothHamsterView="ui_openClothHamsterView",e.ui_closeAchievementView="ui_closeAchievementView",e.ui_openAchievementView="ui_openAchievementView",e.hud_onClickTreasure="hud_onClickTreasure",e.treasure_lookHamster="treasure_lookHamster",e.treasure_arriveTarget="treasure_arriveTarget",e.treasure_digComplete="treasure_digComplete",e.mission_colloctHeart="mission_colloctHeart",e.mission_get="mission_get",e.doubleTimeStart="doubleTimeStart",e.doubleTimeOver="doubleTimeOver",e.logic_unlockManager="logic_unlockManager",e.egg_bornHamster="egg_bornHamster",e.egg_bornHamsterComplete="egg_bornHamsterComplete",e.gift_get="gift_get",e.vivo_ad_reportClick="vivo_ad_reportClick"}(t||(t={})),function(e){e[e.bullet=0]="bullet",e[e.hitEffect=1]="hitEffect",e[e.bombEffect=2]="bombEffect"}(i||(i={})),function(e){e[e.idle=0]="idle",e[e.unlock=1]="unlock",e[e.born=2]="born",e[e.unlockNpc=3]="unlockNpc",e[e.look=4]="look",e[e.zoom=5]="zoom"}(a||(a={})),function(e){e[e.Win=0]="Win",e[e.shooted=1]="shooted",e[e.enemy_escape=2]="enemy_escape",e[e.hostage_shooted=3]="hostage_shooted"}(n||(n={})),function(e){e[e.qq=1]="qq",e[e.wx=2]="wx",e[e.oppo=3]="oppo",e[e.vivo=4]="vivo",e[e.baidu=5]="baidu",e[e.web=6]="web",e[e.tt=7]="tt"}(s||(s={})),function(e){e[e.upgradeIsland=1]="upgradeIsland",e[e.unlockIsland=2]="unlockIsland",e[e.collectHeart=3]="collectHeart",e[e.upgradeManager=4]="upgradeManager",e[e.upgradeHamster=5]="upgradeHamster",e[e.digTreasure=6]="digTreasure",e[e.lookAd=7]="lookAd"}(o||(o={})),function(e){e[e.heart=1]="heart",e[e.gold=2]="gold",e[e.diamond=3]="diamond",e[e.doubleTicket=4]="doubleTicket"}(r||(r={})),function(e){e[e.unlockIsland=1]="unlockIsland",e[e.upgradeIsland=2]="upgradeIsland",e[e.buyHamster=3]="buyHamster",e[e.collectHeart=4]="collectHeart",e[e.completeMission=5]="completeMission",e[e.gameTime=6]="gameTime",e[e.lookAd=7]="lookAd"}(h||(h={})),function(e){e[e.ad=0]="ad",e[e.diamond=1]="diamond",e[e.share=2]="share",e[e.gift=3]="gift",e[e.egg=4]="egg"}(l||(l={})),function(e){e[e.idle=0]="idle",e[e.doing=1]="doing",e[e.wait=2]="wait"}(d||(d={}));class w{static getGuid(){return++w.GUID}static removeArr(e,t){var i=e.indexOf(t);return i>-1&&e.splice(i,1),e}static stringFormat(e,t){for(var i=0;i<t.length;i++){var a=new RegExp("\\{"+i+"\\}","gm");e=e.replace(a,t[i])}return e}static changeAngleTo360(e){return e>0?e>=360&&(e%=360):e<0&&(e<=-360&&(e%=360),e+=360),e}static splitStrToNum(e,t){var i=new Array,a=new Array;i=e.split(t);for(var n=0;n<i.length;n++)try{if(null==i[n])break;isNaN(i[n])?a[n]=i[n]:a[n]=JSON.parse(i[n])}catch(a){console.log("分割字符串错误："+e+"/// "+i[n]+"  flag = "+t)}return a}static splitStr(e,t,i){var a=new Array;return(a=e.split(t)).length>=2?((a=a[1].split(i)).length,a[0]):null}static findChildByName(e,t){let i=e.getChildByName(t);if(i)return i;for(let i=0;i<e.numChildren;i++){const a=e.getChildAt(i);if(a.numChildren>0){let e=w.findChildByName(a,t);if(null!=e)return e}}return null}static convert(e){if(e<1e3)return parseInt(e);let t=["K","M","G","B","T","aa","ab","ac","ad","ae","af","ag","ah","ai","aj","ak","al","am","an","ao","ap","aq","ar","as","at","au","av","aw","ax","ay","az","ba"],i=1e3,a=-1;for(;i<e;)a++,i*=1e3;return-1==a?e:a>=t.length?e:Math.floor(100*e*1e3/i)/100+t[a]}static getPlatformType(){return"undefined"!=typeof tt?s.tt:Laya.Browser.onMiniGame?s.wx:Laya.Browser.onQQMiniGame?s.qq:Laya.Browser.onQGMiniGame?s.oppo:Laya.Browser.onVVMiniGame?s.vivo:Laya.Browser.onBDMiniGame?s.baidu:s.vivo}static isIphoneX(){return Laya.stage.height/Laya.stage.width>=2}static random(e,t){return parseInt(Math.random()*(t-e+1)+e,10)}static vibrate(){Laya.Browser.onMiniGame?wx.vibrateShort({success:null,fail:null,complete:null}):Laya.Browser.onQGMiniGame?qg.vibrateShort({success:null,fail:null,complete:null}):Laya.Browser.onVVMiniGame?qg.vibrateShort({success:null,fail:null,complete:null}):Laya.Browser.onQQMiniGame&&qq.vibrateShort({success:null,fail:null,complete:null})}static vibrateLong(){Laya.Browser.onMiniGame?wx.vibrateLong({success:null,fail:null,complete:null}):Laya.Browser.onQGMiniGame?qg.vibrateLong({success:null,fail:null,complete:null}):Laya.Browser.onVVMiniGame&&qg.vibrateLong({success:null,fail:null,complete:null})}static playRewardEffect(e){let t="UI/gold1.png",i=213,a=53;e==r.gold?(t="UI/gold1.png",i=397,a=53,Oe.instance.soundManager.playSound("sound/rewardGold.mp3")):e==r.heart?(t="UI/heart.png",i=213,a=53,Oe.instance.soundManager.playSound("sound/rewardHeart.mp3")):e==r.diamond?(t="UI/diamond.png",i=582,a=53,Oe.instance.soundManager.playSound("sound/rewardDiamond.mp3")):e==r.doubleTicket&&(t="UI/doubleTicket.png",i=70,a=153);for(let e=0;e<10;e++){let e=new Laya.Image(t);Laya.Dialog.manager.addChild(e);let n=100,s=w.random(0,n)-.5*n+.5*Laya.stage.width,o=w.random(0,n)-.5*n+.5*Laya.stage.height;e.pos(s,o);let r=w.random(400,800);e.scaleY,Laya.Tween.to(e,{x:i,y:a},r,null,Laya.Handler.create(this,function(){e.removeSelf(),e.destroy()})),Laya.Tween.to(e,{scaleX:.2,scaleY:.2},r,null,Laya.Handler.create(this,function(){}))}}static showNoticeLabel(e){let t=new Laya.Label;t.font="Microsoft YaHei",t.text=e,t.fontSize=35,t.bold=!0,t.anchorX=.5,t.anchorY=.5,t.stroke=2,t.strokeColor="#000000",t.color="#ffffff",Laya.Dialog.manager.addChild(t);let i=.5*Laya.stage.height-50;t.pos(.5*Laya.stage.width,i);let a=i-80;Laya.Tween.to(t,{y:a},1e3,null,Laya.Handler.create(this,function(){t.removeSelf(),t.destroy()}))}static tweenMove(e,t,i,a,n){return Laya.Tween.to(e,{x:t.x,y:t.y,z:t.z,update:new Laya.Handler(this,function(){i(e)})},n,null,Laya.Handler.create(this,function(){a&&a()}))}static shareByPath(e,t){Laya.Browser.onMiniGame&&wx.shareAppMessage({imageUrl:"https://mmocgame.qpic.cn/wechatgame/0bGweE0KLlPUuLwcKicYbh7BQUFurlBuZDd1ZRer7ChxkhrXh0WOuwJNicvO6Tv1tY/0",title:"@所有人，选择一只最喜欢的仓鼠，送给你",ald_desc:e})}static isShareSuccess(e){let t=(new Date).getTime();if(Laya.Browser.onMiniGame){let i=function(a){let n=!1;((new Date).getTime()-t)/1e3>=3&&(n=!0),wx.offShow(i),e&&e(n)};wx.onShow(i)}else e&&e(!0)}static convertTime(e){var t=e,i=0,a=0,n=0;t>60&&(i=parseInt((t/60).toString()),t=parseInt((t%60).toString()),i>60&&(a=parseInt((i/60).toString()),i=parseInt((i%60).toString()),a>24&&(n=parseInt((a/24).toString()),a=parseInt((a%24).toString()))));var s="";return t>0&&(s=parseInt(t.toString())+"秒"),i>0&&(s=parseInt(i.toString())+"分"+s),a>0&&(s=parseInt(a.toString())+"小时"+s),n>0&&(s=parseInt(n.toString())+"天"+s),s}static wxShowNotice(e){if(Laya.Browser.onMiniGame){let t={title:"提示",content:"操作失败，请尝试不同群",showCancel:!0,confirmText:"去分享",confirmColor:"#5194b9",success:function(t){t.cancel?e&&e(!1):e&&e(!0)}};wx.showModal(t)}}static showSystemNotice(e){if(Laya.Browser.onMiniGame){let t={title:e,icon:"fail",duration:2e3};wx.showToast(t)}else if(Laya.Browser.onQGMiniGame){let t={title:e,icon:"success",duration:2e3};qg.showToast(t)}else if(Laya.Browser.onVVMiniGame){let t={message:e};qg.showToast(t)}}static oppoCreateTable(){}static setRankData(e){if(Laya.Browser.onMiniGame){var t=[],i={wxgame:{}};i.wxgame.value1=e,i.wxgame.update_time=Laya.Browser.now(),t.push({key:"goldRank",value:JSON.stringify(i)}),wx.setUserCloudStorage({KVDataList:t,success:function(e){},fail:function(e){console.log("-----fail:"+JSON.stringify(e))},complete:function(e){}})}}static statisticsData(e,t){let i=t?"success":"fail";w.getPlatformType()!=s.wx&&w.getPlatformType()!=s.tt||w.aldEventByType(e+i)}static statisticsDataByParam(e,t,i){let a=e+i?"success":"fail";w.getPlatformType()!=s.wx&&w.getPlatformType()!=s.tt||w.aldEventByTypeParam(e,a,t)}static aldEventByType(e){"undefined"==typeof tt&&(Laya.Browser.onMiniGame&&GameGlobal.tdAppSdk.event({id:e}))}static aldEventByTypeParam(e,t,i){"undefined"==typeof tt&&(Laya.Browser.onMiniGame&&GameGlobal.tdAppSdk.event({id:e,label:t,params:{key1:i}}))}static aldEventByTypeParam2(e,t,i){if("undefined"==typeof tt&&Laya.Browser.onMiniGame){var a=GameGlobal.tdAppSdk;var n={};n["key"+i]=i;let s=n;a.event({id:e,label:t,params:s})}}}w.GUID=1,w.vectorUp=new Laya.Vector3(0,1,0),w.vectorZero=new Laya.Vector3(0,0,0),w.vectorOne=new Laya.Vector3(1,1,1),w.blackColor=new Laya.Vector4(0,0,0,1),w.whileColor=new Laya.Vector4(1,1,1,1),w.yellowColor=new Laya.Vector4(1,1,0,1),w.greenColor=new Laya.Vector4(16/255,188/255,0,1),w.blueColor=new Laya.Vector4(47/255,164/255,1,1),function(e){e.ad_freeReward="视频免费",e.ad_getHamster="视频获取仓鼠",e.ad_newGift="视频新人礼包",e.ad_offline="离线双倍",e.ad_newGuideGift="新手引导完成奖励视频",e.ad_openBox="开启宝箱",e.ad_fiveBoxReward="5倍宝箱奖励",e.ad_getBox="广告领取宝箱",e.data_unlockIsland="解锁岛屿",e.data_upgradeIsland="升级岛屿",e.data_unlockManager="解锁管理员",e.data_upgradeManager="升级管理员",e.data_missionComplete="任务完成",e.data_eggStart="开始孵蛋",e.data_eggEnd="孵蛋完成领取",e.data_buyHamster="购买普通仓鼠",e.data_upgradeHamster="升级普通仓鼠",e.data_diamondHamsterCloth="钻石购买服装仓鼠",e.data_getAchievemnet="领取成就",e.data_newGuideComplete="完成新手引导",e.data_videoComplete="视频看完",e.data_loadGameComplete="游戏加载完成",e.data_loadGameStart="游戏加载开始",e.data_loadGameTime="游戏加载时长",e.data_newGuideStep="新手引导步数",e.data_loadGameTimeTest="游戏加载时长-流失卡点2"}(c||(c={}));class f{initData(e){this.id=JSON.parse(e.id),this.islandName=e.islandName,this.islandIcon=e.islandIcon,this.managerIcon=e.managerIcon,this.upgradeIcon=e.upgradeIcon,this.managerName=e.managerName,this.managerRes=e.managerRes,this.managerPath=e.managerPath,this.upgradeIslandCost=JSON.parse(e.upgradeIslandCost),this.goldCostFactor=JSON.parse(e.goldCostFactor),this.upgradeManagerHeartCost=JSON.parse(e.upgradeManagerHeartCost),this.managerHeartCostFactor=JSON.parse(e.managerHeartCostFactor),this.managerGoldOutputFactor=JSON.parse(e.managerGoldOutputFactor),this.goldOutputFactor=JSON.parse(e.goldOutputFactor),this.outputGold=JSON.parse(e.outputGold),this.outputTime=JSON.parse(e.outputTime);let t=w.splitStrToNum(e.areaCenter,"_");this.areaCenterX=-t[0],this.areaCenterY=t[1],this.areaCenterZ=t[2]}}class C{initData(e){this.id=JSON.parse(e.id),this.tex=e.tex,this.buyCost=JSON.parse(e.buyCost)}}class y{}y.MainView="MainView.scene",y.UpgradeIslandView="UpgradeIslandView.scene",y.HamsterView="HamsterView.scene",y.TopDialog="TopDialog.scene",y.MissionView="MissionView.scene",y.AchievementView="AchievementView.scene",y.NewGuideView="NewGuideView.scene",y.OfflineRewardView="OfflineRewardView.scene",y.NewUserGiftView="NewUserGiftView.scene",y.ClothHamsterView="ClothHamsterView.scene",y.EggView="EggView.scene",y.ShopView="ShopView.scene",y.TreasureView="TreasureView.scene",y.battleScenePath="unity/Conventional/Main.ls",y.resRootPath="unity/Conventional/",y.npcHamsterRootPath="hamsters/Conventional/",y.clothHamsterRootPath="clothHamster/Conventional/",y.mainRootPath="MainPrefab/Conventional/",y.startScene="LoadingView.scene",y.SCREEN_FIT_TOP=60,y.FLY_COIN_TIME=180,y.texPath="tex/",y.goldBg="UI/gold1.png",y.isJumpGuide_Test=!1,y.eggTotalTime=18e3,y.eggTotalDiamond=300,y.firstEggTotalTime=180,y.firstEggTotalDiamond=60,y.islandLevel1=5,y.islandLevel2=15,y.maxIslandLevel2=250,y.upgradeHeartProduceFactor=1.105,y.upgradeHeartCostFactor=1.325,y.sdk_line_version_qq=1,y.sdk_line_version_wx=2,y.sdk_line_version_tt=2;class B{initData(e){this.id=JSON.parse(e.id),this.simpleDesc=e.simpleDesc,this.desc=e.desc,this.missionType=JSON.parse(e.missionType),this.param1=JSON.parse(e.param1),this.param2=JSON.parse(e.param2),this.rewardType=JSON.parse(e.rewardType),this.rewardParam=JSON.parse(e.rewardParam)}}class L{initData(e){this.id=JSON.parse(e.id),this.icon=e.icon,this.title=e.title,this.desc=e.desc,this.achievementType=JSON.parse(e.achievementType),this.param1=JSON.parse(e.param1),this.param2=JSON.parse(e.param2),this.rewardType=JSON.parse(e.rewardType),this.rewardParam=JSON.parse(e.rewardParam)}}class A{initData(e){this.id=JSON.parse(e.id),this.hamsterName=e.hamsterName,this.icon=e.icon,this.res=e.res,this.unlockType=JSON.parse(e.unlockType),this.param=JSON.parse(e.param),this.heartFactor=JSON.parse(e.heartFactor),this.goldFactor=JSON.parse(e.goldFactor)}}!function(e){e.onlineTimeData="onlineTimeData",e.goldData="goldData",e.heartData="heartData",e.diamondData="diamondData",e.freeGoldData="freeGoldData",e.freeHeartData="freeHeartData",e.freeDiamondData="freeDiamondData",e.missionData="missionData",e.isFirstLoginEveryDay="isFirstLoginEveryDay",e.doubleTimeData="doubleTimeData",e.eggData="eggData",e.loginTime="loginTime",e.islandDataInfo="islandDataInfo",e.hamsterNormalData="hamsterNormalData",e.hamsterLevelData="hamsterLevelData",e.achievementData="achievementData",e.hamsterClothData="hamsterClothData",e.clothAdIdData="clothAdIdData",e.newGiftAdTimesData="newGiftAdTimesData",e.lookAdTimesData="lookAdTimesData",e.isFirstEggData="isFirstEggData",e.isFirstTreasureData="isFirstTreasureData",e.missionColloctHeartTimesData="missionColloctHeartTimesData",e.achievementColloctHeartTimesData="achievementColloctHeartTimesData"}(g||(g={}));class D{constructor(){this.missionColloctHeartTimes=0,this.achievementColloctHeartTimes=0,this.doubleTime=0,this.mIslandDataInfos=[],this.mHamsterNormals=[],this.mHamsterCloths=[],this.mHamsterLevel=1,this.mAchievementDataInfos=[],this.mAchievementListInfos=[],this.mClothAdIds=[],this.mNewGiftAdTimes=0,this.mLookAdTimes=0,this.islandConfigs=[],this.normalConfigs=[],this.missionConfigs=[],this.achievementConfigs=[],this.clothHamsterConfigs=[]}init(){y.isJumpGuide_Test,this.mGold=500,this.mHeart=0,this.mDiamond=0,this.mFreeGoldTimes=5,this.mFreeHeartTimes=5,this.mFreeDiamondTimes=5,this.offlineTime=0,this.onlineTime=0,this.doubleTime=0,this.mHamsterLevel=1,this.mMissionId=1,this.missionColloctHeartTimes=0,this.achievementColloctHeartTimes=0,this.mClothAdIds=[],this.mNewGiftAdTimes=0,this.mLookAdTimes=0,this.mIsFirstEgg=!0,this.mIsFirstTreasure=!0,this.mIsSign=!1,this.mSignTimes=0,this.mHadSignDayNum=0,this.mIsFirstLoginEveryDay=!0,this.eggInfo=new P,this.eggInfo.time=0,this.eggInfo.state=d.idle}getCacheStorage(e){return localStorage.getItem(e)}setCacheStorage(e,t){try{localStorage.setItem(e,t)}catch(e){}}loadCache(){let e=localStorage.getItem("newGuideComplete");null!=e&&""!=e||localStorage.clear();var t=this.getCacheStorage(g.isFirstLoginEveryDay);null!=t&&""!=t&&(this.mIsFirstLoginEveryDay=JSON.parse(t));var i=this.getCacheStorage(g.onlineTimeData);null!=i&&""!=i&&(this.onlineTime=JSON.parse(i));var a=this.getCacheStorage(g.doubleTimeData);null!=a&&""!=a&&(this.doubleTime=JSON.parse(a));var n=this.getCacheStorage(g.goldData);null!=n&&""!=n&&(this.mGold=JSON.parse(n));var s=this.getCacheStorage(g.heartData);null!=s&&""!=s&&(this.mHeart=JSON.parse(s));var o=this.getCacheStorage(g.diamondData);null!=o&&""!=o&&(this.mDiamond=JSON.parse(o));var r=this.getCacheStorage(g.freeGoldData);null!=r&&""!=r&&(this.mFreeGoldTimes=JSON.parse(r));var h=this.getCacheStorage(g.freeHeartData);null!=h&&""!=h&&(this.mFreeHeartTimes=JSON.parse(h));var l=this.getCacheStorage(g.freeDiamondData);null!=l&&""!=l&&(this.mFreeDiamondTimes=JSON.parse(l));var c=this.getCacheStorage(g.missionData);null!=c&&""!=c&&(this.mMissionId=JSON.parse(c));var m=this.getCacheStorage(g.missionColloctHeartTimesData);null!=m&&""!=m&&(this.missionColloctHeartTimes=JSON.parse(m));var u=this.getCacheStorage(g.achievementColloctHeartTimesData);null!=u&&""!=u&&(this.achievementColloctHeartTimes=JSON.parse(u));var v=this.getCacheStorage(g.islandDataInfo);null!=v&&""!=v&&(this.mIslandDataInfos=JSON.parse(v));var p=this.getCacheStorage(g.hamsterNormalData);null!=p&&""!=p&&(this.mHamsterNormals=JSON.parse(p));var S=this.getCacheStorage(g.hamsterLevelData);null!=S&&""!=S&&(this.mHamsterLevel=JSON.parse(S));var I=this.getCacheStorage(g.achievementData);null!=I&&""!=I&&(this.mAchievementDataInfos=JSON.parse(I));var w=this.getCacheStorage(g.hamsterClothData);null!=w&&""!=w&&(this.mHamsterCloths=JSON.parse(w));var f=this.getCacheStorage(g.clothAdIdData);null!=f&&""!=f&&(this.mClothAdIds=JSON.parse(f));var C=this.getCacheStorage(g.newGiftAdTimesData);null!=C&&""!=C&&(this.mNewGiftAdTimes=JSON.parse(C));var y=this.getCacheStorage(g.lookAdTimesData);null!=y&&""!=y&&(this.mLookAdTimes=JSON.parse(y));var B=this.getCacheStorage(g.isFirstEggData);null!=B&&""!=B&&(this.mIsFirstEgg=JSON.parse(B));var L=this.getCacheStorage(g.isFirstTreasureData);null!=L&&""!=L&&(this.mIsFirstTreasure=JSON.parse(L));var A=this.getCacheStorage(g.loginTime),D=new Date;let b=D.getTime(),N=D.getDate(),k=D.getMonth();if(this.mHadSignDayNum=this.mSignTimes,null!=A&&""!=A){let e=JSON.parse(A);this.offlineTime=(b-e.time)/1e3,this.mHadSignDayNum=e.signDayNum,b-864e5>=e.time||N>e.day||k>e.month?(this.mIsFirstLoginEveryDay=!0,this.setCacheStorage(g.isFirstLoginEveryDay,JSON.stringify(!1)),this.setFreeGoldTimes(5),this.setFreeHeartTimes(5),this.setFreeDiamondTimes(5),this.mIsSign=e.sign,1==this.mIsSign?this.mSignTimes=e.signDayNum+1:this.mSignTimes=e.signDayNum,this.mIsSign=!1,this.mSignTimes>=7&&(this.mSignTimes=0),this.mHadSignDayNum=this.mSignTimes):(this.mIsSign=e.sign,this.mSignTimes=e.signDayNum)}let P={time:b,day:N,month:k,num:1,sign:this.mIsSign,signDayNum:this.mHadSignDayNum};this.setCacheStorage(g.loginTime,JSON.stringify(P));var T=this.getCacheStorage(g.eggData);if(null!=T&&""!=T){let e=JSON.parse(T);if(this.eggInfo.state=e.state,this.eggInfo.time=e.time,this.eggInfo.startTime=e.startTime,this.eggInfo.state==d.doing){let t=(b-e.startTime)/1e3;this.eggInfo.time-=t,this.eggInfo.time<=0&&(this.eggInfo.time=0,this.eggInfo.state=d.wait)}}}setFirstLoginEveryDay(){this.mIsFirstLoginEveryDay=!1,this.setCacheStorage(g.isFirstLoginEveryDay,JSON.stringify(this.mIsFirstLoginEveryDay))}sign(){this.mIsSign=!0;var e=new Date;let i={time:e.getTime(),day:e.getDate(),month:e.getMonth(),num:1,sign:this.mIsSign,signDayNum:this.mSignTimes};this.mHadSignDayNum=this.mSignTimes,I.instance.fire(t.signComplete),this.setCacheStorage(g.loginTime,JSON.stringify(i))}setGameTime(){this.onlineTime+=.5,this.setLoginTime(),this.setCacheStorage(g.onlineTimeData,this.onlineTime.toString())}setLoginTime(){var e=new Date;let t={time:e.getTime(),day:e.getDate(),month:e.getMonth(),num:1,sign:this.mIsSign,signDayNum:this.mHadSignDayNum};this.setCacheStorage(g.loginTime,JSON.stringify(t))}setIsFirstEgg(){this.mIsFirstEgg=!1,this.setCacheStorage(g.isFirstEggData,JSON.stringify(this.mIsFirstEgg))}setIsFirstTreasure(){this.mIsFirstTreasure=!1,this.setCacheStorage(g.isFirstTreasureData,JSON.stringify(this.mIsFirstTreasure))}setEggInfo(e,t){this.eggInfo.state=e,this.eggInfo.time=t,this.setCacheStorage(g.eggData,JSON.stringify(this.eggInfo))}setStartEgg(e){this.eggInfo.state=d.doing,this.eggInfo.time=e;let t=(new Date).getTime();this.eggInfo.startTime=t,this.setCacheStorage(g.eggData,JSON.stringify(this.eggInfo))}addLookAdTimes(){return this.mLookAdTimes++,this.setCacheStorage(g.lookAdTimesData,this.mLookAdTimes.toString()),this.mLookAdTimes}setFreeGoldTimes(e){this.mFreeGoldTimes=e,this.setCacheStorage(g.freeGoldData,this.mFreeGoldTimes.toString())}setFreeHeartTimes(e){this.mFreeHeartTimes=e,this.setCacheStorage(g.freeHeartData,this.mFreeHeartTimes.toString())}setFreeDiamondTimes(e){this.mFreeDiamondTimes=e,this.setCacheStorage(g.freeDiamondData,this.mFreeDiamondTimes.toString())}addGold(e){e=Math.floor(e),this.mGold+=e,this.setCacheStorage(g.goldData,this.mGold.toString()),I.instance.fire(t.updateGold,this.mGold),I.instance.fire(t.addGold,e)}subGold(e){e=Math.floor(e),this.mGold<e||(this.mGold-=e,this.setCacheStorage(g.goldData,this.mGold.toString()),I.instance.fire(t.updateGold,this.mGold))}addHeart(e){e=Math.floor(e),this.mHeart+=e,this.setCacheStorage(g.heartData,this.mHeart.toString()),I.instance.fire(t.updateGold,this.mHeart)}subHeart(e){e=Math.floor(e),this.mHeart<e||(this.mHeart-=e,this.setCacheStorage(g.heartData,this.mHeart.toString()),I.instance.fire(t.updateGold,this.mHeart))}addDiamond(e){e=Math.floor(e),this.mDiamond+=e,this.setCacheStorage(g.diamondData,this.mDiamond.toString()),I.instance.fire(t.updateGold,this.mDiamond)}subDiamond(e){e=Math.floor(e),this.mDiamond<e||(this.mDiamond-=e,this.setCacheStorage(g.diamondData,this.mDiamond.toString()),I.instance.fire(t.updateGold,this.mDiamond))}startDouble(e){this.doubleTime+=e,this.setCacheStorage(g.doubleTimeData,this.doubleTime.toString()),I.instance.fire(t.doubleTimeStart,this.doubleTime)}setDoubleTime(e){this.doubleTime=e,((e=Math.floor(e))%5==0||e<=0)&&(e<=0&&(this.doubleTime=0,I.instance.fire(t.doubleTimeOver)),this.setCacheStorage(g.doubleTimeData,this.doubleTime.toString()))}upgradeIslandById(e){let t=this.getIslandInfoById(e);null==t&&((t=new b).islandId=e,t.islandLevel=0,t.managerLevel=0,this.mIslandDataInfos.push(t)),t.islandLevel++,this.setCacheStorage(g.islandDataInfo,JSON.stringify(this.mIslandDataInfos))}getIslandInfoById(e){for(let t=0;t<this.mIslandDataInfos.length;t++){const i=this.mIslandDataInfos[t];if(i.islandId==e)return i}let t=new b;return t.islandId=e,t.islandLevel=0,t.managerLevel=0,this.mIslandDataInfos.push(t),t}getUnlockIslandInfos(){let e=[];for(let t=0;t<this.mIslandDataInfos.length;t++){const i=this.mIslandDataInfos[t];i.islandLevel>0&&e.push(i)}return e}getLockIslandInfos(){let e=[];for(let t=0;t<this.mIslandDataInfos.length;t++){const i=this.mIslandDataInfos[t];0==i.islandLevel&&e.push(i)}return e}getIslandConfigById(e){return this.islandConfigs[e-1]}upgradeManagerLevelById(e){let t=this.getIslandInfoById(e);null==t&&((t=new b).islandId=e,t.islandLevel=0,t.managerLevel=0,this.mIslandDataInfos.push(t)),t.managerLevel++,this.setCacheStorage(g.islandDataInfo,JSON.stringify(this.mIslandDataInfos))}getNormalConfgById(e){let t=e-1;return t=t>=0?t:0,this.normalConfigs[t]}getHeartProduce(){let e=10,t=this.mHamsterNormals.length,i=Math.pow(y.upgradeHeartProduceFactor,this.mHamsterLevel-1);e=e*t*Math.pow(5,t-1)*i;let a=this.getAddHeartFactor();return 0!==a&&(e*=1+a),e}getGoldTotalProduce(){let e=0;for(let t=0;t<this.mIslandDataInfos.length;t++){const i=this.mIslandDataInfos[t];if(i.islandLevel<=0)continue;let a=this.getIslandConfigById(i.islandId);e+=this.getIslandOutputGoldByCfg(a,i.islandLevel,i.managerLevel)/a.outputTime}let t=this.getAddGoldFactor();return 0!==t&&(e*=1+t),e}buyHamsterNormal(e){this.mHamsterNormals.push(e),this.setCacheStorage(g.hamsterNormalData,JSON.stringify(this.mHamsterNormals)),I.instance.fire(t.updateHamsterCount,this.mHamsterNormals.length+this.mHamsterCloths.length)}upgradeHamsterNormal(){this.mHamsterLevel++,this.setCacheStorage(g.hamsterLevelData,this.mHamsterLevel.toString())}getIslandOutputGoldByCfg(e,t,i){return e.outputGold*Math.pow(e.goldOutputFactor,t-1)*Math.pow(e.managerGoldOutputFactor,i)}getAddGoldFactor(){let e=0;for(let t=0;t<this.mHamsterCloths.length;t++){const i=this.mHamsterCloths[t];e+=this.getClothHamsterConfigById(i).goldFactor-1}return e}getAddHeartFactor(){let e=0;for(let t=0;t<this.mHamsterCloths.length;t++){const i=this.mHamsterCloths[t];e+=this.getClothHamsterConfigById(i).heartFactor-1}return e}buyHamsterCloth(e){this.mHamsterCloths.push(e),this.setCacheStorage(g.hamsterClothData,JSON.stringify(this.mHamsterCloths)),I.instance.fire(t.updateHamsterCount,this.mHamsterNormals.length+this.mHamsterCloths.length)}getClothCountById(e){let t=0;for(let i=0;i<this.mHamsterCloths.length;i++){this.mHamsterCloths[i]==e&&t++}return t}getMissionConfigById(e){return this.missionConfigs[e-1]}getCurMissionConfig(){return this.mMissionId>=this.missionConfigs.length&&(this.mMissionId=this.missionConfigs.length),this.missionConfigs[this.mMissionId-1]}getCurMissionDesc(){let e=this.getCurMissionConfig(),t=e.desc;return e.missionType==o.collectHeart||e.missionType==o.upgradeHamster||e.missionType==o.digTreasure||e.missionType==o.lookAd?t=w.stringFormat(e.desc,[e.param1]):e.missionType!=o.upgradeIsland&&e.missionType!=o.upgradeManager||(t=w.stringFormat(e.desc,[e.param2])),t}missionComplete(){this.mMissionId++,this.setCacheStorage(g.missionData,this.mMissionId.toString())}setMissionCollectHeartTimes(e){this.missionColloctHeartTimes=e,this.setCacheStorage(g.missionColloctHeartTimesData,this.missionColloctHeartTimes.toString())}setAchievementCollectHeartTimes(e){this.achievementColloctHeartTimes=e,this.setCacheStorage(g.achievementColloctHeartTimesData,this.achievementColloctHeartTimes.toString())}getAchievementConfigByType(e){for(let t=0;t<this.mAchievementListInfos.length;t++){const i=this.mAchievementListInfos[t];if(i.achievementType==e)return i.index>=i.configs.length?null:i.configs[i.index]}return null}getAchievementListInfoByType(e){for(let t=0;t<this.mAchievementListInfos.length;t++){const i=this.mAchievementListInfos[t];if(i.achievementType==e)return i}}completeAchievementInfoByType(e){let t=this.getAchievementDataInfoByType(e);null==t&&((t=new N).achievementType=e,t.index=0,this.mAchievementDataInfos.push(t)),t.index++,this.setCacheStorage(g.achievementData,JSON.stringify(this.mAchievementDataInfos));let i=this.getAchievementListInfoByType(e);null!=i&&(i.index=t.index)}getAchievementDataInfoByType(e){for(let t=0;t<this.mAchievementDataInfos.length;t++){const i=this.mAchievementDataInfos[t];if(i.achievementType==e)return i}return null}getClothHamsterConfigs(){return this.clothHamsterConfigs}getClothHamsterConfigById(e){return this.clothHamsterConfigs[e-1]}addNewGiftAdTimes(){return this.mNewGiftAdTimes++,this.setCacheStorage(g.newGiftAdTimesData,this.mNewGiftAdTimes.toString()),this.mNewGiftAdTimes}addClothAdTimesById(e){let t=this.getClothAdTimesDataById(e);return null==t?(t={id:e,times:1},this.mClothAdIds.push(t)):t.times++,this.setCacheStorage(g.clothAdIdData,JSON.stringify(this.mClothAdIds)),t.times}resetClothAdTimesById(e){let t=this.getClothAdTimesDataById(e);return null==t?(t={id:e,times:0},this.mClothAdIds.push(t)):t.times=0,this.setCacheStorage(g.clothAdIdData,JSON.stringify(this.mClothAdIds)),t.times}getClothAdTimesById(e){let t=this.getClothAdTimesDataById(e);return null==t?0:t.times}getClothAdTimesDataById(e){if(null==this.mClothAdIds||this.mClothAdIds.length<=0)return null;for(let t=0;t<this.mClothAdIds.length;t++){const i=this.mClothAdIds[t];if(i.id==e)return i}return null}getRewardInfoByType(e,t){let i={rewardDesc:"",iconSkin:""};switch(e){case r.heart:i.rewardDesc="爱心礼包 "+t+"分钟收益",i.iconSkin="UI/rewardHeartIcon.png";break;case r.gold:i.rewardDesc="金币礼包 "+t+"分钟收益",i.iconSkin="UI/rewardGoldIcon.png";break;case r.diamond:i.rewardDesc="钻石 "+t+"个",i.iconSkin="UI/rewardDiamondIcon.png";break;case r.doubleTicket:i.rewardDesc="双倍收益 持续"+t+"分钟",i.iconSkin="UI/rewardDoubleIcon.png"}return i}loadIslandConfig(e){for(let t=0;t<e.length;t++){const i=e[t];let a=new f;a.initData(i),this.islandConfigs.push(a)}}loadNormalConfig(e){for(let t=0;t<e.length;t++){const i=e[t];let a=new C;a.initData(i),this.normalConfigs.push(a)}}getAllHamsterCount(){return this.mHamsterNormals.length}loadMissionConfig(e){for(let t=0;t<e.length;t++){const i=e[t];let a=new B;a.initData(i),this.missionConfigs.push(a)}}loadAchievementConfig(e){for(let t=0;t<e.length;t++){const i=e[t];let a=new L;a.initData(i),this.achievementConfigs.push(a)}this.setAchievementListInfos()}loadClothHamsterConfig(e){for(let t=0;t<e.length;t++){const i=e[t];let a=new A;a.initData(i),this.clothHamsterConfigs.push(a)}}setAchievementListInfos(){let e=0;for(let t=0;t<this.achievementConfigs.length;t++){const i=this.achievementConfigs[t];i.achievementType>e&&(e=i.achievementType)}for(let t=1;t<=e;t++){let e=new k;e.achievementType=t;let i=this.getAchievementDataInfoByType(t);e.index=null==i?0:i.index;for(let i=0;i<this.achievementConfigs.length;i++){const a=this.achievementConfigs[i];a.achievementType==t&&e.configs.push(a)}this.mAchievementListInfos.push(e)}}}class b{}class N{}class k{constructor(){this.configs=[]}}class P{}class T{init(){}openScene(e,t,i){null==i&&(i=!0);let a=[t];Laya.Scene.open(e,i,null,Laya.Handler.create(this,this.onOpenCompleteScene,a))}onOpenCompleteScene(e,t){e&&e.runWith(t)}loadScene(e,t){let i=[t];Laya.Scene.load(e,Laya.Handler.create(this,this.onCompleteScene,i))}onCompleteScene(e,t){e&&e.runWith(t)}loadScene3D(e,t){let i=[t];Laya.Scene3D.load(e,Laya.Handler.create(this,this.onCompleteScene3D,i))}onCompleteScene3D(e,t){this.scene3D=t,Laya.stage.addChildAt(t,0),e&&e.runWith(t)}}class x{constructor(){}init(){}loadPrefab3D(e,t,i,a){Laya.Sprite3D.load(e,Laya.Handler.create(i,t,a))}loadTexture(e,t){Laya.Texture2D.load(e,t)}loadMaterial(e,t){Laya.BaseMaterial.load(e,t)}load(e,t){Laya.loader.load(e,Laya.Handler.create(this,t))}}class G{constructor(){}init(){}onceExecute(e,t,i,a,n){e*=1e3,Laya.timer.once(e,t,i,a,n)}clear(e,t){Laya.timer.clear(e,t)}clearAll(e){Laya.timer.clearAll(e)}loop(e,t,i,a){e*=1e3,Laya.timer.loop(e,t,i,a)}framLoop(e,t,i){Laya.timer.frameLoop(1,e,t,i)}frameOnce(e,t,i){Laya.timer.frameOnce(e,t,i)}}class _{init(){}showBlock(){}showBannerAd(){null!=this.bannerAd&&(Laya.Browser.onQQMiniGame?this.bannerAd.show():Laya.Browser.onMiniGame&&this.bannerAd.show())}hideBannerAd(){}showAd(e,t){}initBoxAd(){}showBoxAd(e){e&&e(!1)}showToastFail(e){let t={title:e,icon:"fail",duration:2e3};wx.showToast(t)}showInterstitialAd(){}addLookAdTimes(){Oe.instance.userData.addLookAdTimes()}}class M extends _{constructor(){super(...arguments),this.adUnitId_BoxAd="fdf36ef9b4cb4daafeaa286b3dafce27",this.adUnitId_BannerAd_qq="3c331116ec5c2c2e56bd42b9602e72c5",this.adUnitId_VideoAd="119bd3fe0a442ee72cb26d0c6a9e92d0",this.closeAppBoxBack=null}init(){this.initBanner(),this.initBoxAd()}initBlock(){if(Laya.Browser.onQQMiniGame){if(!qq.createBlockAd)return;let e=Laya.Browser.height;console.log(e),this.blockAd&&(this.blockAd.offError(),this.blockAd.destroy());let t=0;Laya.stage.height/Laya.stage.width>=2&&(t=60),this.blockAd=qq.createBlockAd({adUnitId:"402efe28b3e9989844463ee90d298363",size:4,orientation:"landscape",style:{left:130,top:e/2-30}});this.blockAd.onResize(e=>{console.log(e)}),this.blockAd.onLoad(function(){console.log("积木加载  成功")}),this.blockAd.onError(function(e){console.log("积木加载  失败"),console.log(e)})}}showBlock(){this.blockAd&&this.blockAd.show()}initBanner(){if(!Laya.Browser.onQQMiniGame)return;console.log("initBanner");let e=qq.getSystemInfoSync(),t=0;w.isIphoneX()&&(t=20),this.bannerAd=qq.createBannerAd({adUnitId:this.adUnitId_BannerAd_qq,adIntervals:30,style:{left:(e.windowWidth-300)/2,top:e.windowHeight-80-t,width:300}}),this.bannerAd.onResize(i=>{this.bannerAd.style.top=e.windowHeight-this.bannerAd.style.realHeight-t}),this.bannerAd.onLoad(function(){console.log("initBanner onLoad  成功")}),this.bannerAd.onError(function(e){console.log("onError  失败"),console.log(JSON.stringify(e))})}showBannerAd(){console.log("showBannerAd  banner"),Laya.Browser.onQQMiniGame&&null!=this.bannerAd&&Laya.Browser.onQQMiniGame&&this.bannerAd.show()}hideBannerAd(){if(Laya.Browser.onQQMiniGame&&null!==this.bannerAd)return console.log("隐藏  banner"),this.bannerAd.hide(),void this.refreshBannerAd()}refreshBannerAd(){if(Laya.Browser.onQQMiniGame){let e=80,t=300;this.bannerAd&&this.bannerAd.destroy();let i=0;w.isIphoneX()&&(i=20);let a=qq.getSystemInfoSync();Oe.instance.errorTouchManager.getIsOpenErrorTouch()&&(t=a.windowWidth),this.bannerAd=qq.createBannerAd({adUnitId:this.adUnitId_BannerAd_qq,adIntervals:30,style:{left:(a.windowWidth-t)/2,top:a.windowHeight-e-i,width:t}}),this.bannerAd.onResize(e=>{this.bannerAd.style.top=a.windowHeight-this.bannerAd.style.realHeight-i}),this.bannerAd.onLoad(function(){console.log("showBannerAd  成功")}),this.bannerAd.onError(function(e){console.log("showBannerAd  失败"),console.log(e)})}}initBoxAd(){if(Laya.Browser.onQQMiniGame){if(!qq.createAppBox)return;let e=this,t=function(){e.closeAppBoxBack&&e.closeAppBoxBack(!0),e.appbox.load(),console.log("关闭盒子")};this.appbox=qq.createAppBox({adUnitId:this.adUnitId_BoxAd}),this.appbox.onClose(t),this.appbox.load().then(()=>{console.log("加载盒子")})}}showBoxAd(e){if(Laya.Browser.onQQMiniGame||e&&e(!1),Laya.Browser.onQQMiniGame){if(!this.appbox)return void(e&&e(!1));this.closeAppBoxBack=e,console.log("显示盒子"),this.appbox.show()}}showAd(e,t){if(!Laya.Browser.onQQMiniGame)return void(e&&e(!0));console.log("开始广告");let i=this.adUnitId_VideoAd;this.RewardedVideoAd=qq.createRewardedVideoAd({adUnitId:i}),this.RewardedVideoAd.onError(function(t){console.log("加载广告失败"+JSON.stringify(t)),a.showToastFail("加载广告失败"),e&&e(!1)});let a=this;this.RewardedVideoAd.offClose(),this.RewardedVideoAd.onClose(function(t){console.log("关闭广告"),t&&t.isEnded||void 0===t?(console.log("视频回调成功"),this.addLookAdTimes(),e&&e(!0)):(console.log("关闭视频无奖励"),a.showToastFail("未看完,无奖励"),e&&e(!1))}),a.RewardedVideoAd.show().catch(function(e){a.RewardedVideoAd.load().then(function(){a.RewardedVideoAd.show()})})}showToastFail(e){if(!Laya.Browser.onQQMiniGame)return;let t={title:e,icon:"fail",duration:2e3};qq.showToast(t)}}class H extends _{constructor(){super(...arguments),this.adUnitId_BannerAd="adunit-ae3f4cb3a745ca73",this.adUnitId_VideoAd="adunit-c65f39277e8b61cf"}init(){this.initBanner()}initBanner(){if(Laya.Browser.onMiniGame){let e=50,t=300,i=wx.getSystemInfoSync();this.bannerAd=wx.createBannerAd({adUnitId:this.adUnitId_BannerAd,adIntervals:30,style:{left:(i.windowWidth-t)/2,top:i.windowHeight-e,width:t}}),this.bannerAd.onResize(e=>{this.bannerAd.style.top=i.windowHeight-this.bannerAd.style.realHeight});let a=this;a.isBannerLoadSuccess=!1,this.bannerAd.onLoad(function(){console.log("showBannerAd  成功"),a.isBannerLoadSuccess=!0}),this.bannerAd.onError(function(e){console.log("showBannerAd  失败"),console.log(e),a.isBannerLoadSuccess=!1})}}refreshBannerAd(){if(Laya.Browser.onMiniGame){let e=50,t=300;this.bannerAd&&(this.bannerAd.offError(),this.bannerAd.destroy());let i=wx.getSystemInfoSync();this.bannerAd=wx.createBannerAd({adUnitId:this.adUnitId_BannerAd,adIntervals:30,style:{left:(i.windowWidth-t)/2,top:i.windowHeight-e,width:t}}),this.bannerAd.onResize(e=>{this.bannerAd.style.top=i.windowHeight-this.bannerAd.style.realHeight});let a=this;a.isBannerLoadSuccess=!1,this.bannerAd.onLoad(function(){console.log("showBannerAd  成功"),a.isBannerLoadSuccess=!0}),this.bannerAd.onError(function(e){console.log("showBannerAd  失败"),console.log(e),a.isBannerLoadSuccess=!1})}}showBannerAd(){null!=this.bannerAd&&this.isBannerLoadSuccess?(console.log("拉取成功  直接显示"),this.bannerAd.show()):this.showGuessLike()}hideBannerAd(){this.hideGuessLike(),this.refreshBannerAd()}showGuessLike(){}hideGuessLike(){this.guessLike&&(this.guessLike.closeEffect=null,this.guessLike.close(),this.guessLike=null)}showAd(e,t){if(!Laya.Browser.onMiniGame)return this.addLookAdTimes(),void(e&&e(!0));console.log("开始广告");let i=this.adUnitId_VideoAd;this.RewardedVideoAd=wx.createRewardedVideoAd({adUnitId:i}),this.RewardedVideoAd.onError(function(t){console.log("加载广告失败"+JSON.stringify(t)),a.showToastFail("加载广告失败"),e&&e(!1)});let a=this;this.RewardedVideoAd.offClose(),this.RewardedVideoAd.onClose(function(t){console.log("关闭广告"),Oe.instance.soundManager.resumeMusic(),t&&t.isEnded||void 0===t?(console.log("视频回调成功"),a.addLookAdTimes(),e&&e(!0)):(console.log("关闭视频无奖励"),a.showToastFail("未看完,无奖励"),e&&e(!1))}),a.RewardedVideoAd.show().catch(function(e){a.RewardedVideoAd.load().then(function(){a.RewardedVideoAd.show()})})}showToastFail(e){let t={title:e,icon:"fail",duration:2e3};wx.showToast(t)}}class K extends _{constructor(){super(...arguments),this.adUnitId_BannerAd="32ck24f3pdehaox42p",this.adUnitId_VideoAd="g1212aec01520ec1h5",this.adUnitId_InterstitialAd="5v5e731q7mh25hhlg1",this.interstitialAd=null,this.curSecondAd=!1}init(){this.initBanner(),this.initVideoAd()}showInterstitialAd(){if("undefined"==typeof tt)return;const e=tt.getSystemInfoSync();"Toutiao"===e.appName&&"ios"!==e.platform&&tt.createInterstitialAd&&(this.interstitialAd&&this.interstitialAd.destroy(),this.interstitialAd=tt.createInterstitialAd({adUnitId:this.adUnitId_InterstitialAd}),this.interstitialAd.load().then(()=>{this.interstitialAd.show()}).catch(e=>{console.log(e)}))}initBanner(){if("undefined"!=typeof tt&&tt&&tt.createBannerAd&&Laya.Browser.onMiniGame){let e=tt.getSystemInfoSync(),t=80,i=200;this.bannerAd&&this.bannerAd.destroy(),this.bannerAd=tt.createBannerAd({adUnitId:this.adUnitId_BannerAd,style:{left:(e.windowWidth-i)/2,top:e.windowHeight-t,width:i}}),this.bannerAd.onResize(t=>{console.log(t),this.bannerAd.style.top=e.windowHeight-t.height,this.bannerAd.style.left=(e.windowWidth-t.width)/2}),this.bannerAd.onError(e=>{console.log("onError 显示页面底部广告出现问题",e)})}}showBannerAd(){Laya.Browser.onMiniGame&&null!=this.bannerAd&&this.bannerAd.show()}hideBannerAd(){Laya.Browser.onMiniGame&&null!=this.bannerAd&&this.bannerAd.hide()}initVideoAd(){Laya.Browser.onMiniGame&&"undefined"!=typeof tt&&tt&&tt.createRewardedVideoAd&&(this.RewardedVideoAd=tt.createRewardedVideoAd({adUnitId:this.adUnitId_VideoAd}),this.RewardedVideoAd.onLoad(()=>{console.log("视频拉起成功")}),this.RewardedVideoAd.onError(e=>{console.log("视频拉取  失败"),console.log(e),tt.showToast({title:"加载广告失败",icon:"none",duration:2e3,success(e){console.log(`${e}`)},fail(e){console.log("showToast调用失败")}})}),this.RewardedVideoAd.onClose(e=>{e.isEnded?(console.log("观看完成获得奖励"),this.addLookAdTimes(),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!0),this.curSecondAd&&this.showSecondReward()):this.curSecondAd?(w.showSystemNotice("未看完,无奖励"),console.log("关闭视频无奖励"),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!1)):this.showSecondBox()}))}showSecondBox(){let e=this,t=function(t){console.log(t),t?e.showSecondAd(e.rewardedVideoAdCallBack):e.rewardedVideoAdCallBack&&e.rewardedVideoAdCallBack(!1)};Oe.instance.scenesManager.openScene(y.AdConfirmDialog,Laya.Handler.create(this,function(e){e.closeCallback=t}),!1)}showSecondReward(){let e=new Laya.Label;e.font="Microsoft YaHei",e.text="额外赠送金币:  X200",e.fontSize=40,e.bold=!0,e.anchorX=.5,e.anchorY=.5,e.stroke=2,e.strokeColor="#000000",e.color="#d6ff00",Laya.stage.addChild(e),e.visible=!0;let t=.5*Laya.stage.height+150;e.pos(.5*Laya.stage.width,t);let i=t-50;Laya.Tween.to(e,{y:i},2e3,null,Laya.Handler.create(this,function(){e.removeSelf(),e.destroy()})),Oe.instance.userData.addGold(200)}showSecondAd(e){if(this.curSecondAd=!0,!Laya.Browser.onMiniGame||"undefined"==typeof tt)return e&&e(!0),void this.showSecondReward();this.rewardedVideoAdCallBack=e,this.RewardedVideoAd.show().then(()=>{console.log("广告显示成功")}).catch(t=>{console.log("广告组件出现问题",t),this.RewardedVideoAd.load().then(()=>(console.log("手动加载成功"),this.RewardedVideoAd.show())).catch(t=>{console.log("还是失败了 ： ",t),e&&e(!1)})})}showAd(e,t){if(Oe.instance.errorTouchManager.getIsOpenErrorTouch()?this.curSecondAd=!1:this.curSecondAd=!0,!Laya.Browser.onMiniGame||"undefined"==typeof tt)return this.addLookAdTimes(),void(e&&e(!0));this.rewardedVideoAdCallBack=e,this.RewardedVideoAd.show().then(()=>{console.log("广告显示成功")}).catch(t=>{console.log("广告组件出现问题",t),this.RewardedVideoAd.load().then(()=>(console.log("手动加载成功"),this.RewardedVideoAd.show())).catch(t=>{console.log("还是失败了 ： ",t),e&&e(!1)})})}}class O{constructor(){this.adOppo_NativeAdId="ff23f720b9854935a5b2013924762b99",this.vivoLoadTime=0,this.isVivoLoad=!1,this.vivoCallBack=null}init(e){if(this.adOppo_NativeAdId=e,this.nativeAdRes=null,this.isVivoLoad=!0,Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd)return;this.nativeAd=qg.createNativeAd({posId:this.adOppo_NativeAdId}),this.nativeAd.onLoad(e=>{console.log("1原生大图广告加载",e.adList),e.adList.length<=0||(this.nativeAdRes=e.adList[e.adList.length-1],Laya.Browser.onVVMiniGame&&(this.isVivoLoad=!1,this.vivoCallBack&&this.vivoCallBack(this.nativeAdRes)),this.vivoCallBack=null)}),this.nativeAd.onError(e=>{console.log("1原生大图广告  加载失败",JSON.stringify(e)),Laya.Browser.onVVMiniGame&&(this.isVivoLoad=!0,this.vivoCallBack&&this.vivoCallBack(null)),this.vivoCallBack=null}),this.nativeAd.load()}}getNativeAdRes(){return this.nativeAdRes}reportAdShow(){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd||!this.nativeAdRes)return;this.nativeAd&&this.nativeAd.reportAdShow({adId:this.nativeAdRes.adId})}}reportAdClick(){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd||!this.nativeAdRes)return;this.nativeAd&&(this.nativeAd.reportAdClick({adId:this.nativeAdRes.adId}),console.log("上报点击原生广告"),Oe.instance.timeManager.onceExecute(1,this,function(){this.refreshNativeAd(function(){Oe.instance.eventManager.fire(t.vivo_ad_reportClick)})}))}}refreshNativeAd(e){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd)return;Laya.Browser.onQGMiniGame&&(this.nativeAd&&this.nativeAd.destroy(),this.nativeAd=qg.createNativeAd({posId:this.adOppo_NativeAdId}),this.nativeAd.onLoad(t=>{console.log("原生大图广告加载",t.adList),t.adList.length<=0?e&&e(null):(this.nativeAdRes=t.adList[0],e&&e(this.nativeAdRes))}),this.nativeAd.onError(t=>{console.log("原生大图广告  加载失败",JSON.stringify(t)),e&&e(null)})),Laya.Browser.onVVMiniGame&&(this.vivoCallBack=e),this.nativeAd.load()}}}class V{constructor(){this.adOppo_NativeAdId="201124",this.refreshTime=10,this.curRefreshTime=0}init(){this.initAd(),this.loadPrefab();let e=this;e.isRefresh=!0,Oe.instance.timeManager.loop(10,this,function(){e.update()})}update(){this.curRefreshTime++,this.curRefreshTime>=this.refreshTime&&(this.isRefresh=!0)}resetRefresh(){this.isRefresh=!1,this.curRefreshTime=0}initAd(){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd)return;let e=this;this.nativeAd=qg.createNativeAd({posId:this.adOppo_NativeAdId}),this.nativeAd.onLoad(t=>{console.log("插屏广告加载",t.adList),t.adList.length<=0||(e.resetRefresh(),this.nativeAdRes=t.adList[0])}),this.nativeAd.onError(e=>{console.log("原生广告  加载失败",JSON.stringify(e))}),this.nativeAd.load()}}getNativeAdRes(){return this.nativeAdRes}loadPrefab(){Oe.instance.scenesManager.loadScene(y.NativeBannerView,Laya.Handler.create(this,function(e){this.nativeBannerView=e}))}reportAdShow(){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd||!this.nativeAdRes)return;this.nativeAd&&this.nativeAd.reportAdShow({adId:this.nativeAdRes.adId})}}reportAdClick(e){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd||!this.nativeAdRes)return;this.nativeAd&&this.nativeAd.reportAdClick({adId:this.nativeAdRes.adId}),this.nativeAdRes=null,this.refreshNativeAd(e)}}showBanner(e){let t=this.nativeAdRes;return console.log("showBanner res ",JSON.stringify(t)),!(!t||!(t.imgUrlList.length>0||t.icon))&&(Oe.instance.scenesManager.loadScene(y.NativeBannerView,Laya.Handler.create(this,function(t){if(e){let i=Laya.stage.width,a=Laya.stage.height,n=i-t.width,s=a-t.height;e.addChild(t),t.x=n/2,t.y=s}})),!0)}changePageRefresh(){this.isRefresh&&this.refreshNativeAd(null)}refreshNativeAd(e){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createNativeAd)return;this.nativeAd&&this.nativeAd.destroy(),this.nativeAd=qg.createNativeAd({posId:this.adOppo_NativeAdId});let t=this;this.nativeAd.onLoad(i=>{console.log("插屏广告加载",i.adList),i.adList.length<=0?e&&e(null):(this.nativeAdRes=i.adList[0],t.resetRefresh(),e&&e(this.nativeAdRes))}),this.nativeAd.onError(t=>{console.log("原生广告  加载失败",JSON.stringify(t)),e&&e(null)}),this.nativeAd.load()}}}class U extends _{constructor(){super(...arguments),this.adOppo_BannerAd="201063",this.adOppo_VideoAd="201066",this.adOppo_NativeAdPic="201106"}init(){this.initBannerAd(),this.initVideoAd(),this.initNativeBanner(),this.initNativeAd()}initNativeAd(){this.nativeAdPic=new O,this.nativeAdPic.init(this.adOppo_NativeAdPic)}initNativeBanner(){this.nativeBanner=new V,this.nativeBanner.init()}showNativeBanner(e){if(this.nativeBanner){this.nativeBanner.showBanner(e)||this.showBannerAd()}}initBannerAd(){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createBannerAd)return;this.bannerAd=qg.createBannerAd({posId:this.adOppo_BannerAd}),this.bannerAd.onLoad(function(){console.log("banner 广告加载成功")}),this.bannerAd.onShow(function(){console.log("banner 广告显示")});let e=this;this.bannerAd.onError(t=>{console.log("onError 显示页面底部广告出现问题",t),Laya.timer.once(1e4,e,function(){e.bannerAd.onLoad(function(){console.log("banner 广告加载成功")})})})}}showBannerAd(){if(Laya.Browser.onQGMiniGame){if(null==this.bannerAd||"undefined"==typeof qg||!qg||!qg.createBannerAd)return;this.bannerAd.show()}}hideBannerAd(){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if(null==this.bannerAd||"undefined"==typeof qg||!qg||!qg.createBannerAd)return;this.bannerAd.hide()}}initVideoAd(){if(Laya.Browser.onQGMiniGame){if("undefined"==typeof qg||!qg||!qg.createRewardedVideoAd)return;this.RewardedVideoAd=qg.createRewardedVideoAd({posId:this.adOppo_VideoAd}),this.RewardedVideoAd.onError(e=>{w.showSystemNotice("广告展示失败"),console.log("onError  广告展示失败"+e),console.log(e),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!1)}),this.RewardedVideoAd.onClose(e=>{e.isEnded?(console.log("观看完成获得奖励"),this.addLookAdTimes(),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!0)):(console.log("关闭视频无奖励"),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!1))})}}showAd(e,t){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createRewardedVideoAd)return void(e&&e(!1));this.rewardedVideoAdCallBack=e,this.RewardedVideoAd.offLoad(),this.RewardedVideoAd.onLoad(()=>{console.log("this.RewardedVideoAd.onLoad");let t=this.RewardedVideoAd.show();t&&t.catch(t=>{console.log("222激励广告展示失败"+JSON.stringify(t)),w.showSystemNotice("广告展示失败"),e&&e(!1)})});let t=this.RewardedVideoAd.load();t&&t.catch(t=>{console.log("111激励广告load失败"+JSON.stringify(t)),w.showSystemNotice("广告展示失败"),e&&e(!1)})}}}class E extends _{constructor(){super(...arguments),this.adVivo_BannerAd="e5a3ec53f2114e3896d410c72744327b",this.adVivo_VideoAd="2c2497fa1b474ab39acd030df602b060",this.adVivo_NativeAdPic="ff23f720b9854935a5b2013924762b99"}init(){this.initNativeAd()}initNativeAd(){this.nativeAdPic=new O}initBannerAd(){if("undefined"==typeof qg||!qg||!qg.createBannerAd)return;let e=this.bannerAd;this.bannerAd=qg.createBannerAd({posId:this.adVivo_BannerAd,style:{}});let t=this,i=this.bannerAd.show();i&&i.then(()=>{console.log("banner广告展示成功"),e&&e.destroy()}).catch(i=>{switch(e&&(this.bannerAd=e),console.log("banner广告展示 失败"),console.log(i),i.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log(" bannerAd 加载广告失败，重新加载广告"),Laya.timer.clear(t,t.initBannerAd),Laya.timer.once(11e3,t,t.initBannerAd);break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(i))}})}showBannerAd(e){this.initBannerAd()}hideBannerAd(){if(Laya.Browser.onVVMiniGame){if(null==this.bannerAd||"undefined"==typeof qg||!qg||!qg.createBannerAd)return;this.bannerAd.hide(),this.initBannerAd()}}initVideoAd(){if(Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createRewardedVideoAd)return;this.RewardedVideoAd=qg.createRewardedVideoAd({posId:this.adVivo_VideoAd}),this.RewardedVideoAd.onError(e=>{w.showSystemNotice("广告展示失败"),console.log("onError  广告展示失败"+e),console.log(e),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!1)}),this.RewardedVideoAd.onClose(e=>{Laya.SoundManager.playMusic("sound/bgm.mp3",0),e.isEnded?(console.log("观看完成获得奖励"),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!0)):(console.log("关闭视频无奖励"),this.rewardedVideoAdCallBack&&this.rewardedVideoAdCallBack(!1))})}}showAd(e,t){if(Laya.Browser.onVVMiniGame){if(Laya.Browser.onVVMiniGame){if("undefined"==typeof qg||!qg||!qg.createRewardedVideoAd)return void(e&&e(!1));this.rewardedVideoAdCallBack=e,this.RewardedVideoAd.offLoad(),this.RewardedVideoAd.onLoad(()=>{console.log("this.RewardedVideoAd.onLoad"),Laya.SoundManager.stopMusic();let t=this.RewardedVideoAd.show();t&&t.catch(t=>{console.log("222激励广告展示失败"+JSON.stringify(t)),w.showSystemNotice("广告展示失败"),e&&e(!1)})});let t=this.RewardedVideoAd.load();t&&t.catch(t=>{console.log("111激励广告load失败"+JSON.stringify(t)),w.showSystemNotice("广告展示失败"),e&&e(!1)})}}else e&&e(!0)}}!function(e){e[e.NONE=0]="NONE",e[e.OPPO=1]="OPPO",e[e.VIVO=2]="VIVO",e[e.TT=3]="TT"}(m||(m={}));class R{constructor(){this.channel="local",this.type=m.NONE,"undefined"!=typeof qg?(this.channel=qg.getProvider().toLocaleLowerCase(),this.type=m[this.channel.toLocaleUpperCase()]):"undefined"!=typeof tt&&(this.channel="tt",this.type=m.TT)}static getInstance(){return R.instance||(R.instance=new R),R.instance}getChannel(){return this.channel}getType(){return this.type}isOppo(){return this.type==m.OPPO}isVivo(){return this.type==m.VIVO}isTT(){return this.type==m.TT}}class F{constructor(){this.channelId="Hamster",this.host="minigame-1300797998.cos.ap-guangzhou.myqcloud.com",this.co="BenFei"}static getInstance(){return F.instance||(F.instance=new F),F.instance}}F.SDKVersion="version_331_1";F.getInstance();var X;!function(e){e[e.GP_Oppo=0]="GP_Oppo",e[e.GP_Vivo=1]="GP_Vivo",e[e.GP_Tiktok=2]="GP_Tiktok",e[e.GP_QQ=3]="GP_QQ",e[e.GP_Test=4]="GP_Test",e[e.GP_WX=5]="GP_WX",e[e.GP_KS=6]="GP_KS"}(X||(X={}));class W{constructor(){this.screenWidth=0,this.screenHeight=0}}class q{constructor(){this.systemInfo=null}static getInstance(){return q.instance||(q.instance=new q),q.instance}static saveData(e,t){Laya.LocalStorage.setItem(e,t)}static getData(e,t){var i=Laya.LocalStorage.getItem(e);return null==i&&(i=t),i}static getPlatform(){var e=R.getInstance().getType();return e==m.OPPO?X.GP_Oppo:e==m.VIVO?X.GP_Vivo:e==m.TT?X.GP_Tiktok:X.GP_Test}static sdklog(e,...t){console.log(e,t)}initSystemInfo(e){var t=this;switch(this.systemInfo=new W,q.getPlatform()){case X.GP_Oppo:qg.getSystemInfo({success:function(e){console.log("ASCSDK",`获取设备信息成功， screenWidth = ${e.screenWidth},handling success， screenHeight = ${e.screenHeight}, ${Laya.stage.height}`),t.systemInfo.screenWidth=e.screenWidth,t.systemInfo.screenHeight=e.screenHeight},complete:function(){e&&e(!0)}});break;case X.GP_Vivo:qg.getSystemInfo({success:function(e){console.log("ASCSDK",`获取设备信息成功， screenWidth = ${e.screenWidth},handling success， screenHeight = ${e.screenHeight}, ${Laya.stage.height}`),t.systemInfo.screenWidth=e.screenWidth,t.systemInfo.screenHeight=e.screenHeight},fail:function(){},complete:function(){e&&e(!0)}});break;default:e&&e(!0)}}getSystemInfo(){return this.systemInfo}isversionNewThanEngineVersion(e){switch(q.getPlatform()){case X.GP_QQ:var t=e.split("."),i=100*Number(t[0])+10*Number(t[1])+Number(t[2]),a=qq.getSystemInfoSync().SDKVersion.split(".");return i<=100*Number(a[0])+10*Number(a[1])+Number(a[2]);case X.GP_Tiktok:t=e.split("."),i=100*Number(t[0])+10*Number(t[1])+Number(t[2]),a=tt.getSystemInfoSync().SDKVersion.split(".");return i<=100*Number(a[0])+10*Number(a[1])+Number(a[2]);case X.GP_WX:t=e.split("."),i=100*Number(t[0])+10*Number(t[1])+Number(t[2]),a=wx.getSystemInfoSync().SDKVersion.split(".");return i<=100*Number(a[0])+10*Number(a[1])+Number(a[2]);default:return!0}}}class Q{constructor(){this.nativeAd=null,this.nativeInfo=null,this.nativeContent=null,this.isLoadIconNative=!1,this.isLoadImageNative=!1}static getInstance(){return Q.instance||(Q.instance=new Q),Q.instance}showNativeBanner(){se.getInstance().showNativeBannerUI(this.nativeInfo)}updateNativeBanner(){se.getInstance().hideNativeBannerUI(),se.getInstance().showNativeBannerUI(this.nativeInfo)}hideNativeBaner(){se.getInstance().hideNativeBannerUI()}createNativeAd(e){console.log("ASCSDK","OPPO 加载原生广告",e),this.nativeAd=qg.createNativeAd({posId:e}),this.nativeInfo={adId:null,title:"特别惊喜",desc:"点我一下可不可以啊",clickBtnTxt:null,Native_icon:null,Native_BigImage:null},this.nativeContent={adId:null,title:null,desc:null,Native_icon:null,Native_BigImage:null,NativeAdTip:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIconRes/ICONAd.png",NativeClose:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerClose.png"};var t=this;this.nativeAd.onLoad(function(e){console.log("ASCSDK","OPPO 原生广告加载成功",JSON.stringify(e.adList));for(var i=0,a=0;a<e.adList.length;a++){if(""!=e.adList[a].icon.length&&e.adList[a].imgUrlList.length>0){console.log("ASCSDK","OPPO 同时存在原生ICON和大图"),i=a;break}if(a==e.adList.length-1&&(e.adList[a].icon.length>0||e.adList[a].imgUrlList.length>0)){console.log("ASCSDK","OPPO 只存在原生ICON或大图"),i=a;break}}t.nativeInfo.adId=String(e.adList[i].adId),t.nativeInfo.title=String(e.adList[i].title),t.nativeInfo.desc=String(e.adList[i].desc),t.nativeInfo.clickBtnTxt=String(e.adList[i].clickBtnTxt),t.nativeContent.adId=String(e.adList[i].adId),t.nativeContent.title=String(e.adList[i].title),t.nativeContent.desc=String(e.adList[i].desc),e.adList&&""!=e.adList[i].icon?(Laya.loader.load(String(e.adList[i].icon),Laya.Handler.create(this,function(){console.log("ASCSDK","OPPO 原生ICON加载成功"),t.nativeInfo.Native_icon=String(e.adList[i].icon),t.isLoadIconNative=!0})),t.nativeContent.Native_icon=String(e.adList[i].icon)):(t.nativeInfo.Native_icon=null,t.isLoadIconNative=!1),e.adList&&e.adList[i].imgUrlList.length>0?(Laya.loader.load(String(e.adList[i].imgUrlList[0]),Laya.Handler.create(this,function(){console.log("ASCSDK","OPPO 原生大图加载成功"),t.nativeInfo.Native_BigImage=String(e.adList[i].imgUrlList[0]),t.isLoadImageNative=!0})),t.nativeContent.Native_BigImage=String(e.adList[i].imgUrlList[0])):(t.nativeInfo.Native_BigImage=null,t.isLoadImageNative=!1)}),this.nativeAd.onError(e=>{console.log("ASCSDK","OPPO 原生广告加载失败："+JSON.stringify(e))}),this.nativeAd.load()}nativeUpdate(){this.nativeAd&&this.nativeAd.load()}getIconNativeFlag(){return this.isLoadIconNative}getImageNativeFlag(){return this.isLoadImageNative}showNativeInters(e){var t=this;if(e<=1)t.reportNativeShow(t.nativeInfo.adId);else for(var i=0;i<e;i++)setTimeout(()=>{t.reportNativeShow(t.nativeInfo.adId)},5e3*i);se.getInstance().showNativeIntersUI(this.nativeInfo)}showNativeIcon(e,t,i,a){this.reportNativeShow(this.nativeInfo.adId),se.getInstance().showNativeIconUI(e,t,i,a,this.nativeInfo)}showNativeImage(e,t,i,a){this.reportNativeShow(this.nativeInfo.adId),se.getInstance().showNativeImageUI(e,t,i,a,this.nativeInfo)}getNativeInfo(){return this.nativeContent}reportNativeShow(e){console.log("ASCSDK","OPPO 上报原生广告展示","广告ID为:"+e),this.nativeAd.reportAdShow({adId:e})}reportNativeClick(e){console.log("ASCSDK","OPPO 上报原生广告点击","广告ID为:"+e),this.nativeAd.reportAdClick({adId:e})}}class z{constructor(){this.nativeIcon=null,this.nativeImage=null}static getInstance(){return z.instance||(z.instance=new z),z.instance}createNativeIcon(){}showNativeIcon(e,t,i,a){this.nativeIcon?console.log("ASCSDK","Test 已存在原生ICON return"):(console.log("ASCSDK","Test showNativeIcon===================="),this.nativeIcon=new Laya.Sprite,this.nativeIcon.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/iconBg.png"),this.nativeIcon.width=e,this.nativeIcon.height=t,this.nativeIcon.x=i,this.nativeIcon.y=a,this.nativeIcon.zOrder=29999,Laya.stage.addChild(this.nativeIcon))}hideNativeIcon(){this.nativeIcon?(console.log("ASCSDK","Test hideNativeICON=============="),this.nativeIcon.removeSelf(),this.nativeIcon=null):console.log("ASCSDK","Test 不存在原生ICON return")}showNativeImage(e,t,i,a){this.nativeImage?console.log("ASCSDK","Test 已存在原生大图 return"):(console.log("ASCSDK","Test showNativeImage=================="),this.nativeImage=new Laya.Sprite,this.nativeImage.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/fakeNativeImage.png"),this.nativeImage.width=e,this.nativeImage.height=t,this.nativeImage.x=i,this.nativeImage.y=a,this.nativeImage.zOrder=29999,Laya.stage.addChild(this.nativeImage))}hideNativeImage(){this.nativeImage?(console.log("ASCSDK","Test hideNativeImage=============="),this.nativeImage.removeSelf(),this.nativeImage=null):console.log("ASCSDK","Test 不存在原生大图 return")}}class J{constructor(){this.nativeAd=null,this.nativeInfo=null,this.nativeContent=null,this.isLoadIconNative=!1,this.isLoadImageNative=!1}static getInstance(){return J.instance||(J.instance=new J),J.instance}createNativeAd(e){console.log("ASCSDK","VIVO 加载原生广告",e),e="ff23f720b9854935a5b2013924762b99",this.nativeAd=qg.createNativeAd({posId:e}),this.nativeInfo={adId:null,title:"特别惊喜",desc:"点我一下可不可以啊",clickBtnTxt:null,Native_icon:null,Native_BigImage:null},this.nativeContent={adId:null,title:null,desc:null,Native_icon:null,Native_BigImage:null,NativeAdTip:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIconRes/ICONAd.png",NativeClose:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerClose.png"};var t=this;this.nativeAd.onLoad(function(e){console.log("ASCSDK","VIVO 原生广告加载成功",JSON.stringify(e.adList));let i=0;null!=typeof e.adList&&0!=e.adList.length?(i=e.adList.length-1,console.log("ASCSDK","第"+i+"个原生广告:"+JSON.stringify(e.adList[i])),""!=e.adList[i].icon&&0!=e.adList[i].imgUrlList.length?console.log("ASCSDK","VIVO 同时存在原生ICON和大图"):console.log("ASCSDK","VIVO 只存在原生ICON或大图"),t.nativeInfo.adId=String(e.adList[i].adId),t.nativeInfo.title=String(e.adList[i].title),t.nativeInfo.desc=String(e.adList[i].desc),t.nativeInfo.clickBtnTxt=String(e.adList[i].clickBtnTxt),t.nativeContent.adId=String(e.adList[i].adId),t.nativeContent.title=String(e.adList[i].title),t.nativeContent.desc=String(e.adList[i].desc),""!=e.adList[i].icon?(Laya.loader.load(String(e.adList[i].icon),Laya.Handler.create(this,function(){console.log("ASCSDK","VIVO 原生ICON加载成功"),t.nativeInfo.Native_icon=String(e.adList[i].icon),t.isLoadIconNative=!0})),t.nativeContent.Native_icon=String(e.adList[i].icon)):(t.nativeInfo.Native_icon=null,t.isLoadIconNative=!1),0!=e.adList[i].imgUrlList.length?(Laya.loader.load(String(e.adList[i].imgUrlList[0]),Laya.Handler.create(this,function(){console.log("ASCSDK","VIVO 原生大图加载成功"),t.nativeInfo.Native_BigImage=String(e.adList[i].imgUrlList[0]),t.isLoadImageNative=!0})),t.nativeContent.Native_BigImage=String(e.adList[i].imgUrlList[0])):(t.nativeInfo.Native_BigImage=null,t.isLoadImageNative=!1)):console.log("ASCSDK","VIVO 原生广告列表为空 return")}),this.nativeAd.onError(e=>{console.log("ASCSDK","VIVO 原生广告加载失败："+JSON.stringify(e))}),this.nativeAd.load()}showNativeBanner(){se.getInstance().showNativeBannerUI(this.nativeInfo)}updateNativeBanner(){se.getInstance().hideNativeBannerUI(),se.getInstance().showNativeBannerUI(this.nativeInfo)}hideNativeBaner(){se.getInstance().hideNativeBannerUI()}nativeUpdate(){this.nativeAd&&this.nativeAd.load()}getIconNativeFlag(){return this.isLoadIconNative}getImageNativeFlag(){return this.isLoadImageNative}showNativeInters(e){var t=this;if(e<=1)t.reportNativeShow(t.nativeInfo.adId);else for(var i=0;i<e;i++)setTimeout(()=>{t.reportNativeShow(t.nativeInfo.adId)},5e3*i);se.getInstance().showNativeIntersUI(this.nativeInfo)}showNativeIcon(e,t,i,a){this.reportNativeShow(this.nativeInfo.adId),se.getInstance().showNativeIconUI(e,t,i,a,this.nativeInfo)}showNativeImage(e,t,i,a){this.reportNativeShow(this.nativeInfo.adId),se.getInstance().showNativeImageUI(e,t,i,a,this.nativeInfo)}getNativeInfo(){return this.nativeContent}reportNativeShow(e){console.log("ASCSDK","VIVO 上报原生广告展示","广告ID为:"+e),this.nativeAd.reportAdShow({adId:e})}reportNativeClick(e){console.log("ASCSDK","VIVO 上报原生广告点击","广告ID为:"+e),this.nativeAd.reportAdClick({adId:e})}}class j{constructor(){this.NativeID="",this.nativeAd=null,this.isLoadIconNative=!1,this.iconCloseUpdate=null,this.iconX=0,this.iconY=0,this.updateICON=null}static getInstance(){return j.instance||(j.instance=new j),j.instance}createNativeAd(e){q.getInstance().isversionNewThanEngineVersion("2.11.1")?(this.NativeID=e,console.log("ASCSDK","WX 原生广告初始化",e),this.nativeAd=wx.createCustomAd({adUnitId:e,adIntervals:30,style:{left:this.iconX,top:this.iconY,fixed:!0}}),this.nativeAd.onLoad(()=>{console.log("ASCSDK","WX 原生ICON加载成功"),this.isLoadIconNative=!0}),this.nativeAd.onError(e=>{console.log("ASCSDK","WX 原生ICON加载失败:"+JSON.stringify(e)),this.isLoadIconNative=!1}),this.nativeAd.onClose(()=>{console.log("ASCSDK","WX 手动关闭原生ICON 30s后再次刷新"),this.iconCloseUpdate=setTimeout(()=>{this.nativeAd.createNativeAd(e),setTimeout(()=>{this.nativeAd.show()},500)},3e4)})):console.log("ASCSDK","WX 平台版本过低,不能创建原生广告")}getIconNativeFlag(){return this.isLoadIconNative}showNativeIcon(e,t){let i=this,a=Number(wx.getSystemInfoSync().windowWidth),n=Number(wx.getSystemInfoSync().windowHeight),s=t;t=Laya.stage.height-t,this.iconX=e*(a/Laya.stage.width),this.iconY=t*(n/Laya.stage.height),this.createNativeAd(this.NativeID),setTimeout(()=>{console.log("ASCSDK","WX showNativeIcon==============================="),this.nativeAd.show()},500),this.updateICON=setInterval(()=>{console.log("ASCSDK","WX 刷新原生ICON广告================"),i.nativeAd.destroy(),i.showNativeIcon(e,s)},3e4)}hideNativeIcon(){this.iconCloseUpdate&&(clearTimeout(this.iconCloseUpdate),this.iconCloseUpdate=null),this.updateICON&&(clearInterval(this.updateICON),this.updateICON=null),this.nativeAd?(console.log("ASCSDK","WX hideNativeIcon===============================');"),this.nativeAd.destroy()):console.log("ASCSDK","WX 不存在原生广告实例")}}class Y{constructor(){this.ID_NativeID="",this.SW_NativeMainSwitch=!1,this.NUM_NativeIntersReportFrequency=1,this.nativeUpdateTime=30,this.onNativeIconShow=!1,this.onNativeImageShow=!1,this.oldNativeIconSize=null,this.nativeIconUpdate=null,this.nativeImageUpdate=null}static getInstance(){return Y.instance||(Y.instance=new Y),Y.instance}createNativeAd(){if(this.SW_NativeMainSwitch){switch(q.getPlatform()){case X.GP_Oppo:se.getInstance().loadNativeInstersRes(),se.getInstance().loadNativeBannerRes(),se.getInstance().loadNativeIconRes(),Q.getInstance().createNativeAd(this.ID_NativeID);break;case X.GP_Vivo:se.getInstance().loadNativeInstersRes(),se.getInstance().loadNativeBannerRes(),se.getInstance().loadNativeIconRes(),J.getInstance().createNativeAd(this.ID_NativeID);break;case X.GP_WX:return void j.getInstance().createNativeAd(this.ID_NativeID)}this.updateNativeAd()}else console.log("ASCSDK","原生广告总开关没有开启")}getIconNativeFlag(){switch(q.getPlatform()){case X.GP_Oppo:return Q.getInstance().getIconNativeFlag();case X.GP_Vivo:return J.getInstance().getIconNativeFlag();case X.GP_WX:return j.getInstance().getIconNativeFlag();case X.GP_Test:return!0;default:return!1}}showNativeIcon(e,t,i,a){if(q.getPlatform()!=X.GP_Test)if(this.SW_NativeMainSwitch)if(this.getIconNativeFlag())if(this.onNativeIconShow)console.log("ASCSDK","原生ICON正在展示中,请勿多次showNativeIcon return");else{switch(this.onNativeIconShow=!0,q.getPlatform()){case X.GP_Oppo:Q.getInstance().showNativeIcon(e,t,i,a);break;case X.GP_Vivo:J.getInstance().showNativeIcon(e,t,i,a);break;case X.GP_WX:return void j.getInstance().showNativeIcon(i,a)}this.oldNativeIconSize={width:e,height:t,x:i,y:a},this.nativeIconUpdate=setTimeout(()=>{console.log("ASCSDK","原生ICON刷新======================"),this.hideNativeIcon(),this.showNativeIconAsOld()},1e3*this.nativeUpdateTime)}else console.log("ASCSDK","原生广告不存在ICON return");else console.log("ASCSDK","原生广告总开关没有开启");else z.getInstance().showNativeIcon(e,t,i,a)}hideNativeIcon(){if(q.getPlatform()!=X.GP_Test)switch(this.nativeIconUpdate&&clearTimeout(this.nativeIconUpdate),this.onNativeIconShow=!1,q.getPlatform()){case X.GP_Oppo:case X.GP_Vivo:se.getInstance().hideNativeIconUI();break;case X.GP_WX:return void j.getInstance().hideNativeIcon()}else z.getInstance().hideNativeIcon()}showNativeIconAsOld(){this.showNativeIcon(this.oldNativeIconSize.width,this.oldNativeIconSize.height,this.oldNativeIconSize.x,this.oldNativeIconSize.y)}getImageNativeFlag(){switch(q.getPlatform()){case X.GP_Oppo:return Q.getInstance().getImageNativeFlag();case X.GP_Vivo:return J.getInstance().getImageNativeFlag();case X.GP_Test:return!0;default:return!1}}showNativeImage(e,t,i,a){if(q.getPlatform()!=X.GP_Test)if(this.SW_NativeMainSwitch)if(this.getImageNativeFlag())if(this.onNativeImageShow)console.log("ASCSDK","原生大图正在展示中,请勿多次showNativeImage return");else{switch(this.onNativeImageShow=!0,q.getPlatform()){case X.GP_Oppo:Q.getInstance().showNativeImage(e,t,i,a);break;case X.GP_Vivo:J.getInstance().showNativeImage(e,t,i,a)}this.nativeImageUpdate=setTimeout(()=>{console.log("ASCSDK","原生大图刷新======================"),this.hideNativeImage(),this.showNativeImage(e,t,i,a)},1e3*this.nativeUpdateTime)}else console.log("ASCSDK","原生广告不存在大图 return");else console.log("ASCSDK","原生广告总开关没有开启");else z.getInstance().showNativeImage(e,t,i,a)}hideNativeImage(){if(q.getPlatform()!=X.GP_Test)switch(this.nativeImageUpdate&&clearTimeout(this.nativeImageUpdate),this.onNativeImageShow=!1,q.getPlatform()){case X.GP_Oppo:case X.GP_Vivo:se.getInstance().hideNativeImageUI()}else z.getInstance().hideNativeImage()}showNativeInters(){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().showNativeInters(this.NUM_NativeIntersReportFrequency);break;case X.GP_Vivo:J.getInstance().showNativeInters(this.NUM_NativeIntersReportFrequency)}}updateNativeAd(){setInterval(()=>{switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().nativeUpdate();break;case X.GP_Vivo:J.getInstance().nativeUpdate()}},1e3*this.nativeUpdateTime)}showNativeBanner(){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().showNativeBanner();break;case X.GP_Vivo:J.getInstance().showNativeBanner()}}hideNativeBanner(){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().hideNativeBaner();break;case X.GP_Vivo:J.getInstance().hideNativeBaner()}}getNativeInfo(){switch(q.getPlatform()){case X.GP_Oppo:return Q.getInstance().getNativeInfo();case X.GP_Vivo:return J.getInstance().getNativeInfo();default:return{adId:"88888888",title:"测试标题",desc:"测试详情",Native_icon:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/fakeNativeIcon.png",Native_BigImage:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/fakeNativeImage.png",NativeAdTip:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIconRes/ICONAd.png",NativeClose:"https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerClose.png"}}}reportNativeShow(e){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().reportNativeShow(e);break;case X.GP_Vivo:J.getInstance().reportNativeShow(e)}}reportNativeClick(e){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().reportNativeClick(e);break;case X.GP_Vivo:J.getInstance().reportNativeClick(e)}}}class Z{constructor(){this.SW_DesktopSwitch=!1,this.SW_IntersToDesktop=!1,this.NUM_DeskAutoMostTimes=0,this.NUM_IntersAddDesktopNumber=0}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}getDeskTopFlag(e){if(!this.SW_DesktopSwitch)return console.log("ASCSDK","添加桌面图标开关未开启"),void e(!1);switch(q.getPlatform()){case X.GP_Oppo:qg.installShortcut({success:function(){console.log("ASCSDK","OPPO 创建桌面图标成功"),e(!0)},fail:function(t){console.log("ASCSDK","OPPO 创建桌面图标失败:"+JSON.stringify(t)),e(!1)},complete:function(){}});break;case X.GP_Vivo:qg.installShortcut({success:function(){console.log("ASCSDK","VIVO 创建桌面图标成功"),e(!0)},fail:function(t){console.log("ASCSDK","VIVO 创建桌面图标失败:"+JSON.stringify(t)),e(!1)},complete:function(){}});break;case X.GP_QQ:qq.saveAppToDesktop({success:function(){console.log("ASCSDK","QQ 创建桌面图标成功"),e(!0)},fail:function(t){console.log("ASCSDK","QQ 创建桌面图标失败:"+JSON.stringify(t)),e(!1)},complete:function(){}});break;case X.GP_Test:default:e(!0)}}addDeskTop(e){if(!this.SW_DesktopSwitch)return console.log("ASCSDK","添加桌面图标开关未开启"),void e(!1);switch(q.getPlatform()){case X.GP_Oppo:qg.installShortcut({success:function(){e(!0)},fail:function(t){e(!1)},complete:function(){}});break;case X.GP_Vivo:qg.installShortcut({success:function(){console.log("ASCSDK","VIVO 创建桌面图标成功"),e(!0)}});break;case X.GP_QQ:qq.saveAppToDesktop({success:function(){e(!0)},fail:function(t){e(!1)},complete:function(){}});break;case X.GP_Tiktok:tt.addShortcut({success:function(t){console.log("ASCSDK","添加桌面成功"),e(!0)},fail:function(t){console.log("ASCSDK","添加桌面失败:"+JSON.stringify(t)),e(!1)}});break;default:e(!0)}}showToast(e){switch(q.getPlatform()){case X.GP_Oppo:if(qg.getSystemInfoSync().platformVersionCode<1050)return void console.log("ASCSDK","OPPO 不支持提示框的版本");console.log("ASCSDK","OPPO showToast：",e),qg.showToast({title:e,duration:3e3});break;case X.GP_Vivo:qg.showToast({message:e});break;case X.GP_QQ:qq.showToast({title:e,duration:3e3});break;case X.GP_Test:console.log("ASCSDK","Test 打包后会有真实效果:",e)}}phoneVibrate(e){switch(console.log("ASCSDK","手机震动，需要在打包后会有真实效果",e),q.getPlatform()){case X.GP_Oppo:"short"==e&&qg.vibrateShort({success:function(e){},fail:function(e){},complete:function(e){}}),"long"==e&&qg.vibrateLong({success:function(e){},fail:function(e){},complete:function(e){}});break;case X.GP_Vivo:"short"==e&&qg.vibrateShort(),"long"==e&&qg.vibrateLong();break;case X.GP_Tiktok:"long"==e?tt.vibrateLong({success(e){},fail(e){console.log("ASCSDK","Tiktok vibrateLong调用失败")}}):"short"==e&&tt.vibrateShort({success(e){},fail(e){console.log("ASCSDK","Tiktok vibrateShort调用失败")}});break;case X.GP_QQ:"long"==e?qq.vibrateLong({success(e){},fail(e){console.log("ASCSDK","QQ vibrateLong调用失败")}}):"short"==e&&qq.vibrateShort({success(e){},fail(e){console.log("ASCSDK","vibrateShort调用失败")}});break;case X.GP_Test:console.log("ASCSDK","Test 手机震动，需要在打包后会有真实效果",e);break;case X.GP_WX:"long"==e?wx.vibrateLong({success(e){},fail(e){console.log("ASCSDK","WX vibrateLong调用失败")}}):"short"==e&&wx.vibrateShort({success(e){},fail(e){console.log("ASCSDK","WX vibrateShort调用失败")}})}}reportMonitor(){switch(q.getPlatform()){case X.GP_Oppo:if(qg.getSystemInfoSync().platformVersionCode<1060)return;qg.reportMonitor("game_scene",0)}}reportAnalytics(e,t){switch(q.getPlatform()){case X.GP_Tiktok:tt.reportAnalytics(e,t)}}}class ${constructor(){this.SW_OnIntersShow=!1,this.systemIntersAd=null,this.isLoadSystemInter=!1,this.sysLoadErrNum=0}static getInstance(){return $.instance||($.instance=new $),$.instance}createSystemInters(e){console.log("ASCSDK","VIVO 系统插屏广告初始化",e);let t=e;this.systemIntersAd=qg.createInterstitialAd({posId:e}),this.systemIntersAd.onLoad(()=>{console.log("ASCSDK","VIVO 系统插屏广告加载完成"),this.isLoadSystemInter=!0}),this.systemIntersAd.onError(e=>{console.log("ASCSDK","VIVO 系统插屏加载失败："+JSON.stringify(e)),this.isLoadSystemInter=!1,1008!=e.errCode&&(this.sysLoadErrNum++,console.log("ASCSDK","VIVO 系统插屏加载错误次数:"+this.sysLoadErrNum),this.sysLoadErrNum<5&&setTimeout(()=>{this.createSystemInters(t)},1e4))}),this.systemIntersAd.onClose(()=>{console.log("ASCSDK","VIVO 系统插屏广告关闭"),ne.getInstance().intersNowTime=0,this.isLoadSystemInter=!1,setTimeout(()=>{this.createSystemInters(t)},1e4)})}getSystemIntersFlag(){return this.isLoadSystemInter}showSystemInters(){this.systemIntersAd?(console.log("ASCSDK","VIVO showSystemInters=================="),this.systemIntersAd.show().then(()=>{console.log("ASCSDK","VIVO 系统插屏广告展示成功==================")}).catch(e=>{console.log("ASCSDK","VIVO 系统插屏展示错误:"+JSON.stringify(e)),ne.getInstance().intersNowTime=0})):console.log("ASCSDK","VIVO 未创建系统插屏广告")}}class ee{constructor(){this.SW_OnIntersShow=!1,this.systemIntersAd=null,this.isLoadSystemInter=!1}static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}getSystemIntersFlag(){return this.isLoadSystemInter}createSystemInters(e){console.log("ASCSDK","Tiktok 插屏广告初始化",e);let t=tt.getSystemInfoSync().appName;if("Toutiao"!=t&&("Douyin"!=t||q.getInstance().isversionNewThanEngineVersion("1.71")))return void console.log("ASCSDK","非抖音/今日头条平台 或抖音平台版本过低 return");this.systemIntersAd=tt.createInterstitialAd({adUnitId:e});let i=this;this.systemIntersAd.onLoad(()=>{console.log("ASCSDK","Tiktok 插屏广告加载完成"),this.isLoadSystemInter=!0}),this.systemIntersAd.onError(e=>{console.log("ASCSDK","Tiktok 插屏加载失败 ："+JSON.stringify(e)),this.systemIntersAd&&setTimeout(()=>{i.systemIntersAd&&i.systemIntersAd.load()},3e4)}),this.systemIntersAd.onClose(()=>{console.log("ASCSDK","Tiktok 关闭插屏,重新创建插屏广告"),i.systemIntersAd.destroy(),i.createSystemInters(ne.getInstance().ID_SystemIntersId),i.isLoadSystemInter=!1,i.systemIntersAd.load()}),this.systemIntersAd.load()}showSystemInters(){this.systemIntersAd?(console.log("ASCSDK","Tiktok 展示系统插屏=================="),this.systemIntersAd.show()):console.log("ASCSDK","Tiktok 系统插屏广告未初始化")}}class te{constructor(){this.SW_OnIntersShow=!1,this.systemIntersAd=null,this.isLoadSystemInter=!1}static getInstance(){return te.instance||(te.instance=new te),te.instance}getSystemIntersFlag(){return this.isLoadSystemInter}createSystemInters(e){if(!q.getInstance().isversionNewThanEngineVersion("1.12.0"))return void console.log("ASCSDK","QQ 平台版本过低,创建插屏失败 return");console.log("ASCSDK","QQ 插屏广告初始化",e);let t=this;this.systemIntersAd=qq.createInterstitialAd({adUnitId:e}),this.systemIntersAd.onLoad(()=>{console.log("ASCSDK","QQ 插屏广告加载完成"),t.isLoadSystemInter=!0}),this.systemIntersAd.onError(e=>{console.log("ASCSDK","QQ 插屏广告加载失败："+JSON.stringify(e)),t.isLoadSystemInter=!1,t.systemIntersAd&&setTimeout(()=>{t.systemIntersAd&&t.systemIntersAd.load()},3e4)}),this.systemIntersAd.load()}showSystemInters(){this.systemIntersAd&&this.isLoadSystemInter?(console.log("ASCSDK","QQ 展示系统插屏=================="),this.systemIntersAd.show()):console.log("ASCSDK","QQ 系统插屏广告未加载")}}class ie{constructor(){this.nativeIntersErrorTimes=0,this.NIUIInfo=null}static getInstance(){return ie.instance||(ie.instance=new ie),ie.instance}showInters(){console.log("ASCSDK","Test showInters==========================="),this.NIUIInfo={layerBg:null,exit:null};var e=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/layerBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/nativeClose.png"];let t=this;Laya.loader.load(e,Laya.Handler.create(this,function(i){t.NIUIInfo.layerBg=e[0],t.NIUIInfo.exit=e[1],console.log("ASCSDK","Test showNativeInters===========================");var a=Laya.stage.width,n=Laya.stage.height,s=new Laya.Sprite;s.loadImage(t.NIUIInfo.layerBg),s.width=a,s.height=n,s.alpha=.8,s.zOrder=3e4,s.mouseEnabled=!0,Laya.stage.addChild(s);var o=new Laya.Label;o.x=a/2,o.y=n/2,o.text="这是一个测试插屏,请点击右上角关闭",o.color="#ff0000",o.fontSize=50,o.centerX=0,o.centerY=0,s.addChild(o);var r=new Laya.Sprite;r.loadImage(t.NIUIInfo.exit),r.x=3*a/4,r.y=2*a/5,r.zOrder=30010,r.mouseEnabled=!0,s.addChild(r),r.on("click",this,e=>{console.log("ASCSDK","关闭测试插屏"),Laya.stage.removeChild(s)})}))}}class ae{constructor(){this.systemIntersAd=null,this.isLoadSystemInter=!1}static getInstance(){return ae.instance||(ae.instance=new ae),ae.instance}getSystemIntersFlag(){return this.isLoadSystemInter}createSystemInters(e){console.log("ASCSDK","WX 插屏广告初始化",e);let t=this;this.systemIntersAd=wx.createInterstitialAd({adUnitId:e}),this.systemIntersAd.onLoad(()=>{console.log("ASCSDK","WX 插屏广告加载完成"),t.isLoadSystemInter=!0}),this.systemIntersAd.onError(e=>{console.log("ASCSDK","WX 插屏广告加载失败："+JSON.stringify(e)),t.isLoadSystemInter=!1,t.systemIntersAd&&setTimeout(()=>{t.systemIntersAd&&t.systemIntersAd.load()},3e4)}),this.systemIntersAd.load()}showSystemInters(){this.systemIntersAd&&this.isLoadSystemInter?(console.log("ASCSDK","WX showSystemInters=================="),this.systemIntersAd.show()):console.log("ASCSDK","WX 系统插屏广告未加载")}}class ne{constructor(){this.ID_SystemIntersId="",this.SW_SystemIntersSwitch=!1,this.SW_NativeIntersSwitch=!1,this.SW_IntersBaseControlSwitch=!1,this.NUM_NativeIntersPercent=0,this.NUM_IntersIntervalNum=0,this.NUM_IntersIntervalTime=0,this.NUM_IntersDelayTime=0,this.NUM_IntersDelayPercent=0,this.NUM_IntersStartNum=0,this.intersShowTime=0,this.intersNowInterval=0,this.intersNowTime=0,this.deskTimes=0}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}runIntersInterval(){this.NUM_IntersIntervalTime>0&&setInterval(()=>{this.intersNowTime++},1e3)}getIntersFlag(){switch(q.getPlatform()){case X.GP_Oppo:return!(!Z.getInstance().SW_DesktopSwitch||!Z.getInstance().SW_IntersToDesktop||0==Z.getInstance().NUM_DeskAutoMostTimes||0==Z.getInstance().NUM_IntersAddDesktopNumber)||(console.log("ASCSDK","桌面开关未开启或次数未设置"),!1);case X.GP_Test:return!0;default:return this.SW_SystemIntersSwitch||this.SW_NativeIntersSwitch?this.getSystemIntersFlag()||Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag()||Z.getInstance().NUM_IntersAddDesktopNumber>0:void console.log("ASCSDK","插屏开关未开启")}}createSystemInters(){if(this.SW_SystemIntersSwitch)switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 已关闭插屏广告");break;case X.GP_Vivo:$.getInstance().createSystemInters(this.ID_SystemIntersId);break;case X.GP_Tiktok:ee.getInstance().createSystemInters(this.ID_SystemIntersId);break;case X.GP_QQ:te.getInstance().createSystemInters(this.ID_SystemIntersId);break;case X.GP_WX:ae.getInstance().createSystemInters(this.ID_SystemIntersId)}else console.log("ASCSDK","系统插屏开关未开启")}getSystemIntersFlag(){switch(q.getPlatform()){case X.GP_Vivo:return $.getInstance().getSystemIntersFlag();case X.GP_Tiktok:return ee.getInstance().getSystemIntersFlag();case X.GP_QQ:return te.getInstance().getSystemIntersFlag();case X.GP_WX:return ae.getInstance().getSystemIntersFlag();default:return!1}}showInters(){switch(q.getPlatform()){case X.GP_Oppo:return this.intersShowTime++,void(this.intersShowTime==Z.getInstance().NUM_IntersAddDesktopNumber&&this.deskTimes<Z.getInstance().NUM_DeskAutoMostTimes?Z.getInstance().getDeskTopFlag(e=>{e&&(this.deskTimes++,this.intersShowTime=0,console.log("ASCSDK","插屏变添加桌面"),Z.getInstance().addDeskTop(e=>{}))}):console.log("ASCSDK","插屏变添加桌面次数未达到或自动弹添加桌面次数已达上限或已成功添加桌面"));case X.GP_Test:return void ie.getInstance().showInters();default:if(!this.SW_SystemIntersSwitch&&!this.SW_NativeIntersSwitch)return void console.log("ASCSDK","插屏开关未开启")}var e=this;if(this.intersShowTime++,Z.getInstance().SW_IntersToDesktop&&this.intersShowTime<=Z.getInstance().NUM_IntersAddDesktopNumber&&(console.log("ASCSDK","第"+Z.getInstance().NUM_IntersAddDesktopNumber+"次插屏变添加桌面","当前第"+this.intersShowTime+"个"),this.intersShowTime==Z.getInstance().NUM_IntersAddDesktopNumber))Z.getInstance().getDeskTopFlag(e=>{e&&(console.log("ASCSDK","插屏变添加桌面"),Z.getInstance().addDeskTop(e=>{}))});else{if(this.SW_IntersBaseControlSwitch){if(this.intersShowTime<this.NUM_IntersStartNum)return void console.log("ASCSDK","插屏开始次数未达到",this.intersShowTime,"目标次数",this.NUM_IntersStartNum);if(this.intersNowInterval<this.NUM_IntersIntervalNum)return console.log("ASCSDK","插屏间隔次数未达到",this.intersNowInterval,"目标次数",this.NUM_IntersIntervalNum),void this.intersNowInterval++;if(this.intersNowTime<this.NUM_IntersIntervalTime){console.log("ASCSDK","插屏间隔时间未达到",this.intersNowTime,"目标时间",this.NUM_IntersIntervalTime);e=this;return void(Z.getInstance().SW_DesktopSwitch&&this.deskTimes<Z.getInstance().NUM_DeskAutoMostTimes&&Z.getInstance().getDeskTopFlag(function(t){t&&(e.deskTimes++,Z.getInstance().addDeskTop(function(){console.log("ASCSDK","插屏间隔弹桌面")}))}))}}this.intersNowInterval=0,this.SW_SystemIntersSwitch&&this.SW_NativeIntersSwitch?Math.floor(100*Math.random())>=this.NUM_NativeIntersPercent?(console.log("ASCSDK","系统插屏优先"),this.getSystemIntersFlag()?(console.log("ASCSDK","系统插屏可以展示"),this.showSystemInters()):(console.log("ASCSDK","系统插屏没有加载完成"),(Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag())&&(console.log("ASCSDK","改为展示原生插屏"),this.showNativeInters()))):(console.log("ASCSDK","原生插屏优先"),Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag()?(console.log("ASCSDK","原生插屏可以展示"),this.showNativeInters()):(console.log("ASCSDK","原生插屏没有加载到"),this.getSystemIntersFlag()&&(console.log("ASCSDK","改为展示系统插屏"),this.showSystemInters()))):this.SW_SystemIntersSwitch?(console.log("ASCSDK","只打开了系统插屏"),this.showSystemInters()):this.SW_NativeIntersSwitch?(console.log("ASCSDK","只打开了原生插屏"),this.showNativeInters()):console.log("ASCSDK","系统插屏开关和原生插屏开关都没有打开")}}showSystemInters(){if(this.NUM_IntersDelayTime>0)if(Math.floor(100*Math.random())<this.NUM_IntersDelayPercent)setTimeout(()=>{switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 已关闭插屏广告");break;case X.GP_Vivo:$.getInstance().showSystemInters();break;case X.GP_Tiktok:ee.getInstance().showSystemInters();break;case X.GP_QQ:te.getInstance().showSystemInters();break;case X.GP_WX:ae.getInstance().showSystemInters()}},this.NUM_IntersDelayTime);else switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 已关闭插屏广告");break;case X.GP_Vivo:$.getInstance().showSystemInters();break;case X.GP_Tiktok:ee.getInstance().showSystemInters();break;case X.GP_QQ:te.getInstance().showSystemInters();break;case X.GP_WX:ae.getInstance().showSystemInters()}else switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 已关闭插屏广告");break;case X.GP_Vivo:$.getInstance().showSystemInters();break;case X.GP_Tiktok:ee.getInstance().showSystemInters();break;case X.GP_QQ:te.getInstance().showSystemInters();break;case X.GP_WX:ae.getInstance().showSystemInters()}}showNativeInters(){if(this.NUM_IntersDelayTime>0)if(Math.floor(100*Math.random())<this.NUM_IntersDelayPercent)setTimeout(()=>{switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 禁止展示原生插屏");break;case X.GP_Vivo:Y.getInstance().showNativeInters()}},this.NUM_IntersDelayTime);else switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 禁止展示原生插屏");break;case X.GP_Vivo:Y.getInstance().showNativeInters()}else switch(q.getPlatform()){case X.GP_Oppo:console.log("ASCSDK","OPPO 禁止展示原生插屏");break;case X.GP_Vivo:Y.getInstance().showNativeInters()}}}class se{constructor(){this.nativeBanner=null,this.nativeIcon=null,this.nativeImage=null,this.navigateIconTimeInterval=null,this.navigateInfom=null,this.navigateBg=null,this.navigateGroupBg=null,this.navigateSettleBg=null,this.NIUIInfo=null,this.NativeBannerUIInfo=null,this.ICONInfo=null,this.navigateUITextures=null,this.NavigateIconTextureList=[],this.navigateGroupUITextures=null,this.nativeIntersErrorTimes=0,this.nativeBannerErrorTimes=0,this.nativeIconErrorTimes=0,this.isLoadNIUI=!1,this.isLoadNativeBannerUI=!1,this.isLoadIconTip=!1,this.isLoadNavigateIcon=!1,this.isLoadNavigateGroup=!1,this.isLoadNavigateList=!1,this.navigateSettleUITextures=null,this.groupMoving=!1,this.isLoadNavigateSettle=!1}static getInstance(){return se.instance||(se.instance=new se),se.instance}setGroup(e){}loadNativeInstersRes(){console.log("ASCSDK","开始加载原生插屏资源"),this.NIUIInfo={layerBg:null,bg:null,button:null,exit:null,mask:null};var e=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/layerBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/nativeIntersBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/touchButton.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/nativeClose.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/mask.png"],t=this;Laya.loader.load(e,Laya.Handler.create(this,function(i){console.log("ASCSDK","原生插屏资源加载成功"),t.isLoadNIUI=i,t.NIUIInfo.layerBg=e[0],t.NIUIInfo.bg=e[1],t.NIUIInfo.button=e[2],t.NIUIInfo.exit=e[3],t.NIUIInfo.mask=e[4]}))}loadNativeIconRes(){console.log("ASCSDK","开始加载原生广告角标资源"),this.ICONInfo={iconButton:null,iconClose:null};var e=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIconRes/ICONAd.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerClose.png"],t=this;Laya.loader.load(e,Laya.Handler.create(this,function(){t.isLoadIconTip=!0,console.log("ASCSDK","原生广告角标资源加载成功"),t.ICONInfo.iconButton=e[0],t.ICONInfo.iconClose=e[1]}))}loadNativeBannerRes(){console.log("ASCSDK","开始加载原生Banner资源"),this.NativeBannerUIInfo={bannerBg:null,bannerButton:null,bannerClose:null,bannerTip:null};var e=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/newNativeBanner.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerButton.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerClose.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeBannerRes/nativeBannerTip.png"],t=this;this.NativeBannerUIInfo.bannerBg=e[0],this.NativeBannerUIInfo.bannerButton=e[1],this.NativeBannerUIInfo.bannerClose=e[2],this.NativeBannerUIInfo.bannerTip=e[3];Laya.loader.load(e,Laya.Handler.create(this,function(e){console.log("ASCSDK","原生Banner资源是否加载成功:"+e),t.isLoadNativeBannerUI=e}))}loadNavigateIconRes(){console.log("ASCSDK","开始加载互推ICON资源");var e=this;this.navigateUITextures={maskTexture:null,bgTexture:null,moreGameTexture:null};var t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/iconMask.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/iconBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/morgametitle.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.isLoadNavigateIcon=!0,console.log("ASCSDK","互推ICON资源加载成功"),e.navigateUITextures.maskTexture=t[0],e.navigateUITextures.bgTexture=t[1],e.navigateUITextures.moreGameTexture=t[2]})),this.loadNavigateList()}loadNavigateGroup(){console.log("ASCSDK","开始加载互推列表资源");var e=this;this.navigateGroupUITextures={groupHTexture:null,groupVTexture:null,leftTexture:null,maskTexture:null,moreGameTitleTexture:null,redTexture:null,rightTexture:null};var t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/groupH.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/groupV.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/left.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/mask.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/moreGameTitle.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/red.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/right.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.isLoadNavigateGroup=!0,console.log("ASCSDK","互推列表资源加载成功"),e.navigateGroupUITextures.groupHTexture=t[0],e.navigateGroupUITextures.groupVTexture=t[1],e.navigateGroupUITextures.leftTexture=t[2],e.navigateGroupUITextures.maskTexture=t[3],e.navigateGroupUITextures.moreGameTitleTexture=t[4],e.navigateGroupUITextures.redTexture=t[5],e.navigateGroupUITextures.moreGameLeftTexture=t[6],e.navigateGroupUITextures.moreGameRightTexture=t[7]})),this.loadNavigateList()}loadNavigateSettleRes(){console.log("ASCSDK","开始加载结算互推资源");var e=this;this.navigateSettleUITextures={navigateSettleGroup:null,navigateSettletitleBg:null,mask:null,iconWihte:null,navigateBanner:null};var t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/navigateSettleGroup.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/navigateSettletitleBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/settleIcon.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/iconWihte.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/navigateBanner.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.navigateSettleUITextures.navigateSettleGroup=t[0],e.navigateSettleUITextures.navigateSettletitleBg=t[1],e.navigateSettleUITextures.mask=t[2],e.navigateSettleUITextures.iconWihte=t[3],e.navigateSettleUITextures.navigateBanner=t[4],e.isLoadNavigateSettle=!0,console.log("ASCSDK","结算互推资源加载成功")})),this.loadNavigateList()}loadNavigateList(){var e=this;let t=0,i=he.getInstance().navigateList;for(let a=0;a<i.length;a++)Laya.loader.load(i[a].pushGamePicture,Laya.Handler.create(this,function(){e.NavigateIconTextureList[a]=i[a].pushGamePicture,++t>=i.length&&(e.isLoadNavigateList=!0)}))}showNativeIntersUI(e){console.log("ASCSDK","showNativeIntersUI===========================");var t=Laya.stage.width,i=Laya.stage.height,a=new Laya.Sprite;a.pos(t/2-1280,i/2-1280),a.scale(25.6,25.6),a.zOrder=1e5,a.alpha=.8,Laya.stage.addChild(a),a.loadImage(this.NIUIInfo.layerBg),a.mouseEnabled=!0;var n=new Laya.Sprite;if(n.loadImage(this.NIUIInfo.bg),n.zOrder=200100,t<i){n.width=t-100,n.height=.89*n.width,n.x=t/2-n.width/2,n.y=i/2-n.height/2-100,Laya.stage.addChild(n);var s=new Laya.Sprite;s.loadImage(this.NIUIInfo.button),s.width=n.width-200,s.height=.382*s.width,s.x=t/2-s.width/2,s.y=n.y+n.height+80,s.zOrder=200100,Laya.stage.addChild(s);let a=e.adId;s.on("click",this,function(){Y.getInstance().reportNativeClick(a)})}else n.width=i-200,n.height=.89*n.width,n.x=t/2-n.width/2,n.y=i/2-n.height/2,Laya.stage.addChild(n);let o=e.adId;n.on("click",this,function(){Y.getInstance().reportNativeClick(o)});var r=new Laya.Label;if(r.font="Microsoft YaHei",r.text=e.title,r.fontSize=30,r.color="#CC7C70",r.x=n.width/2-r.width/2,r.y=.12*n.height-r.height/2,n.addChild(r),Y.getInstance().getImageNativeFlag()){console.log("ASCSDK","VIVO 原生插屏广告大图优先"),(l=new Laya.Label).font="Microsoft YaHei",l.text=e.desc,l.fontSize=30,l.color="#997C70",l.x=n.width/2-l.width/2,l.y=.255*n.height-l.height/2,n.addChild(l);var h=new Laya.Sprite;h.loadImage(String(e.Native_BigImage)),h.width=.8*n.height,h.height=.4*n.height,h.x=n.width/2-h.width/2,h.y=n.height/2+.085*n.height-h.height/2,n.addChild(h)}else if(Y.getInstance().getIconNativeFlag()){var l;(l=new Laya.Label).font="Microsoft YaHei",l.text=e.desc,l.fontSize=30,l.color="#997C70",l.x=n.width/2-l.width/2,l.y=.205*n.height-l.height/2,n.addChild(l);var d=new Laya.Sprite;d.loadImage(String(e.Native_icon)),d.height=.55*n.height,d.width=.55*n.height,d.x=n.width/2-d.width/2,d.y=.55*n.height-d.height/2,n.addChild(d)}var c=new Laya.Sprite;c.loadImage(this.NIUIInfo.exit),c.x=n.width-c.width/2*n.width/914-.07*n.width,c.y=c.width/2*n.width/914+.07*n.width-c.height/2,c.zOrder=30010,c.width=c.width*n.width/914,c.height=c.height*n.width/914,c.mouseEnabled=!0,n.addChild(c),c.on("click",this,e=>{ne.getInstance().intersNowTime=0,Laya.stage.removeChild(a),Laya.stage.removeChild(n),Laya.stage.removeChild(s),e.stopPropagation()})}showNativeBannerUI(e){if(this.nativeBanner)return void console.log("ASCSDK","已存在原生banner return");let t=e.adId;Y.getInstance().reportNativeShow(t),console.log("ASCSDK","showNativeBanner========================"),this.nativeBanner=new Laya.Sprite,this.nativeBanner.loadImage(this.NativeBannerUIInfo.bannerBg);var i=Laya.stage.width,a=Laya.stage.height;i<a?(this.nativeBanner.width=i,this.nativeBanner.height=.18*i):(this.nativeBanner.width=i/2,this.nativeBanner.height=.18*this.nativeBanner.width),this.nativeBanner.x=i/2-this.nativeBanner.width/2,this.nativeBanner.y=a-this.nativeBanner.height,this.nativeBanner.zOrder=99998,Laya.stage.addChild(this.nativeBanner),this.nativeBanner.on("click",this,function(){Y.getInstance().reportNativeClick(t)});var n=new Laya.Sprite;n.loadImage(this.NativeBannerUIInfo.bannerTip),n.height=.2*this.nativeBanner.height,n.width=n.height/.45,n.x=this.nativeBanner.width-n.width,n.y=0,this.nativeBanner.addChild(n);var s=new Laya.Sprite;if(s.loadImage(this.NativeBannerUIInfo.bannerButton),s.width=.255*this.nativeBanner.width,s.height=.351*s.width,s.x=this.nativeBanner.width-.3125*this.nativeBanner.width,s.y=this.nativeBanner.height/2-s.height/2,this.nativeBanner.addChild(s),Y.getInstance().getImageNativeFlag()){var o=new Laya.Sprite;o.loadImage(e.Native_BigImage),o.height=this.nativeBanner.height,o.width=2*o.height,o.x=0,o.y=0,this.nativeBanner.addChild(o),(r=new Laya.Label).font="Microsoft YaHei",r.fontSize=25,r.color="#FF0000",r.align="left",r.valign="middle",r.wordWrap=!0,""==e.desc?r.text=e.title:r.text=e.desc,r.width=this.nativeBanner.width-o.width-s.width-n.width,r.height=this.nativeBanner.height,r.x=2.2*this.nativeBanner.height,r.y=0,this.nativeBanner.addChild(r)}else if(Y.getInstance().getIconNativeFlag()){var r,h=new Laya.Sprite;h.loadImage(e.Native_icon),h.width=.8*this.nativeBanner.height,h.height=.8*this.nativeBanner.height,h.x=.3*h.width,h.y=this.nativeBanner.height/2-h.height/2,this.nativeBanner.addChild(h),(r=new Laya.Label).font="Microsoft YaHei",r.fontSize=25,r.color="#FF0000",r.align="left",r.valign="middle",r.wordWrap=!0,""==e.desc?r.text=e.title:r.text=e.desc,r.width=this.nativeBanner.width-1.5*this.nativeBanner.height-(this.nativeBanner.width-s.x),r.height=this.nativeBanner.height,r.x=1.5*this.nativeBanner.height,r.y=0,this.nativeBanner.addChild(r)}var l=new Laya.Sprite;l.loadImage(this.NativeBannerUIInfo.bannerClose),l.width=.27*this.nativeBanner.height,l.height=.27*this.nativeBanner.height,l.zOrder=99999,this.nativeBanner.addChild(l);let d=this;l.on("click",this,e=>{let t=ve.getInstance();console.log("ASCSDK","原生banner关闭",t.NUM_BannerUpdateTime+"S后再次刷新"),d.hideNativeBannerUI(),t.updateBanner(),e.stopPropagation()})}hideNativeBannerUI(){this.nativeBanner?(this.nativeBanner.removeSelf(),this.nativeBanner=null,console.log("ASCSDK","hideNativeBannerUI===========================")):console.log("ASCSDK","不存在原生Banner")}showNativeIconUI(e,t,i,a,n){console.log("ASCSDK","showNativeICON==========================="),this.nativeIcon=new Laya.Sprite,this.nativeIcon.loadImage(n.Native_icon),this.nativeIcon.zOrder=29999,Laya.stage.addChild(this.nativeIcon),this.nativeIcon.width=e,this.nativeIcon.height=t,this.nativeIcon.x=i,this.nativeIcon.y=a;var s=new Laya.Sprite;s.loadImage(this.ICONInfo.iconButton),s.width=e/3,s.height=s.width/70*34,s.x=e-s.width,s.y=0,this.nativeIcon.addChild(s);var o=new Laya.Sprite;o.loadImage(this.ICONInfo.iconClose),o.width=45,o.height=45,this.nativeIcon.addChild(o);var r=new Laya.Label;r.font="Microsoft YaHei",r.text=n.title,r.fontSize=30,r.color="#997C70",r.y=t,this.nativeIcon.addChild(r);let h=this;o.on("click",this,function(e){console.log("ASCSDK","手动关闭原生ICON"),h.nativeIcon.removeSelf(),e.stopPropagation()});let l=n.adId;this.nativeIcon.on("click",this,function(){console.log("ASCSDK","点击原生ICON"),Y.getInstance().reportNativeClick(l)})}hideNativeIconUI(){this.nativeIcon?(this.nativeIcon.removeSelf(),this.nativeIcon=null,console.log("ASCSDK","hideNativeIconUI===========================")):console.log("ASCSDK","不存在原生ICON")}showNativeImageUI(e,t,i,a,n){console.log("ASCSDK","showNativeImage==========================="),this.nativeImage=new Laya.Sprite,this.nativeImage.loadImage(String(n.Native_BigImage)),this.nativeImage.zOrder=29999,Laya.stage.addChild(this.nativeImage),this.nativeImage.width=e,this.nativeImage.height=t,this.nativeImage.x=i,this.nativeImage.y=a;var s=new Laya.Sprite;s.loadImage(String(this.ICONInfo.iconButton)),this.nativeImage.addChild(s),s.width=e/5,s.height=s.width/70*34,s.x=e-s.width,s.y=0;var o=new Laya.Sprite;o.loadImage(this.ICONInfo.iconClose),o.width=45,o.height=45,this.nativeImage.addChild(o);let r=this;o.on("click",this,function(e){console.log("ASCSDK","手动关闭原生大图"),r.nativeImage.removeSelf(),e.stopPropagation()});let h=n.adId;this.nativeImage.on("click",this,function(){console.log("ASCSDK","点击原生大图"),Y.getInstance().reportNativeClick(h)})}hideNativeImageUI(){this.nativeImage?(this.nativeImage.removeSelf(),this.nativeImage=null,console.log("ASCSDK","hideNativeImageUI===========================")):console.log("ASCSDK","不存在原生大图 return")}showNavigateIcon(e,t,i,a){if(this.navigateBg)return void console.log("ASCSDK","已存在互推ICON return");console.log("ASCSDK","showNavigateIcon===========================");var n=this;this.navigateBg=new Laya.Sprite,this.navigateBg.width=e,this.navigateBg.height=t,this.navigateBg.x=i,this.navigateBg.y=a,this.navigateBg.on("click",this,function(){n.jumpToMiniGame(n.navigateInfom)}),Laya.stage.addChild(this.navigateBg),this.navigateBg.zOrder=29999;var s=new Laya.Sprite;s.width=.84*this.navigateBg.width,s.height=.84*this.navigateBg.height,this.navigateBg.addChild(s);var o=new Laya.Sprite;o.loadImage(this.navigateUITextures.moreGameTexture),o.width=.84*this.navigateBg.width,o.height=.19*this.navigateBg.height,o.x=0,o.y=.65*t,o.zOrder=20,s.addChild(o);var r=new Laya.Sprite;r.loadImage(this.navigateUITextures.maskTexture,Laya.Handler.create(this,function(){s.mask=r})),r.width=.84*e,r.height=.84*t,r.x=0,r.y=0;let h=0;var l=function(){if(n.navigateBg){var i=n.updateNavigateIcon();s.loadImage(i),s.scale(e/n.navigateBg.width*.84,t/n.navigateBg.height*.84)}};h=setInterval(l,3e4),l()}updateNavigateIcon(){console.log("ASCSDK","updateNavigateIcon===========================");for(var e=he.getInstance().navigateList,t=0,i=0;i<e.length;i++)e[i].sort>0&&(t+=e[i].sort);var a=Math.floor(Math.random()*t),n=0;let s=null,o=0;for(let t=0;t<e.length;t++)0!=e[t].sort&&(a>=n&&a<n+e[t].sort&&(s=e[t],o=t,console.log("ASCSDK","weight",a,e[t].pushGamePackage)),n+=e[t].sort);if(s)return this.navigateInfom=s,this.NavigateIconTextureList[o]}hideNavigateIcon(){this.navigateIconTimeInterval&&clearInterval(this.navigateIconTimeInterval),this.navigateBg?(console.log("ASCSDK","hideNavigateIcon==========================="),Laya.stage.removeChild(this.navigateBg),this.navigateBg=null):console.log("ASCSDK","不存在互推ICON return")}showNavigateGroup(e,t){if(this.navigateGroupBg)return void console.log("ASCSDK","存在互推列表 return");let i=he.getInstance();if(this.isLoadNavigateGroup){console.log("ASCSDK","showNavigateGroup===========================");var a=this;this.navigateGroupBg=new Laya.Sprite;var n=[];for(let e=0;e<i.navigateList.length;e++)n[e]=i.navigateList[e],n[e].index=e;var s=function(){for(var e=0,t=0;t<n.length;t++)e+=n[t].sort;var i=Math.floor(Math.random()*e),a=0;for(let e=0;e<n.length;e++){if(i>=a&&i<a+n[e].sort){var s=n[e];return n.splice(e,1),s}a+=n[e].sort}};if("vertical"==e){this.navigateGroupBg.pivotX=114,this.navigateGroupBg.pivotY=436.5;var o=1;"left"==t?(this.navigateGroupBg.x=-114,this.navigateGroupBg.scaleX=-1,o=-1):(this.navigateGroupBg.scaleX=1,this.navigateGroupBg.x=Laya.stage.width+114),this.navigateGroupBg.y=Laya.stage.height/2,Laya.stage.addChild(this.navigateGroupBg),this.navigateGroupBg.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/groupV.png"),this.navigateGroupBg.zOrder=3e4;let e=new Laya.Sprite;"left"==t?e.loadImage(this.navigateGroupUITextures.moreGameLeftTexture):e.loadImage(this.navigateGroupUITextures.moreGameRightTexture),e.pivotX=80,e.pivotY=50,e.x=-80,e.y=428.5,e.scaleX=o,this.navigateGroupBg.addChild(e),e.on("click",this,function(){if(a.groupMoving)return;a.groupMoving=!0;let t=0;var i=function(){a.navigateGroupBg.x+=-228*a.navigateGroupBg.scaleX/12,++t>=12&&(a.groupMoving=!1,Laya.timer.clear(this,i))};Laya.timer.frameLoop(1,this,i),e.visible=!1,n.visible=!0});let n=new Laya.Sprite;n.width=100,n.height=100,n.pivotX=50,n.pivotY=50,n.x=24,n.y=428.5,this.navigateGroupBg.addChild(n),(c=new Laya.Sprite).scaleX=1,c.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/left.png"),c.pivotX=8.5,c.pivotY=13,c.x=50,c.y=50,n.addChild(c),n.on("click",this,function(){if(console.log("ASCSDK","touchButtonClose"),a.groupMoving)return;a.groupMoving=!0;let t=0;var i=function(){a.navigateGroupBg.x+=228*a.navigateGroupBg.scaleX/12,++t>=12&&(a.groupMoving=!1,Laya.timer.clear(this,i),e.visible=!0,n.visible=!1)};Laya.timer.frameLoop(1,this,i)}),n.visible=!1;var r=new Laya.Sprite;this.navigateGroupBg.addChild(r),r.width=this.navigateGroupBg.width,r.height=this.navigateGroupBg.height,r.pivotX=r.width/2,r.pivotY=r.height/2,r.x=144,r.y=436.5,r.scaleX=this.navigateGroupBg.scaleX;var h=new Laya.Sprite;h.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/moreGameTitle.png"),h.pivotX=h.width/2,h.pivotY=h.height/2,h.x=114,h.y=36.5,r.addChild(h);for(var l=0;l<(i.navigateList.length>5?5:i.navigateList.length);l++){let e=s();(g=new Laya.Sprite).width=128,g.height=128,g.pivotX=g.width/2,g.pivotY=g.height/2,g.x=114,g.y=152+152*l,r.addChild(g);let t=new Laya.Sprite;t.loadImage(this.NavigateIconTextureList[e.index]),t.width=100,t.height=100,t.pivotX=50,t.pivotY=50,t.x=64,t.y=53,g.addChild(t);let i=new Laya.Sprite;i.loadImage(this.navigateGroupUITextures.maskTexture,Laya.Handler.create(this,function(){t.mask=i})),i.width=100,i.height=100,i.pivotX=50,i.pivotY=50,i.x=50,i.y=50,(m=new Laya.Label).font="Microsoft YaHei",m.text=e.pushGameName,m.fontSize=20,m.pivotX=m.width/2,m.pivotY=m.height/2,m.x=64,m.y=115,m.color="#000000",g.addChild(m),g.on("click",this,function(){a.jumpToMiniGame(e)})}}else{this.navigateGroupBg.pivotX=355,this.navigateGroupBg.pivotY=102.5;var d=1;Laya.stage.width<720&&(d=Laya.stage.width/720),this.navigateGroupBg.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/groupH.png");o=1;"left"==t?(this.navigateGroupBg.x=-355*d,this.navigateGroupBg.scaleX=-1*d,this.navigateGroupBg.scaleY=d,o=-1):(this.navigateGroupBg.scaleX=1*d,this.navigateGroupBg.x=Laya.stage.width+310*d,this.navigateGroupBg.scaleY=d,o=1),this.navigateGroupBg.y=Laya.stage.height/2,Laya.stage.addChild(this.navigateGroupBg),this.navigateGroupBg.zOrder=3e4;let e=new Laya.Sprite;"left"==t?e.loadImage(this.navigateGroupUITextures.moreGameLeftTexture):e.loadImage(this.navigateGroupUITextures.moreGameRightTexture),e.pivotX=80,e.pivotY=50,e.x=-80,e.scaleX=o,e.y=94.5,this.navigateGroupBg.addChild(e),e.on("click",this,function(){if(a.groupMoving)return;console.log("ASCSDK","touchButtonOpen"),a.groupMoving=!0;let t=0;var i=function(){a.navigateGroupBg.x+=-710*a.navigateGroupBg.scaleX/12,++t>=12&&(a.groupMoving=!1,Laya.timer.clear(this,i))};Laya.timer.frameLoop(1,this,i),e.visible=!1,n.visible=!0});let n=new Laya.Sprite;var c;this.navigateGroupBg.addChild(n),n.width=100,n.height=100,n.pivotX=50,n.pivotY=50,n.x=28*d,n.y=94.5,n.visible=!1,(c=new Laya.Sprite).loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateGroupRes/left.png"),c.pivotX=8.5,c.pivotY=13,c.x=50,c.y=50,n.addChild(c),n.on("click",this,function(){if(a.groupMoving)return;console.log("ASCSDK","touchButtonClose"),a.groupMoving=!0;let t=0;var i=function(){a.navigateGroupBg.x+=710*a.navigateGroupBg.scaleX/12,++t>=12&&(a.groupMoving=!1,Laya.timer.clear(this,i),e.visible=!0,n.visible=!1)};Laya.timer.frameLoop(1,this,i)}),(r=new Laya.Sprite).x=385,r.y=92.5,this.navigateGroupBg.addChild(r),r.width=this.navigateGroupBg.width,r.height=this.navigateGroupBg.height,r.pivotX=r.width/2,r.pivotY=r.height/2,r.scaleX=this.navigateGroupBg.scaleX;for(l=0;l<(i.navigateList.length>5?5:i.navigateList.length);l++){let e=s();var g;(g=new Laya.Sprite).width=128,g.height=128,g.pivotX=64,g.pivotY=64,g.x=90+128*l,g.y=107.5,r.addChild(g);let t=new Laya.Sprite;t.loadImage(this.NavigateIconTextureList[e.index]),t.width=100,t.height=100,t.pivotX=50,t.pivotY=50,t.x=64,t.y=53,g.addChild(t);let i=new Laya.Sprite;var m;i.loadImage(this.navigateGroupUITextures.maskTexture,Laya.Handler.create(this,function(){t.mask=i})),i.width=100,i.height=100,i.pivotX=50,i.pivotY=50,i.x=50,i.y=50,(m=new Laya.Label).font="Microsoft YaHei",m.text=e.pushGameName,m.fontSize=20,m.pivotX=m.width/2,m.pivotY=m.height/2,m.x=64,m.y=115,m.color="#000000",g.addChild(m),g.on("click",this,function(){a.jumpToMiniGame(e)})}}}else console.log("ASCSDK","互推列表未加载到 return")}hideNavigateGroup(){this.navigateGroupBg?(console.log("ASCSDK","hideNavigateGroup==========================="),this.navigateGroupBg.removeSelf(),this.navigateGroupBg=null):console.log("ASCSDK","互推列表不存在 return")}showNavigateSettle(e,t,i){if(ve.getInstance().hideBanner(),this.navigateSettleBg)return void console.log("ASCSDK","已存在结算互推 return");console.log("ASCSDK","showNavigateSettle===========================");let a=he.getInstance().navigateList;var n=Laya.stage.width,s=Laya.stage.height,o=[];for(let e=0;e<a.length;e++)o[e]=a[e],o[e].index=e;var r=function(){for(var e=0,t=0;t<o.length;t++)e+=o[t].sort;var i=Math.floor(Math.random()*e),a=0;for(let e=0;e<o.length;e++){if(i>=a&&i<a+o[e].sort){var n=o[e];return o.splice(e,1),n}a+=o[e].sort}};switch(e){case 1:{if(a.length<6)return void console.log("ASCSDK","互推游戏小于6个");var h=this;this.navigateSettleBg=new Laya.Sprite,this.navigateSettleBg.x=0,this.navigateSettleBg.y=0,this.navigateSettleBg.zOrder=3e4,Laya.stage.addChild(this.navigateSettleBg),(p=new Laya.Image).skin=this.navigateSettleUITextures.navigateSettleGroup,p.sizeGrid="30,30,30,30,0",Laya.stage.width<Laya.stage.height?(p.width=.65*Laya.stage.width,p.height=p.width/1.15):(p.height=Laya.stage.height/5*2,p.width=1.15*p.height),p.x=t-p.width/2,p.y=i-p.height/2,h.navigateSettleBg.addChild(p),(c=new Laya.Image).skin=this.navigateSettleUITextures.navigateSettletitleBg,c.sizeGrid="10,30,10,30,0",c.width=.972*p.width,c.height=.138*p.height,c.x=p.width/2-c.width/2,c.y=.018*p.height;let e=new Laya.Label;e.font="Microsoft YaHei",e.text="更多精品游戏推荐",e.fontSize=30*(n<s?n/1080:s/1080),e.color="#FFFFFF",e.x=c.width/2-e.width/2,e.y=c.height/2-e.height/2,c.addChild(e),p.addChild(c);for(var l=(p.height-2*c.height)/2,d=0;d<6;d++){let e=r();(g=new Laya.Sprite).width=l,g.height=l,g.x=p.width/3*(d%3)+p.width/3-l,g.y=c.height/2+.018*p.height+c.height+l*Math.floor(d/3),console.log("button"+d,g.x,g.y),p.addChild(g),(m=new Laya.Sprite).loadImage(this.navigateSettleUITextures.iconWihte),m.width=.781*l+2,m.height=.781*l+2,m.x=l/2-m.width/2,m.y=l/2-m.width/2-.085*l,g.addChild(m),(u=new Laya.Sprite).loadImage(this.NavigateIconTextureList[e.index]),u.width=.781*l,u.height=.781*l,u.x=l/2-u.width/2,u.y=l/2-u.width/2-.085*l,g.addChild(u);let t=new Laya.Sprite;t.loadImage(this.navigateSettleUITextures.mask,Laya.Handler.create(this,function(){u.mask=t})),t.width=.781*l,t.height=.781*l,t.x=0,t.y=0,(v=new Laya.Label).font="Microsoft YaHei",v.text=e.pushGameName,v.fontSize=25*(n<s?n/1080:s/1080),v.x=l/2-v.width/2,v.y=t.y+1.05*t.height+v.height/2,v.color="#FFFFFF",g.addChild(v),g.on("click",this,function(){h.jumpToMiniGame(e)})}}break;case 3:{if(a.length<5)return void console.log("ASCSDK","互推游戏小于5个");var c;h=this;this.navigateSettleBg=new Laya.Sprite,this.navigateSettleBg.x=0,this.navigateSettleBg.y=0,this.navigateSettleBg.zOrder=3e4,Laya.stage.addChild(this.navigateSettleBg),(p=new Laya.Image).skin=this.navigateSettleUITextures.navigateSettleGroup,Laya.stage.width<Laya.stage.height?(p.width=.904*Laya.stage.width,p.height=.317*p.width):(p.height=Laya.stage.height/5,p.width=p.height/.317),p.x=t-p.width/2,p.y=i-p.height/2,p.sizeGrid="30,30,30,30,0",h.navigateSettleBg.addChild(p),(c=new Laya.Image).skin=this.navigateSettleUITextures.navigateSettletitleBg,c.width=.972*p.width,c.height=.22*p.height,c.x=p.width/2-c.width/2,c.y=.018*p.height,c.sizeGrid="10,30,10,30,0";let e=new Laya.Label;e.font="Microsoft YaHei",e.text="更多精品游戏推荐",e.fontSize=30*(n<s?n/1080:s/1080),e.color="#FFFFFF",e.x=c.width/2-e.width/2,e.y=c.height/2-e.height/2,c.addChild(e),p.addChild(c);for(l=p.width/5,d=0;d<5;d++){let e=r();var g,m,u;(g=new Laya.Sprite).width=l,g.height=l,g.x=d*l,g.y=.018*p.height+c.height,console.log("button"+d,g.x,g.y),p.addChild(g),(m=new Laya.Sprite).loadImage(this.navigateSettleUITextures.iconWihte),m.width=.781*l+2,m.height=.781*l+2,m.x=l/2-m.width/2,m.y=l/2-m.width/2-.085*l,g.addChild(m),(u=new Laya.Sprite).loadImage(this.NavigateIconTextureList[e.index]),u.width=.781*l,u.height=.781*l,u.x=l/2-u.width/2,u.y=l/2-u.width/2-.085*l,u.zOrder=1e3,g.addChild(u);let t=new Laya.Sprite;var v;t.loadImage(this.navigateSettleUITextures.mask,Laya.Handler.create(this,function(){u.mask=t})),t.width=.781*l,t.height=.781*l,t.x=0,t.y=0,(v=new Laya.Label).font="Microsoft YaHei",v.text=e.pushGameName,v.fontSize=25*(n<s?n/1080:s/1080),v.x=l/2-v.width/2,v.y=t.y+t.height/2+.546*l+v.height/2,v.color="#FFFFFF",g.addChild(v),g.on("click",this,function(){h.jumpToMiniGame(e)})}}break;case 4:{if(a.length<5)return void console.log("ASCSDK","OPPO 互推样式的游戏数量小于5个 return");var p;this.navigateSettleBg=new Laya.Sprite,this.navigateSettleBg.width=0,this.navigateSettleBg.height=0,this.navigateSettleBg.zOrder=3e4,Laya.stage.addChild(this.navigateSettleBg),(p=new Laya.Image).skin=this.navigateSettleUITextures.navigateBanner,Laya.stage.width<Laya.stage.height?(p.width=Laya.stage.width,p.height=13*p.width/35):(p.height=.4*Laya.stage.height,p.width=35*p.height/13),p.x=Laya.stage.width/2-p.width/2,p.y=Laya.stage.height-p.height-i,this.navigateSettleBg.addChild(p);let e=p.width/6.5;for(let t=0;t<5;t++){let i=r(),a=new Laya.Sprite;a.loadImage(this.NavigateIconTextureList[i.index]),a.width=e,a.height=e,a.x=p.width/25+p.width/5.25*t,a.y=p.height/2.8,p.addChild(a);let n=new Laya.Label;n.color="#000000",n.align="center",n.valign="middle",n.overflow="hidden",n.fontSize=30;let s=i.pushGameName;i.pushGameName.length>4&&(s=s.substring(0,4)+"..."),n.text=s,n.width=a.width,n.height=.4*a.height,n.x=0,n.y=a.height,a.addChild(n);let o=this;a.on("click",this,function(){o.jumpToMiniGame(i)})}}break;default:console.log("ASCSDK","不存在该种类型结算互推:"+e)}}hideNavigateSettle(){this.navigateSettleBg?(console.log("ASCSDK","hideNavigateSettle==========================="),this.navigateSettleBg.removeSelf(),this.navigateSettleBg=null):console.log("ASCSDK","不存在结算互推 return")}jumpToMiniGame(e){console.log("ASCSDK","jumpToMiniGame==========================="),Te.getInstance().statistics(e),qg.navigateToMiniGame({pkgName:e.pushGamePackage,success:function(){},fail:function(e){console.log("ASCSDK",JSON.stringify(e))}})}}class oe{constructor(){this.nativeIcon=null,this.navigateSettle=null,this.navigateBanner=null,this.navigatePortal=null,this.NavigateBoxPortalUIInfo=null,this.navigatePortalErrorTimes=0,this.testBannerOnShow=!1}static getInstance(){return oe.instance||(oe.instance=new oe),oe.instance}showNavigateIcon(e,t,i,a){this.nativeIcon?console.log("ASCSDK","Test 已存在互推ICON return"):(console.log("ASCSDK","Test showNavigateIcon=================="),this.nativeIcon=new Laya.Sprite,this.nativeIcon.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/iconBg.png"),this.nativeIcon.width=152,this.nativeIcon.height=152,this.nativeIcon.scaleX=e/152,this.nativeIcon.scaleY=t/152,this.nativeIcon.x=i,this.nativeIcon.y=a,Laya.stage.addChild(this.nativeIcon),this.nativeIcon.zOrder=29999)}hideNavigateIcon(){this.nativeIcon?(console.log("ASCSDK","Test hideNavigateIcon===================="),this.nativeIcon.removeSelf(),this.nativeIcon=null):console.log("ASCSDK","Test 不存在互推ICON return")}showNavigateSettle(e,t,i){if(this.navigateSettle)console.log("ASCSDK","Test 已存在结算互推 return");else{ve.getInstance().hideBanner(),console.log("ASCSDK","Test showNavigateSettle==================");switch(e){case 1:this.navigateSettle=new Laya.Sprite,this.navigateSettle.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestNavigateSettle.png"),Laya.stage.width<Laya.stage.height?(this.navigateSettle.width=.65*Laya.stage.width,this.navigateSettle.height=this.navigateSettle.width/1.15):(this.navigateSettle.height=Laya.stage.height/5*2,this.navigateSettle.width=1.15*this.navigateSettle.height),this.navigateSettle.x=t-this.navigateSettle.width/2,this.navigateSettle.y=i-this.navigateSettle.height/2,this.navigateSettle.zOrder=3e4,Laya.stage.addChild(this.navigateSettle);break;case 3:this.navigateSettle=new Laya.Sprite,this.navigateSettle.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestNavigateSettleType3.png"),Laya.stage.width<Laya.stage.height?(this.navigateSettle.width=.904*Laya.stage.width,this.navigateSettle.height=.317*this.navigateSettle.width):(this.navigateSettle.height=Laya.stage.height/5,this.navigateSettle.width=this.navigateSettle.height/.317),this.navigateSettle.x=t-this.navigateSettle.width/2,this.navigateSettle.y=i-this.navigateSettle.height/2,this.navigateSettle.zOrder=3e4,Laya.stage.addChild(this.navigateSettle);break;case 4:this.navigateSettle=new Laya.Sprite,this.navigateSettle.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestNavigateBoxBanner.png"),Laya.stage.width<Laya.stage.height?(this.navigateSettle.width=Laya.stage.width,this.navigateSettle.height=13*this.navigateSettle.width/35):(this.navigateSettle.height=.4*Laya.stage.height,this.navigateSettle.width=35*this.navigateSettle.height/13),this.navigateSettle.x=Laya.stage.width/2-this.navigateSettle.width/2,this.navigateSettle.y=Laya.stage.height-this.navigateSettle.height-i,this.navigateSettle.zOrder=29999,Laya.stage.addChild(this.navigateSettle);break;default:console.log("ASCSDK","无该种类型的结算互推:"+e)}}}hideNavigateSettle(){this.navigateSettle?(console.log("ASCSDK","Test hideNavigateSettle===================="),this.navigateSettle.removeSelf(),this.navigateSettle=null):console.log("ASCSDK","Test 不存在测试结算互推 return")}showNavigateBoxBanner(){if(this.navigateBanner)return void console.log("ASCSDK","Test 已存在测试互推盒子横幅 return");ve.getInstance().hideBanner(),console.log("ASCSDK","Test showNavigateBoxBanner====================");let e=this;e.navigateBanner=new Laya.Sprite,e.navigateBanner.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestNavigateBoxBanner.png"),Laya.stage.width<Laya.stage.height?(e.navigateBanner.width=Laya.stage.width,e.navigateBanner.height=.22*Laya.stage.height):(e.navigateBanner.width=Laya.stage.width/2,e.navigateBanner.height=.4*Laya.stage.height,e.navigateBanner.x=Laya.stage.width/2-e.navigateBanner.width/2),e.navigateBanner.y=Laya.stage.height-e.navigateBanner.height,e.navigateBanner.zOrder=29999,Laya.stage.addChild(e.navigateBanner)}hideNavigateBoxBanner(){this.navigateBanner?(console.log("ASCSDK","Test hideNavigateBoxBanner===================="),this.navigateBanner.removeSelf(),this.navigateBanner=null):console.log("ASCSDK","Test 不存在测试互推盒子横幅 return")}showNavigateBoxPortal(){this.NavigateBoxPortalUIInfo={layerBg:null,navigatePortal:null,exit:null};var e=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NativeIntersRes/layerBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestNavigateBoxPortal.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/nativeClose.png"];let t=this;Laya.loader.load(e,Laya.Handler.create(this,function(){t.NavigateBoxPortalUIInfo.layerBg=e[0],t.NavigateBoxPortalUIInfo.navigatePortal=e[1],t.NavigateBoxPortalUIInfo.exit=e[2],this.testBannerOnShow=ve.getInstance().testBannerShow,ve.getInstance().hideBanner(),console.log("ASCSDK","Test showNavigateBoxPortal====================");let i=new Laya.Sprite;i.loadImage(t.NavigateBoxPortalUIInfo.layerBg),i.width=Laya.stage.width,i.height=Laya.stage.height,i.zOrder=30003,i.alpha=.8,Laya.stage.addChild(i),i.mouseEnabled=!0;let a=new Laya.Sprite;a.loadImage(t.NavigateBoxPortalUIInfo.navigatePortal),a.width=520,a.height=628,a.x=i.width/2-a.width/2,a.y=i.height/2-a.height/2,i.addChild(a);let n=new Laya.Sprite;n.loadImage(t.NavigateBoxPortalUIInfo.exit),n.width=50,n.height=50,n.x=a.width-n.width,n.y=3*a.height/32,a.addChild(n),n.on("click",this,function(){i.removeSelf(),t.testBannerOnShow&&ve.getInstance().showBanner()})}))}}class re{constructor(){this.navigateBg=null,this.navigateInfom=null,this.NavigateBanner=null,this.NavigateBannerUITextures=null,this.isLoadNavigateBanner=!1,this.NavigatePortalUITextures=null,this.layerBg=null,this.isLoadNavigatePortal=!1}static getInstance(){return re.instance||(re.instance=new re),re.instance}showNavigateIcon(e,t,i,a){if(this.navigateBg)return void console.log("ASCSDK","已存在互推ICON return");console.log("ASCSDK","showNavigateIcon===========================");let n=se.getInstance(),s=this;this.navigateBg=new Laya.Sprite,this.navigateBg.width=e,this.navigateBg.height=t,this.navigateBg.x=i,this.navigateBg.y=a,this.navigateBg.on("click",this,function(){s.jumpToMiniGame(s.navigateInfom)}),Laya.stage.addChild(this.navigateBg),this.navigateBg.zOrder=29999;var o=new Laya.Sprite;o.width=.84*this.navigateBg.width,o.height=.84*this.navigateBg.height,this.navigateBg.addChild(o);var r=new Laya.Sprite;r.loadImage(n.navigateUITextures.moreGameTexture),r.width=.84*this.navigateBg.width,r.height=.19*this.navigateBg.height,r.x=0,r.y=.65*t,r.zOrder=20,o.addChild(r);var h=new Laya.Sprite;h.loadImage(n.navigateUITextures.maskTexture,Laya.Handler.create(this,function(){o.mask=h})),h.width=.84*e,h.height=.84*t,h.x=0,h.y=0;let l=0;var d=function(){if(s.navigateBg){var i=s.updateNavigateIcon();o.loadImage(i),o.scale(e/s.navigateBg.width*.84,t/s.navigateBg.height*.84)}};l=setInterval(d,3e4),d()}updateNavigateIcon(){console.log("ASCSDK","updateNavigateIcon===========================");for(var e=he.getInstance().navigateList,t=0,i=0;i<e.length;i++)e[i].sort>0&&(t+=e[i].sort);var a=Math.floor(Math.random()*t),n=0;let s=null,o=0;for(let t=0;t<e.length;t++)0!=e[t].sort&&(a>=n&&a<n+e[t].sort&&(s=e[t],o=t,console.log("ASCSDK","weight",a,e[t].pushGamePackage)),n+=e[t].sort);if(s)return this.navigateInfom=s,se.getInstance().NavigateIconTextureList[o]}hideNavigateIcon(){se.getInstance().navigateIconTimeInterval&&clearInterval(se.getInstance().navigateIconTimeInterval),this.navigateBg?(console.log("ASCSDK","hideNavigateIcon==========================="),Laya.stage.removeChild(this.navigateBg),this.navigateBg=null):console.log("ASCSDK","不存在互推ICON return")}createNavigateBanner(){console.log("ASCSDK","WX 开始加载互推横幅资源");var e=this;this.NavigateBannerUITextures={navigateBanner:null};var t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateSettleRes/navigateBanner.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.NavigateBannerUITextures.navigateBanner=t[0],e.isLoadNavigateBanner=!0,console.log("ASCSDK","WX 互推横幅资源加载成功")}))}showNavigateBanner(){if(!this.isLoadNavigateBanner)return void console.log("ASCSDK","WX 互推横幅资源未加载完成");if(this.NavigateBanner)return void console.log("ASCSDK","WX 已存在互推横幅");let e=he.getInstance().navigateList;if(e.length<5)return void console.log("ASCSDK","WX 互推样式的游戏数量小于5个 return");ve.getInstance().hideBanner(),console.log("ASCSDK","showNavigateBanner================");var t=[];for(let i=0;i<e.length;i++)t[i]=e[i],t[i].index=i;var i=function(){for(var e=0,i=0;i<t.length;i++)e+=t[i].sort;var a=Math.floor(Math.random()*e),n=0;for(let e=0;e<t.length;e++){if(a>=n&&a<n+t[e].sort){var s=t[e];return t.splice(e,1),s}n+=t[e].sort}};let a=this;this.NavigateBanner=new Laya.Sprite,this.NavigateBanner.loadImage(this.NavigateBannerUITextures.navigateBanner),Laya.stage.width<Laya.stage.height?(this.NavigateBanner.width=Laya.stage.width,this.NavigateBanner.height=13*this.NavigateBanner.width/35):(this.NavigateBanner.height=.4*Laya.stage.height,this.NavigateBanner.width=35*this.NavigateBanner.height/13),this.NavigateBanner.x=(Laya.stage.width-this.NavigateBanner.width)/2,this.NavigateBanner.y=Laya.stage.height-this.NavigateBanner.height,Laya.stage.addChild(this.NavigateBanner);for(let e=0;e<5;e++){let t=i(),n=new Laya.Sprite;n.loadImage(se.getInstance().NavigateIconTextureList[t.index]),n.width=this.NavigateBanner.width/6.5,n.height=n.width,n.x=this.NavigateBanner.width/25+this.NavigateBanner.width/5.25*e,n.y=this.NavigateBanner.height/2.8,this.NavigateBanner.addChild(n);let s=new Laya.Label;s.color="#000000";let o=t.pushGameName;t.pushGameName.length>4&&(o=o.substring(0,4)+"..."),s.text=o,s.fontSize=30,s.align="center",s.valign="middle",s.overflow="scroll",s.width=n.width,s.height=.4*n.height,s.x=0,s.y=n.height,n.addChild(s),n.on("click",this,function(){a.jumpToMiniGame(t)})}}hideNavigateBanner(){console.log("ASCSDK","hideNavigateBanner================"),this.NavigateBanner&&(this.NavigateBanner.removeSelf(),this.NavigateBanner=null)}createNavigatePortal(){console.log("ASCSDK","WX 开始加载互推九宫格资源");var e=this;this.NavigatePortalUITextures={layerBg:null,navigatePortal:null,navigatePortalClose:null};var t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateBox/layerBg.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateBox/NavigatePortal.png","https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateBox/NavigatePortalClose.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.NavigatePortalUITextures.layerBg=t[0],e.NavigatePortalUITextures.navigatePortal=t[1],e.NavigatePortalUITextures.navigatePortalClose=t[2],e.isLoadNavigatePortal=!0,console.log("ASCSDK","WX 互推九宫格资源加载成功")}))}showNavigatePortal(){if(!this.isLoadNavigatePortal)return void console.log("ASCSDK","WX 互推九宫格资源未加载完成");if(this.layerBg)return void console.log("ASCSDK","WX 已存在互推横幅");let e=he.getInstance().navigateList;if(e.length<9)return void console.log("ASCSDK","WX 互推样式的游戏数量小于9个 return");console.log("ASCSDK","showNavigatePortal================");var t=[];for(let i=0;i<e.length;i++)t[i]=e[i],t[i].index=i;var i=function(){for(var e=0,i=0;i<t.length;i++)e+=t[i].sort;var a=Math.floor(Math.random()*e),n=0;for(let e=0;e<t.length;e++){if(a>=n&&a<n+t[e].sort){var s=t[e];return t.splice(e,1),s}n+=t[e].sort}};let a=this;this.layerBg=new Laya.Sprite,this.layerBg.loadImage(this.NavigatePortalUITextures.layerBg),this.layerBg.width=Laya.stage.width,this.layerBg.height=Laya.stage.height,this.layerBg.zOrder=30003,this.layerBg.alpha=.8,Laya.stage.addChild(this.layerBg),this.layerBg.on("click",this,function(){});let n=new Laya.Sprite;n.loadImage(this.NavigatePortalUITextures.navigatePortal),n.width=780,n.height=942,n.x=this.layerBg.width/2-n.width/2,n.y=this.layerBg.height/2-n.height/2,this.layerBg.addChild(n);let s=new Laya.Sprite;s.loadImage(this.NavigatePortalUITextures.navigatePortalClose),s.width=50,s.height=50,s.x=n.width-1.5*s.width,s.y=n.height/2-s.height/2-12*n.height/32+s.height/2,n.addChild(s),s.on("click",this,function(){console.log("ASCSDK","用户手动关闭互推九宫格"),a.layerBg.removeSelf(),a.layerBg=null});for(let e=0;e<9;e++){let t=i(),s=new Laya.Sprite;s.loadImage(se.getInstance().NavigateIconTextureList[t.index]),s.width=n.width/5,s.height=s.width,s.x=n.width/2-s.width/2-240+e%3*240,s.y=n.height/2+s.height/6+180-240*Math.floor(e/3),n.addChild(s);let o=new Laya.Label;o.color="#000000",o.text=t.pushGameName,o.fontSize=30,o.align="center",o.valign="middle",o.overflow="scroll",o.width=s.width,o.height=.234*s.height+20,o.x=0,o.y=s.height,s.addChild(o),s.on("click",this,function(){a.jumpToMiniGame(t)})}}jumpToMiniGame(e){console.log("ASCSDK","WX jumpToMiniGame==========================="),wx.navigateToMiniProgram({appId:e.pushGamePackage,path:"?foo=bar",success(t){Te.getInstance().statistics(e),console.log("ASCSDK","WX 跳转成功")},fail(e){console.log("ASCSDK","WX 跳转失败："+JSON.stringify(e))}})}}class he{constructor(){this.SW_BoxSwitch=!1,this.gameBannerAd=null,this.isLoadNavigateBoxBanner=!1,this.gamePortalAd=null,this.isLoadNavigateBoxPortal=!1,this.hasShowBanner=!1,this.SW_NavigateIconSwitch=!1,this.SW_NavigateGroupSwitch=!1,this.SW_NavigateSettleSwitch=!1,this.navigateList=[],this.isNavigateIconShow=!1,this.isNavigateGroupShow=!1,this.isNavigateSettleShow=!1}static getInstance(){return he.instance||(he.instance=new he),he.instance}createNavigateIcon(){this.SW_NavigateIconSwitch?se.getInstance().loadNavigateIconRes():console.log("ASCSDK","互推ICON开关未开启")}getNavigateIconFlag(){return q.getPlatform()==X.GP_Test||(q.getPlatform()==X.GP_WX?se.getInstance().isLoadNavigateIcon&&se.getInstance().isLoadNavigateList:se.getInstance().isLoadNavigateIcon&&!this.isNavigateIconShow&&se.getInstance().isLoadNavigateList)}showNavigateIcon(e,t,i,a){q.getPlatform()!=X.GP_Test?q.getPlatform()!=X.GP_WX?this.SW_NavigateIconSwitch?(this.isNavigateIconShow=!0,se.getInstance().showNavigateIcon(e,t,i,a)):console.log("ASCSDK","互推ICON开关未开启"):re.getInstance().showNavigateIcon(e,t,i,a):oe.getInstance().showNavigateIcon(e,t,i,a)}hideNavigateIcon(){q.getPlatform()!=X.GP_Test?q.getPlatform()!=X.GP_WX?(this.isNavigateIconShow=!1,se.getInstance().hideNavigateIcon()):re.getInstance().hideNavigateIcon():oe.getInstance().hideNavigateIcon()}createNavigateGroup(){this.SW_NavigateGroupSwitch?se.getInstance().loadNavigateGroup():console.log("ASCSDK","互推列表开关未开启")}getNavigateGroupFlag(){return q.getPlatform()==X.GP_Test?(console.log("ASCSDK","Test 没有测试互推列表============"),!1):se.getInstance().isLoadNavigateGroup&&!this.isNavigateGroupShow&&se.getInstance().isLoadNavigateList}showNavigateGroup(e,t){q.getPlatform()!=X.GP_Test?this.SW_NavigateGroupSwitch?(this.isNavigateGroupShow=!0,se.getInstance().showNavigateGroup(e,t)):console.log("ASCSDK","互推列表开关未开启"):console.log("ASCSDK","Test 没有测试互推列表============")}hideNavigateGroup(){q.getPlatform()!=X.GP_Test?(this.isNavigateGroupShow=!1,se.getInstance().hideNavigateGroup()):console.log("ASCSDK","Test 没有测试互推列表============")}createNavigateSettle(){this.SW_NavigateSettleSwitch?se.getInstance().loadNavigateSettleRes():console.log("ASCSDK","结算互推开关未开启")}getNavigateSettleFlag(){return q.getPlatform()==X.GP_Test||se.getInstance().isLoadNavigateSettle&&!this.isNavigateSettleShow&&se.getInstance().isLoadNavigateList}showNavigateSettle(e,t,i){if(q.getPlatform()==X.GP_Test)return this.isNavigateSettleShow=!0,void oe.getInstance().showNavigateSettle(e,t,i);this.SW_NavigateSettleSwitch?(this.isNavigateSettleShow=!0,se.getInstance().showNavigateSettle(e,t,i)):console.log("ASCSDK","结算互推开关未开启")}hideNavigateSettle(){if(q.getPlatform()==X.GP_Test)return this.isNavigateSettleShow=!1,void oe.getInstance().hideNavigateSettle();this.isNavigateSettleShow=!1,se.getInstance().hideNavigateSettle()}loadNavigateList(){this.navigateList?se.getInstance().loadNavigateList():console.log("ASCSDK","互推列表加载出错")}createNavigateBoxBanner(e){if(!this.SW_BoxSwitch)return void console.log("ASCSDK","OPPO 互推盒子广告开关未开启");if(qg.getSystemInfoSync().platformVersionCode<1076)return void console.log("ASCSDK","OPPO 版本较低,不支持互推盒子广告");console.log("ASCSDK","OPPO 互推盒子横幅广告初始化",e),this.gameBannerAd=qg.createGameBannerAd({adUnitId:e}),this.isLoadNavigateBoxBanner=!0;let t=this;this.gameBannerAd.onError(function(e){t.isLoadNavigateBoxBanner=!1,console.log("ASCSDK","OPPO 互推盒子横幅广告出错:",JSON.stringify(e))})}getNavigateBoxBannerFlag(){switch(q.getPlatform()){case X.GP_Test:return!0;case X.GP_Oppo:return this.isLoadNavigateBoxBanner;case X.GP_WX:return re.getInstance().isLoadNavigateBanner;default:return!1}}showNavigateBoxBanner(){return q.getPlatform()==X.GP_Test?(this.isNavigateSettleShow=!0,void oe.getInstance().showNavigateBoxBanner()):q.getPlatform()==X.GP_WX?(this.isNavigateSettleShow=!0,void re.getInstance().showNavigateBanner()):void(this.SW_BoxSwitch?q.getPlatform()==X.GP_Oppo?this.isLoadNavigateBoxBanner?(console.log("ASCSDK","showNavigateBoxBanner====================="),this.isNavigateSettleShow=!0,this.gameBannerAd?(ve.getInstance().hideBanner(),this.gameBannerAd.show()):console.log("ASCSDK","OPPO 不存在互推盒子横幅广告实例")):console.log("ASCSDK","OPPO 互推盒子横幅广告未加载完成"):console.log("ASCSDK","非OPPO平台,不能展示互推盒子横幅广告"):console.log("ASCSDK","OPPO 互推盒子广告开关未开启"))}hideNavigateBoxBanner(){this.isNavigateSettleShow=!1,q.getPlatform()!=X.GP_Test?q.getPlatform()!=X.GP_WX?this.gameBannerAd?(console.log("ASCSDK","hideNavigateBoxBanner====================="),this.gameBannerAd.hide()):console.log("ASCSDK","OPPO 不存在互推盒子横幅广告实例"):re.getInstance().hideNavigateBanner():oe.getInstance().hideNavigateBoxBanner()}createNavigateBoxPortal(e){if(!this.SW_BoxSwitch)return void console.log("ASCSDK","OPPO 互推盒子广告开关未开启");if(qg.getSystemInfoSync().platformVersionCode<1076)return void console.log("ASCSDK","OPPO 版本较低,不支持互推盒子广告");console.log("ASCSDK","OPPO 互推盒子九宫格广告初始化",e),this.gamePortalAd=qg.createGamePortalAd({adUnitId:e});let t=this;this.gamePortalAd.onLoad(function(){console.log("ASCSDK","OPPO 互推盒子九宫格广告加载完成"),t.isLoadNavigateBoxPortal=!0}),this.gamePortalAd.onError(function(e){console.log("ASCSDK","OPPO 互推盒子九宫格广告出错:",JSON.stringify(e)),t.isLoadNavigateBoxPortal=!1,setTimeout(()=>{t.gamePortalAd.load()},2e4)}),this.gamePortalAd.onClose(function(){console.log("ASCSDK","OPPO 互推盒子九宫格广告关闭"),t.gamePortalAd.load(),t.hasShowBanner&&ve.getInstance().showBanner()}),this.gamePortalAd.load()}getNavigateBoxPortalFlag(){switch(q.getPlatform()){case X.GP_Test:return!0;case X.GP_Oppo:return this.isLoadNavigateBoxPortal;case X.GP_WX:return re.getInstance().isLoadNavigatePortal;default:return!1}}showNavigateBoxPortal(){q.getPlatform()!=X.GP_Test?q.getPlatform()!=X.GP_WX?this.SW_BoxSwitch?q.getPlatform()==X.GP_Oppo?this.isLoadNavigateBoxPortal?(console.log("ASCSDK","showNavigateBoxPortal====================="),this.gamePortalAd?(this.hasShowBanner=ve.getInstance().hasShowBanner,ve.getInstance().hideBanner(),this.gamePortalAd.show()):console.log("ASCSDK","OPPO 不存在互推盒子九宫格广告实例")):console.log("ASCSDK","OPPO 互推盒子九宫格广告未加载完成"):console.log("ASCSDK","非OPPO平台,不能展示互推盒子九宫格广告"):console.log("ASCSDK","OPPO 互推盒子广告开关未开启"):re.getInstance().showNavigatePortal():oe.getInstance().showNavigateBoxPortal()}}class le{constructor(){this.bannerAd=null,this.systemBannerOnShow=!1}static getInstance(){return le.instance||(le.instance=new le),le.instance}createSystemBanner(e){if(e){console.log("ASCSDK","OPPO Banner广告初始化",e);var t=this;this.bannerAd=qg.createBannerAd({adUnitId:e,style:{}}),ve.getInstance().isLoadSystemeBanner=!0,this.bannerAd.onLoad(function(){t.systemBannerOnShow=!0,console.log("ASCSDK","OPPO 系统banner展示中===================")}),this.bannerAd.onError(function(e){console.log("ASCSDK","OPPO 系统banner加载失败：",JSON.stringify(e)),"adItemList is null."==e.msg&&(ve.getInstance().isLoadSystemeBanner=!1,t.hideSystemBanner(),ve.getInstance().showBanner())}),this.bannerAd.onHide(function(){console.log("ASCSDK","OPPO 系统banner关闭",ve.getInstance().NUM_BannerUpdateTime+"S之后再次刷新"),t.systemBannerOnShow=!1,ve.getInstance().updateBanner()})}else console.log("ASCSDK","OPPO bannerId为空")}showSystemBanner(){he.getInstance().isNavigateSettleShow?console.log("ASCSDK","OPPO 正在展示结算互推 return"):(console.log("ASCSDK","OPPO showSystemBanner ========================"),this.bannerAd.show())}updateSytemBanner(){he.getInstance().isNavigateSettleShow?console.log("ASCSDK","OPPO 正在展示结算互推 return"):(console.log("ASCSDK","OPPO updateSystemBanner ========================"),this.bannerAd.show())}hideSystemBanner(){this.bannerAd?(console.log("ASCSDK","OPPO hideSystemBanner ========================"),this.bannerAd.offHide(),this.bannerAd.hide(),this.systemBannerOnShow=!1):console.log("ASCSDK","OPPO 不存在系统banner")}}class de{constructor(){this.bannerAd=null,this.systemBannerOnShow=!1,this.updateSytemBannerTmt=null}static getInstance(){return de.instance||(de.instance=new de),de.instance}createSystemBanner(e){if(!e)return void console.log("ASCSDK","VIVO bannerId为空");console.log("ASCSDK","VIVO Banner广告初始化",e),e="e5a3ec53f2114e3896d410c72744327b",this.bannerAd=qg.createBannerAd({posId:e,style:{}}),this.bannerAd.onLoad(function(){ve.getInstance().isLoadSystemeBanner=!0,console.log("ASCSDK","VIVO 系统banner加载成功")});let t=this;this.bannerAd.onError(function(e){console.log("ASCSDK","VIVO 系统banner加载失败：",JSON.stringify(e)),30007==e.errCode&&(console.log("ASCSDK","VIVO 系统banner广告播放次数已达限制"),ve.getInstance().isLoadSystemeBanner=!1,t.hideSystemBanner(),ve.getInstance().showBanner())}),this.bannerAd.onClose(function(){console.log("ASCSDK","VIVO 系统banner关闭",ve.getInstance().NUM_BannerUpdateTime+"S之后再次刷新"),ve.getInstance().bannerClose(),ve.getInstance().updateBanner()})}showSystemBanner(){this.bannerAd?(console.log("ASCSDK","VIVO showSystemBanner ========================"),this.systemBannerOnShow=!0,this.bannerAd.show()):(this.createSystemBanner(ve.getInstance().ID_BannerId),this.updateSytemBannerTmt=setTimeout(()=>{this.systemBannerOnShow=!0,this.bannerAd.show()},2e3))}updateSytemBanner(){let e=this;this.bannerAd?(console.log("ASCSDK","VIVO 刷新系统banner ========================"),this.bannerAd.offClose(),this.bannerAd.offError(),this.bannerAd.offLoad(),this.bannerAd.destroy(),this.createSystemBanner(ve.getInstance().ID_BannerId),this.updateSytemBannerTmt=setTimeout(()=>{e.systemBannerOnShow=!0,e.bannerAd.show()},2e3)):console.log("ASCSDK","VIVO 不存在系统banner")}hideSystemBanner(){this.updateSytemBannerTmt&&clearTimeout(this.updateSytemBannerTmt),this.bannerAd?(console.log("ASCSDK","VIVO hideSystemBanner ========================"),this.bannerAd.offClose(),this.bannerAd.offError(),this.bannerAd.offLoad(),this.bannerAd.destroy(),this.systemBannerOnShow=!1):console.log("ASCSDK","VIVO 不存在系统banner")}}class ce{constructor(){this.bannerUI=null,this.bannerFakeBg=null}static getInstance(){return ce.instance||(ce.instance=new ce),ce.instance}createBanner(){}showBanner(){if(this.bannerFakeBg)return void console.log("ASCSDK","Test 已存在测试Banner return");console.log("ASCSDK","Test showBanner====================");var e=this;let t=["https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/FakeNativeBannerBg.png"];Laya.loader.load(t,Laya.Handler.create(this,function(){e.bannerUI=t[0],this.bannerFakeBg=new Laya.Sprite,this.bannerFakeBg.loadImage(this.bannerUI),Laya.stage.width<Laya.stage.height?(this.bannerFakeBg.width=Laya.stage.width,this.bannerFakeBg.height=.18*Laya.stage.height):(this.bannerFakeBg.width=Laya.stage.width/2,this.bannerFakeBg.height=.18*Laya.stage.height),this.bannerFakeBg.y=Laya.stage.height-this.bannerFakeBg.height,Laya.stage.addChild(this.bannerFakeBg),this.bannerFakeBg.zOrder=3e4}))}hideBanner(){this.bannerFakeBg?(console.log("ASCSDK","Test hideBanner=================="),this.bannerFakeBg.removeSelf(),this.bannerFakeBg=null):console.log("ASCSDK","Test 不存在测试banner return")}}class ge{constructor(){this.bannerAd=null,this.systemBannerOnShow=!1,this.bannerShow=!1,this.updateBanner=null}static getInstance(){return ge.instance||(ge.instance=new ge),ge.instance}createSystemBanner(e){if(!e)return void console.log("ASCSDK","Tiktok bannerId为空");console.log("ASCSDK","Tiktok Banner广告初始化",e);let t=tt.getSystemInfoSync().windowWidth,i=tt.getSystemInfoSync().windowHeight,a=this;this.bannerAd=tt.createBannerAd({adUnitId:e,style:{left:-1e3,top:-1e3}}),this.bannerAd.onResize(function(e){console.log("ASCSDK","Tiktok banner广告重设位置"),a.bannerAd.style.top=i-e.height,a.bannerAd.style.left=(t-e.width)/2}),this.bannerAd.onLoad(function(){console.log("ASCSDK","Tiktok banner广告加载成功"),ve.getInstance().isLoadSystemeBanner=!0,a.bannerShow&&a.showSystemBanner()})}showSystemBanner(){console.log("ASCSDK","Tiktok show systemBanner ========================"),this.bannerShow=!0,ve.getInstance().isLoadSystemeBanner?this.bannerAd.show():console.log("ASCSDK","Tiktok banner广告未加载完成")}updateSytemBanner(){this.updateBanner&&clearInterval(this.updateBanner),this.updateBanner=setInterval(()=>{console.log("ASCSDK","Tiktok 刷新系统banner========================"),this.bannerAd.destroy(),this.createSystemBanner(ve.getInstance().ID_BannerId)},1e3*ve.getInstance().NUM_BannerUpdateTime)}hideSystemBanner(){console.log("ASCSDK","Tiktok hideSystemBanner ========================"),this.bannerAd&&this.bannerAd.hide(),this.bannerShow=!1,this.updateBanner&&clearInterval(this.updateBanner)}}class me{constructor(){this.bannerAd=null,this.systemBannerOnShow=!1,this.bannerShow=!1,this.updateBanner=null}static getInstance(){return me.instance||(me.instance=new me),me.instance}createSystemBanner(e){if(!e)return void console.log("ASCSDK","QQ bannerId为空");console.log("ASCSDK","QQ Banner广告初始化",e);let t=this;var i=Number(qq.getSystemInfoSync().windowWidth),a=Number(qq.getSystemInfoSync().windowHeight);this.bannerAd=qq.createBannerAd({adUnitId:e,style:{left:0,top:0,width:a>i?i:400,height:120},testDemoType:"65"}),this.bannerAd.onResize(function(e){a>i||Laya.stage.height>Laya.stage.width?(t.bannerAd.style.width=i,t.bannerAd.style.height=i):(t.bannerAd.style.width=i/2,t.bannerAd.style.height=i/2),t.bannerAd.style.top=a-e.height,t.bannerAd.style.left=(i-t.bannerAd.style.width)/2}),this.bannerAd.onLoad(function(){console.log("ASCSDK","QQ banner加载成功"),ve.getInstance().isLoadSystemeBanner=!0,t.bannerShow&&(t.showSystemBanner(),a>i?(t.bannerAd.style.width=i,t.bannerAd.style.height=i):(t.bannerAd.style.width=i/2,t.bannerAd.style.width=i/2),t.bannerAd.style.top=a-t.bannerAd.style.realHeight,t.bannerAd.style.left=(i-t.bannerAd.style.width)/2)}),this.bannerAd.onError(function(e){console.log("ASCSDK","QQ banner加载失败"+JSON.stringify(e))})}showSystemBanner(){this.bannerAd&&(console.log("ASCSDK","QQ show systemBanner ========================"),this.bannerShow=!0,this.bannerAd.show())}updateSytemBanner(){this.updateBanner&&clearInterval(this.updateBanner),this.updateBanner=setInterval(()=>{console.log("ASCSDK","QQ updateSystemBanner ========================"),this.bannerAd.offLoad(),this.bannerAd.offError(),this.bannerAd.destroy(),this.createSystemBanner(ve.getInstance().ID_BannerId)},1e3*ve.getInstance().NUM_BannerUpdateTime)}hideSystemBanner(){this.bannerAd?(console.log("ASCSDK","QQ hideSystemBanner ========================"),this.bannerAd.hide(),this.bannerShow=!1,this.systemBannerOnShow=!1):console.log("ASCSDK","QQ 不存在系统banner ========================')")}}class ue{constructor(){this.bannerAd=null,this.updateBanner=null,this.bannerShow=!1}static getInstance(){return ue.instance||(ue.instance=new ue),ue.instance}createSystemBanner(e){console.log("ASCSDK","WX 系统banner广告初始化",e);var t=Number(wx.getSystemInfoSync().windowWidth),i=Number(wx.getSystemInfoSync().windowHeight);this.bannerAd=wx.createBannerAd({adUnitId:e,style:{left:10,top:76,width:i>t?t:400,height:120}});let a=this;this.bannerAd.onResize(function(e){i>t||Laya.stage.height>Laya.stage.width?(a.bannerAd.style.width=t,a.bannerAd.style.height=t):(a.bannerAd.style.width=t/2,a.bannerAd.style.height=t/2),a.bannerAd.style.top=i-e.height,a.bannerAd.style.left=(t-a.bannerAd.style.width)/2}),this.bannerAd.onLoad(function(){console.log("ASCSDK","WX banner加载成功"),ve.getInstance().isLoadSystemeBanner=!0,a.bannerShow&&a.showSystemBanner()}),this.bannerAd.onError(function(e){console.log("ASCSDK","WX banner加载失败"+JSON.stringify(e)),setTimeout(()=>{a.createSystemBanner(ve.getInstance().ID_BannerId)},1e4)})}showSystemBanner(){this.bannerAd?(console.log("ASCSDK","WX showSystemBanner========================"),this.bannerAd.show(),this.bannerShow=!0):console.log("ASCSDK","不存在系统banner广告实例")}updateSytemBanner(){this.updateBanner&&clearInterval(this.updateBanner),this.updateBanner=setInterval(()=>{console.log("ASCSDK","WX 刷新系统banner========================"),this.bannerAd.offLoad(),this.bannerAd.offError(),this.bannerAd.destroy(),this.createSystemBanner(ve.getInstance().ID_BannerId)},1e3*ve.getInstance().NUM_BannerUpdateTime)}hideSystemBanner(){this.bannerAd?(console.log("ASCSDK","WX hideSystemBanner========================"),this.bannerAd.hide(),this.bannerShow=!1):console.log("ASCSDK","不存在banner")}}class ve{constructor(){this.ID_BannerId="",this.SW_SystemBannerSwitch=!1,this.SW_SystemBannerFirst=!0,this.isLoadSystemeBanner=!1,this.NUM_BannerUpdateTime=30,this.NUM_BannerMostShowTimes=1e4,this.SW_NativeBannerSwitch=!1,this.bannerUpdateInterval=null,this.bannerCloseTime=0,this.isLoadBanner=!1,this.loadBannerCheck=null,this.hasShowBanner=!1,this.testBannerShow=!1}static getInstance(){return ve.instance||(ve.instance=new ve),ve.instance}createSystemBanner(){if(this.SW_SystemBannerSwitch)switch(q.getPlatform()){case X.GP_Oppo:le.getInstance().createSystemBanner(this.ID_BannerId);break;case X.GP_Vivo:de.getInstance().createSystemBanner(this.ID_BannerId);break;case X.GP_Tiktok:ge.getInstance().createSystemBanner(this.ID_BannerId);break;case X.GP_QQ:me.getInstance().createSystemBanner(this.ID_BannerId);break;case X.GP_WX:ue.getInstance().createSystemBanner(this.ID_BannerId)}else console.log("ASCSDK","系统Banner开关关闭")}getSystemBannerFlag(){return this.isLoadSystemeBanner}checkLoadSucc(){console.log("ASCSDK","查询banner是否加载完成."),this.loadBannerCheck&&clearTimeout(this.loadBannerCheck),this.SW_SystemBannerSwitch&&this.SW_NativeBannerSwitch&&(this.getSystemBannerFlag()||Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag())?(this.isLoadBanner=!0,this.showBanner()):this.SW_SystemBannerSwitch&&!this.SW_NativeBannerSwitch&&this.getSystemBannerFlag()?(this.isLoadBanner=!0,this.showBanner()):!this.SW_SystemBannerSwitch&&this.SW_NativeBannerSwitch&&(Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag())?(this.isLoadBanner=!0,this.showBanner()):(console.log("ASCSDK","banner未加载完成"),this.loadBannerCheck=setTimeout(()=>{this.checkLoadSucc()},5e3))}showBanner(){if(q.getPlatform()==X.GP_Test)return he.getInstance().isNavigateSettleShow?void console.log("ASCSDK","测试结算互推正在展示,请先关闭测试结算互推再showBanner"):(this.testBannerShow=!0,void ce.getInstance().showBanner());if(this.isLoadBanner){if(this.NUM_BannerMostShowTimes<=this.bannerCloseTime)return this.bannerUpdateInterval&&clearInterval(this.bannerUpdateInterval),void console.log("ASCSDK","banner展示次数(最大关闭次数)已达上限 return");switch(q.getPlatform()){case X.GP_Oppo:case X.GP_Vivo:if(he.getInstance().isNavigateSettleShow)return void console.log("ASCSDK","结算互推正在展示,请先关闭结算互推再showBanner");if(this.hasShowBanner=!0,this.SW_SystemBannerSwitch&&this.SW_NativeBannerSwitch)this.SW_SystemBannerFirst?(console.log("ASCSDK","系统banner优先"),this.getSystemBannerFlag()?(console.log("ASCSDK","系统Banner可以展示"),this.showSystemBanner()):(console.log("ASCSDK","系统Banner没有加载完成"),(Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag())&&(console.log("ASCSDK","改为展示原生Banner"),this.showNativeBanner()))):(console.log("ASCSDK","原生banner优先"),Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag()?(console.log("ASCSDK","原生Banner可以展示"),this.showNativeBanner()):(console.log("ASCSDK","原生Banner没有加载到"),this.getSystemBannerFlag()&&(console.log("ASCSDK","改为展示系统banner"),this.showSystemBanner())));else if(this.SW_SystemBannerSwitch)console.log("ASCSDK","只打开了系统Banner"),this.showSystemBanner();else{if(!this.SW_NativeBannerSwitch)return void console.log("ASCSDK","系统banner开关和原生banner开关都没有打开");console.log("ASCSDK","只打开了原生Banner"),this.showNativeBanner()}this.updateBanner();break;case X.GP_Tiktok:case X.GP_QQ:case X.GP_WX:this.SW_SystemBannerSwitch&&(this.showSystemBanner(),this.updateBanner())}}else this.checkLoadSucc()}showSystemBanner(){switch(q.getPlatform()){case X.GP_Oppo:le.getInstance().showSystemBanner();break;case X.GP_Vivo:de.getInstance().showSystemBanner();break;case X.GP_Tiktok:ge.getInstance().showSystemBanner();break;case X.GP_QQ:me.getInstance().showSystemBanner();break;case X.GP_WX:ue.getInstance().showSystemBanner()}}updateBanner(){if(this.NUM_BannerMostShowTimes<=this.bannerCloseTime)return this.bannerUpdateInterval&&clearInterval(this.bannerUpdateInterval),void console.log("ASCSDK","banner展示次数(最大关闭次数)已达上限 return");switch(q.getPlatform()){case X.GP_Oppo:case X.GP_Vivo:this.bannerUpdateInterval&&clearInterval(this.bannerUpdateInterval),this.bannerUpdateInterval=setInterval(()=>{if(this.NUM_BannerMostShowTimes<=this.bannerCloseTime)return this.bannerUpdateInterval&&clearInterval(this.bannerUpdateInterval),void console.log("ASCSDK","banner展示次数(最大关闭次数)已达上限 return");this.SW_SystemBannerSwitch&&this.SW_NativeBannerSwitch?this.SW_SystemBannerFirst?(console.log("ASCSDK","系统banner优先"),this.getSystemBannerFlag()?(console.log("ASCSDK","刷新系统Banner"),se.getInstance().hideNativeBannerUI(),this.updateSystemBanner()):(console.log("ASCSDK","系统Banner没有加载完成"),(Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag())&&(console.log("ASCSDK","改为刷新原生Banner"),le.getInstance().bannerAd&&le.getInstance().hideSystemBanner(),de.getInstance().bannerAd&&de.getInstance().hideSystemBanner(),this.updateNativeBanner()))):(console.log("ASCSDK","原生banner优先"),Y.getInstance().getIconNativeFlag()||Y.getInstance().getImageNativeFlag()?(console.log("ASCSDK","刷新原生Banner"),le.getInstance().bannerAd&&le.getInstance().hideSystemBanner(),de.getInstance().bannerAd&&de.getInstance().hideSystemBanner(),this.updateNativeBanner()):(console.log("ASCSDK","原生Banner没有加载到"),this.getSystemBannerFlag()&&(console.log("ASCSDK","改为刷新系统banner"),se.getInstance().hideNativeBannerUI(),this.updateSystemBanner()))):this.SW_SystemBannerSwitch?(console.log("ASCSDK","只打开了系统Banner"),this.showSystemBanner()):this.SW_NativeBannerSwitch?(console.log("ASCSDK","只打开了原生Banner"),this.showNativeBanner()):console.log("ASCSDK","系统banner开关和原生banner开关都没有打开")},1e3*this.NUM_BannerUpdateTime);break;case X.GP_Tiktok:case X.GP_QQ:case X.GP_WX:this.SW_SystemBannerSwitch&&this.updateSystemBanner()}}updateSystemBanner(){switch(q.getPlatform()){case X.GP_Oppo:le.getInstance().updateSytemBanner();break;case X.GP_Vivo:de.getInstance().updateSytemBanner();break;case X.GP_Tiktok:ge.getInstance().updateSytemBanner();break;case X.GP_QQ:me.getInstance().updateSytemBanner();break;case X.GP_WX:ue.getInstance().updateSytemBanner()}}updateNativeBanner(){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().updateNativeBanner();break;case X.GP_Vivo:J.getInstance().updateNativeBanner()}}hideBanner(){if(q.getPlatform()==X.GP_Test)return this.testBannerShow=!1,void ce.getInstance().hideBanner();switch(this.loadBannerCheck&&clearTimeout(this.loadBannerCheck),q.getPlatform()){case X.GP_Oppo:this.hasShowBanner=!1,this.bannerUpdateInterval&&(clearInterval(this.bannerUpdateInterval),this.bannerUpdateInterval=null),le.getInstance().hideSystemBanner(),Q.getInstance().hideNativeBaner();break;case X.GP_Vivo:this.bannerUpdateInterval&&(clearInterval(this.bannerUpdateInterval),this.bannerUpdateInterval=null),de.getInstance().hideSystemBanner(),J.getInstance().hideNativeBaner();break;case X.GP_Tiktok:ge.getInstance().hideSystemBanner();break;case X.GP_QQ:me.getInstance().hideSystemBanner();break;case X.GP_WX:ue.getInstance().hideSystemBanner()}}showNativeBanner(){switch(q.getPlatform()){case X.GP_Oppo:Q.getInstance().showNativeBanner();break;case X.GP_Vivo:J.getInstance().showNativeBanner()}}bannerClose(){this.bannerCloseTime++}}class pe{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null}static getInstance(){return pe.instance||(pe.instance=new pe),pe.instance}createVideoAd(e){this.videoAd=qg.createRewardedVideoAd({posId:e}),this.videoAd.onLoad(()=>{console.log("ASCSDK","OPPO 视频广告加载完成"),this.isLoadVideo=!0}),this.videoAd.onError(e=>{console.log("ASCSDK","OPPO 视频加载失败："+JSON.stringify(e)),this.videoAd&&setTimeout(()=>{this.videoAd&&this.videoAd.load()},3e4)}),this.videoAd.onVideoStart(function(){console.log("ASCSDK","OPPO 激励视频开始播放")}),this.videoAd.onClose(e=>{e.isEnded?(console.log("ASCSDK","OPPO 激励视频广告完成，发放奖励"),this.videoCallBack&&(this.videoCallBack(!0),this.videoAd.load())):(console.log("ASCSDK","OPPO 激励视频广告取消关闭，不发放奖励"),this.videoCallBack&&(this.videoCallBack(!1),this.videoAd.load()))}),this.videoAd.load()}getVideoFlag(){return this.isLoadVideo}showVideo(e){this.videoCallBack=e,this.videoAd&&(console.log("ASCSDK","OPPO 展示视频==========================="),this.videoAd.show(),this.isLoadVideo=!1)}}class Se{static getInstance(){return Se.instance||(Se.instance=new Se),Se.instance}showVideo(e){console.log("ASCSDK","Test showVideo==================");var t=Laya.stage.width,i=Laya.stage.height,a=new Laya.Sprite;a.pos(t/2-1280,i/2-1280),a.size(2560,2560),Laya.stage.addChild(a),a.zOrder=99999,a.loadImage("http://minigame.xplaymobile.com/oppo_native_insters%5ClayerBg.png");var n=new Laya.Label;n.font="Microsoft YaHei",n.text="视频播放回调的测试",n.fontSize=30,n.color="#FFFFFF",n.x=a.width/2-n.width/2,n.y=a.height/2-n.height/2-100,a.addChild(n);var s=new Laya.Label;s.font="Microsoft YaHei",s.text="播放成功",s.fontSize=30,s.color="#FFFFFF",s.x=a.width/2-s.width/2-200,s.y=a.height/2-s.height/2+100,a.addChild(s);var o=new Laya.Label;o.font="Microsoft YaHei",o.text="播放失败",o.fontSize=30,o.color="#FFFFFF",o.x=a.width/2-o.width/2+200,o.y=a.height/2-o.height/2+100,a.addChild(o),s.on("click",this,function(t){e(!0),a.removeSelf()}),o.on("click",this,function(t){e(!1),a.removeSelf()})}}class Ie{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null}static getInstance(){return Ie.instance||(Ie.instance=new Ie),Ie.instance}createVideoAd(e){console.log("ASCSDK","VIVO 视频广告初始化",e),e="2c2497fa1b474ab39acd030df602b060",this.videoAd=qg.createRewardedVideoAd({posId:e}),this.videoAd.onLoad(()=>{console.log("ASCSDK","VIVO 视频广告加载完成"),this.isLoadVideo=!0}),this.videoAd.onError(e=>{console.log("ASCSDK","VIVO 视频加载失败 ："+JSON.stringify(e)),this.isLoadVideo=!1,this.videoAd&&setTimeout(()=>{this.videoAd.load()},1e4)}),this.videoAd.onClose(e=>{e.isEnded?(console.log("ASCSDK","VIVO 激励视频广告完成，发放奖励"),this.videoCallBack&&(this.videoCallBack(!0),this.videoCallBack=null)):(console.log("ASCSDK","VIVO 激励视频广告取消关闭，不发放奖励"),this.videoCallBack&&(this.videoCallBack(!1),this.videoCallBack=null)),this.isLoadVideo=!1,setTimeout(()=>{this.videoAd.load()},1e4)})}getVideoFlag(){return this.isLoadVideo}showVideo(e){this.videoCallBack=e,this.videoAd&&(console.log("ASCSDK","VIVO showVideo ==========================="),this.videoAd.show(),this.isLoadVideo=!1)}}class we{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null,this.videoOnShow=!1}static getInstance(){return we.instance||(we.instance=new we),we.instance}getVideoFlag(){return this.isLoadVideo}createVideoAd(e){console.log("ASCSDK","Tiktok 视频广告初始化",e),this.videoAd=tt.createRewardedVideoAd({adUnitId:e}),this.videoAd.onLoad(()=>{console.log("ASCSDK","Tiktok 视频广告加载完成"),this.isLoadVideo=!0}),this.videoAd.onError(e=>{console.log("ASCSDK","Tiktok 视频广告加载失败 ："+JSON.stringify(e)),this.isLoadVideo=!1,this.videoAd&&setTimeout(()=>{this.videoAd&&this.videoAd.load()},3e4)}),this.videoAd.onClose(e=>{setTimeout(()=>{e.isEnded?(console.log("ASCSDK","Tiktok 激励视频广告完成，发放奖励"),this.videoCallBack&&(this.videoCallBack(!0),this.isLoadVideo=!1,this.videoAd.load())):(console.log("ASCSDK","Tiktok 激励视频广告取消关闭，不发放奖励"),this.videoCallBack&&(this.videoCallBack(!1),this.isLoadVideo=!1,this.videoAd.load())),this.videoOnShow=!1},500)})}showVideo(e){if(this.videoOnShow)return void console.log("ASCSDK","视频正在播放中,请勿多次点击！");this.videoOnShow=!0;let t=this;this.videoCallBack=e,this.videoAd?t.videoAd.show().then(()=>{console.log("ASCSDK","Tiktok 激励视频广告显示成功")}).catch(i=>{console.log("ASCSDK","Tiktok 激励视频广告组件出现问题",JSON.stringify(i)),t.videoAd.load().then(()=>{console.log("ASCSDK","Tiktok 激励视频广告手动加载成功"),t.videoAd.show().catch(i=>{console.log("ASCSDK","Tiktok 激励视频广告播放失败",JSON.stringify(i)),t.videoOnShow=!1,e(!1)})})}):(t.videoOnShow=!1,e(!1))}}class fe{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null}static getInstance(){return fe.instance||(fe.instance=new fe),fe.instance}getVideoFlag(){return!this.isLoadVideo&&this.videoAd&&this.videoAd.load(),this.isLoadVideo}createVideoAd(e){console.log("ASCSDK","QQ 视频广告初始化",e);let t=this;this.videoAd=qq.createRewardedVideoAd({adUnitId:e}),this.videoAd.onLoad(()=>{console.log("ASCSDK","QQ 视屏广告加载完成"),t.isLoadVideo=!0}),this.videoAd.onError(e=>{console.log("ASCSDK","QQ 视屏加载失败 ："+JSON.stringify(e)),t.isLoadVideo=!1,this.videoAd&&setTimeout(()=>{t.videoAd&&t.videoAd.load()},3e4)}),this.videoAd.onClose(e=>{setTimeout(()=>{e.isEnded?(console.log("ASCSDK","QQ 激励视频广告完成，发放奖励"),this.videoCallBack&&(this.videoCallBack(!0),this.videoAd.load())):(console.log("ASCSDK","QQ 激励视频广告取消关闭，不发放奖励"),this.videoCallBack&&(this.videoCallBack(!1),this.videoAd.load()))},500)}),this.videoAd.load()}showVideo(e){this.videoAd?(this.videoCallBack=e,console.log("ASCSDK","VIVO showVideo ========================"),this.videoAd.show(),this.isLoadVideo=!1):console.log("ASCSDK","不存在视频广告===============")}}class Ce{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null}static getInstance(){return Ce.instance||(Ce.instance=new Ce),Ce.instance}getVideoFlag(){return!this.isLoadVideo&&this.videoAd&&this.videoAd.load(),this.isLoadVideo}createVideoAd(e){console.log("ASCSDK","WX 视频广告初始化",e);let t=this;this.videoAd=wx.createRewardedVideoAd({adUnitId:e}),this.videoAd.onLoad(()=>{console.log("ASCSDK","WX 视频广告加载完成"),t.isLoadVideo=!0}),this.videoAd.onError(e=>{console.log("ASCSDK","WX 视频广告加载失败："+JSON.stringify(e)),t.isLoadVideo=!1,this.videoAd&&setTimeout(()=>{t.videoAd&&t.videoAd.load()},3e4)}),this.videoAd.onClose(e=>{setTimeout(()=>{e.isEnded?(console.log("ASCSDK","WX 激励视频广告完成,发放奖励"),this.videoCallBack&&(this.videoCallBack(!0),this.videoAd.load())):(console.log("ASCSDK","WX 激励视频广告取消关闭,不发放奖励"),this.videoCallBack&&(this.videoCallBack(!1),this.videoAd.load()))},500)}),this.videoAd.load()}showVideo(e){let t=this;this.videoAd?(this.videoCallBack=e,console.log("ASCSDK","WX showVideo========================"),this.videoAd.show().then(()=>{console.log("ASCSDK","WX 激励视频广告显示成功")}).catch(i=>{console.log("ASCSDK","WX 激励视频广告播放出错",JSON.stringify(i)),t.videoAd.load().then(()=>{console.log("ASCSDK","WX 激励视频广告手动加载成功"),t.videoAd.show().catch(i=>{console.log("ASCSDK","WX 激励视频广告播放失败",JSON.stringify(i)),t.isLoadVideo=!1,e(!1)})})})):console.log("ASCSDK","WX 不存在视频广告实例===============")}}class ye{constructor(){this.isLoadVideo=!1,this.videoAd=null,this.videoCallBack=null}static getInstance(){return ye.instance||(ye.instance=new ye),ye.instance}getVideoFlag(){return this.isLoadVideo}createVideoAd(e){console.log("ASCSDK","KS 视频广告初始化",e);this.videoAd=kwaigame.createRewardedVideoAd({adUnitId:e}),this.videoAd&&(this.isLoadVideo=!0,this.videoAd.onClose(e=>{console.log("ASCSDK","激励视频取消播放"),this.videoCallBack(!1)}),this.videoAd.onReward(e=>{console.log("ASCSDK","激励视频播放完成"),this.videoCallBack(!0)}))}showVideo(e){this.videoAd?(this.videoCallBack=e,console.log("ASCSDK","KS showVideo========================"),this.videoAd.show({success:()=>{},fail:e=>{console.log("ASCSDK","激励视频播放失败: "+JSON.stringify(e))}})):console.log("ASCSDK","不存在视频广告===============")}}class Be{constructor(){this.ID_VideoID="",this.SW_VideoSwitch=!1}static getInstance(){return Be.instance||(Be.instance=new Be),Be.instance}createVideoAd(){if(this.SW_VideoSwitch)switch(q.getPlatform()){case X.GP_Oppo:pe.getInstance().createVideoAd(this.ID_VideoID);break;case X.GP_Vivo:Ie.getInstance().createVideoAd(this.ID_VideoID);break;case X.GP_Tiktok:we.getInstance().createVideoAd(this.ID_VideoID);break;case X.GP_QQ:fe.getInstance().createVideoAd(this.ID_VideoID);break;case X.GP_WX:Ce.getInstance().createVideoAd(this.ID_VideoID);break;case X.GP_KS:ye.getInstance().createVideoAd(this.ID_VideoID)}else console.log("ASCSDK","VIVO 视频开关没有开启")}getVideoFlag(){switch(q.getPlatform()){case X.GP_Oppo:return pe.getInstance().getVideoFlag();case X.GP_Vivo:return Ie.getInstance().getVideoFlag();case X.GP_Tiktok:return we.getInstance().getVideoFlag();case X.GP_QQ:return fe.getInstance().getVideoFlag();case X.GP_WX:return Ce.getInstance().getVideoFlag();case X.GP_KS:return ye.getInstance().getVideoFlag();case X.GP_Test:return!0;default:return!1}}showVideo(e){if(q.getPlatform()!=X.GP_Test)if(this.SW_VideoSwitch)switch(q.getPlatform()){case X.GP_Oppo:pe.getInstance().showVideo(e);break;case X.GP_Vivo:Ie.getInstance().showVideo(e);break;case X.GP_Tiktok:we.getInstance().showVideo(e);break;case X.GP_QQ:fe.getInstance().showVideo(e);break;case X.GP_WX:Ce.getInstance().showVideo(e);break;case X.GP_KS:ye.getInstance().showVideo(e)}else console.log("ASCSDK","视频开关未开启");else Se.getInstance().showVideo(e)}}class Le{constructor(){this.ID_BoxID="",this.SW_BoxSwitch=!1,this.appBoxAd=null,this.isLoadAppBox=!1}static getInstance(){return Le.instance||(Le.instance=new Le),Le.instance}createAppBox(){if(q.getPlatform()==X.GP_Oppo)return void he.getInstance().createNavigateBoxPortal(this.ID_BoxID);if(!this.SW_BoxSwitch)return void console.log("ASCSDK","QQ 盒子广告开关未开启");if(!q.getInstance().isversionNewThanEngineVersion("1.7.1"))return void console.log("ASCSDK","QQ 平台版本过低,不能创建盒子广告");console.log("ASCSDK","QQ 盒子广告初始化",this.ID_BoxID);let e=this;this.appBoxAd=qq.createAppBox({adUnitId:this.ID_BoxID}),this.appBoxAd.load().then(()=>{console.log("ASCSDK","QQ 加载盒子广告完成==================="),e.isLoadAppBox=!0}),this.appBoxAd.onClose(()=>{console.log("ASCSDK","QQ 关闭盒子广告"),e.appBoxAd.load().then(()=>{console.log("ASCSDK","QQ 加载盒子广告完成==================="),e.isLoadAppBox=!0})})}getBoxFlag(){return q.getPlatform()==X.GP_Test?(console.log("ASCSDK","Test 没有测试盒子广告============"),!1):this.isLoadAppBox}showAppBox(){q.getPlatform()!=X.GP_Test?this.SW_BoxSwitch?this.isLoadAppBox?(console.log("ASCSDK","QQ 展示盒子广告========================"),this.appBoxAd.show()):console.log("ASCSDK","QQ 盒子广告未加载完成"):console.log("ASCSDK","QQ 盒子广告开关未开启"):console.log("ASCSDK","Test 没有测试盒子广告============")}}class Ae{constructor(){this.ID_BlockID="",this.blockAd=null,this.isLoadBlock=!1,this.blockOrientation="landscape",this.blockX=32,this.blockY=32,this.blockSize=1,this.updateBlock=null}static getInstance(){return Ae.instance||(Ae.instance=new Ae),Ae.instance}createBlock(e){if(!q.getInstance().isversionNewThanEngineVersion("1.15.0"))return void console.log("ASCSDK","QQ 平台版本过低,不能创建积木广告");this.ID_BlockID=e,console.log("ASCSDK","QQ 积木广告初始化",e);let t=this;this.blockAd=qq.createBlockAd({adUnitId:e,size:t.blockSize,orientation:t.blockOrientation,style:{left:t.blockX,top:t.blockY}}),this.blockAd.onLoad(function(){console.log("ASCSDK","QQ 积木广告加载成功"),t.isLoadBlock=!0}),this.blockAd.onError(function(e){console.log("ASCSDK","QQ 积木广告加载失败:"+JSON.stringify(e)),1004==e.errCode&&console.log("ASCSDK","QQ 积木广告列表为空")})}getBlockFlag(){return this.isLoadBlock}showBlock(e,t,i,a){this.updateBlock&&clearInterval(this.updateBlock);let n=this,s=Number(qq.getSystemInfoSync().windowWidth),o=Number(qq.getSystemInfoSync().windowHeight),r=i;"8.3.6"!=qq.getSystemInfoSync().version?(i=Laya.stage.height-i,this.blockX=t*(s/Laya.stage.width),this.blockY=i*(o/Laya.stage.height),this.blockOrientation=e,this.blockSize=a,this.createBlock(this.ID_BlockID),setTimeout(()=>{console.log("ASCSDK","QQ 展示积木广告==============================="),this.blockAd.show()},500),this.updateBlock=setInterval(()=>{console.log("ASCSDK","QQ 刷新积木广告================"),n.blockAd.offLoad(),n.blockAd.offError(),n.blockAd.destroy(),n.showBlock(n.blockOrientation,t,r,n.blockSize)},3e4)):console.log("ASCSDK","QQ 平台版本过低,不展示积木广告==============")}hideBlock(){this.updateBlock&&clearInterval(this.updateBlock),this.blockAd?(console.log("ASCSDK","QQ hideBlock=========================="),this.blockAd.destroy()):console.log("ASCSDK","QQ 不存在积木广告")}}class De{constructor(){this.nativeIcon=null}static getInstance(){return De.instance||(De.instance=new De),De.instance}showBlock(e,t,i,a){this.nativeIcon?console.log("ASCSDK","Test 已存在测试积木广告 return"):(console.log("ASCSDK","Test showBlock=========================="),this.nativeIcon=new Laya.Sprite,this.nativeIcon.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/NavigateIconRes/iconBg.png"),this.nativeIcon.width=200,this.nativeIcon.height=200,this.nativeIcon.x=t+this.nativeIcon.width/2,this.nativeIcon.y=i-this.nativeIcon.height/2,this.nativeIcon.zOrder=29999,Laya.stage.addChild(this.nativeIcon))}hideBlock(){this.nativeIcon?(console.log("ASCSDK","Test hideBlock=========================="),this.nativeIcon.removeSelf(),this.nativeIcon=null):console.log("ASCSDK","Test 不存在积木广告 return")}}class be{constructor(){this.ID_BlockID="",this.blockAd=null,this.isLoadBlock=!1,this.type="white",this.blockX=0,this.blockY=0,this.blockSize=5,this.updateBlock=null}static getInstance(){return be.instance||(be.instance=new be),be.instance}createBlock(e){if(!q.getInstance().isversionNewThanEngineVersion("2.9.2"))return console.log("ASCSDK","WX 平台版本过低,不能创建积木广告"),void console.log("ASCSDK","当前版本："+wx.getSystemInfoSync().SDKVersion);this.ID_BlockID=e,console.log("ASCSDK","WX 格子(积木)广告初始化",e);let t=this;this.blockAd=wx.createGridAd({adUnitId:e,adTheme:t.type,gridCount:t.blockSize,style:{left:t.blockX,top:t.blockY,width:330,opacity:.8}}),this.blockAd.onLoad(function(){console.log("ASCSDK","WX 格子(积木)广告加载成功"),t.isLoadBlock=!0}),this.blockAd.onError(function(e){console.log("ASCSDK","WX 格子(积木)广告加载失败:"+JSON.stringify(e))})}getBlockFlag(){return this.isLoadBlock}showBlock(e,t,i,a){this.updateBlock&&clearInterval(this.updateBlock);let n=this,s=Number(wx.getSystemInfoSync().windowWidth),o=Number(wx.getSystemInfoSync().windowHeight),r=i;i=Laya.stage.height-i,this.blockX=t*(s/Laya.stage.width),this.blockY=i*(o/Laya.stage.height),this.type=e,this.blockSize=a,this.createBlock(this.ID_BlockID),setTimeout(()=>{console.log("ASCSDK","WX showBlock==============================="),this.blockAd.show()},500),this.updateBlock=setInterval(()=>{console.log("ASCSDK","WX 刷新积木广告================"),n.blockAd.offLoad(),n.blockAd.offError(),n.blockAd.destroy(),n.showBlock(n.type,t,r,n.blockSize)},3e4)}hideBlock(){this.updateBlock&&clearInterval(this.updateBlock),this.blockAd?(console.log("ASCSDK","WX hideBlock=========================="),this.blockAd.destroy()):console.log("ASCSDK","WX 不存在积木广告")}}class Ne{constructor(){this.ID_BlockID=""}static getInstance(){return Ne.instance||(Ne.instance=new Ne),Ne.instance}createBlock(){switch(q.getPlatform()){case X.GP_Oppo:return void he.getInstance().createNavigateBoxBanner(this.ID_BlockID);case X.GP_QQ:return void Ae.getInstance().createBlock(this.ID_BlockID);case X.GP_WX:return void be.getInstance().createBlock(this.ID_BlockID)}}getBlockFlag(){switch(q.getPlatform()){case X.GP_QQ:return Ae.getInstance().getBlockFlag();case X.GP_WX:return be.getInstance().getBlockFlag();case X.GP_Test:return!0}}showBlock(e,t,i,a){switch(q.getPlatform()){case X.GP_QQ:return void Ae.getInstance().showBlock(e,t,i,a);case X.GP_WX:return void be.getInstance().showBlock(e,t,i,a);case X.GP_Test:return void De.getInstance().showBlock(e,t,i,a)}}hideBlock(){switch(q.getPlatform()){case X.GP_Test:return void De.getInstance().hideBlock();case X.GP_QQ:return void Ae.getInstance().hideBlock();case X.GP_WX:return void be.getInstance().hideBlock()}}}const ke=F.getInstance(),Pe="https://cloud.xminigame.com/api";class Te{constructor(){this.mobileToken="",this.isInitCompelete=0,this.hasBeenInit=!1,this.pushAd=!1,this.statisSwitch=!0,this.gameUserId="",this.userData=null,this.userId="",this.userToken="",this.userType=0,this.userInfo=null,this.nickName="",this.avatar="",this.gender=""}static getInstance(){return Te.instance||(Te.instance=new Te),Te.instance}login(e){switch(q.getPlatform()){case X.GP_Oppo:{let t=this;qg.login({success:function(i){console.log("ASCSDK","OPPO 登录成功："+JSON.stringify(i.data)),t.getH5SDKUserInfo(i.data.token,q.getData("ServerUserId",""),e)},fail:function(i){console.log("ASCSDK","OPPO 登录失败,",JSON.stringify(i)),console.log("ASCSDK","OPPO 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e)}})}break;case X.GP_Vivo:console.log("ASCSDK","VIVO 启用游客登录"),this.userRegister(q.getData("ServerUserId",""),e);break;case X.GP_Tiktok:{let t=this;tt.login({force:!1,success(i){i.isLogin?(console.log("ASCSDK","Tiktok 已登录："+JSON.stringify(i)),t.getH5SDKUserInfo(i.code,q.getData("ServerUserId",""),e)):(console.log("ASCSDK","Tiktok 未登录,",JSON.stringify(i)),console.log("ASCSDK","Tiktok 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e))},fail(i){console.log("ASCSDK","Tiktok 登录失败,",JSON.stringify(i)),console.log("ASCSDK","Tiktok 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e)}})}break;case X.GP_QQ:{let t=this;qq.login({success(i){console.log("ASCSDK","QQ 登录成功："+JSON.stringify(i)),t.getH5SDKUserInfo(i.code,q.getData("ServerUserId",""),e)},fail(i){console.log("ASCSDK","QQ 登录失败,",JSON.stringify(i)),console.log("ASCSDK","QQ 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e)}})}break;case X.GP_WX:{let t=this;wx.login({success(i){i.code?(console.log("ASCSDK","WX 登录成功："+JSON.stringify(i)),t.getH5SDKUserInfo(i.code,q.getData("ServerUserId",""),e)):(console.log("ASCSDK","WX 登录失败,"+JSON.stringify(i)),console.log("ASCSDK","WX 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e))},fail(i){console.log("ASCSDK","WX 登录失败,",JSON.stringify(i)),console.log("ASCSDK","WX 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e)}})}break;case X.GP_KS:{let t=this;kwaigame.login({success:i=>{console.log("ASCSDK","KS 登录成功:"+JSON.stringify(i)),t.gameUserId=i.gameUserId,t.getH5SDKUserInfo(i.gameToken,q.getData("ServerUserId",""),e)},fail:i=>{console.log("ASCSDK","KS 登录失败:"+JSON.stringify(i)),console.log("ASCSDK","KS 启用游客登录"),t.userRegister(q.getData("ServerUserId",""),e)}})}}}userRegister(e,t){console.log("ASCSDK","获取游客token");var i={channelId:ke.channelId,signParam:{},userId:e},a=this,n=`${Pe}/xmini-game-user/mobile/login/getVisitorToken`,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var e=s.responseText;e&&console.log("ASCSDK","getVisitorToken 服务器返回的data:",e);var i=JSON.parse(e);if(void 0===i||!i||!i.data)return console.log("ASCSDK","error : is not a json"),void t(!1);var n=i.data.token,o=i.data.userId;n&&void 0!==n&&o&&void 0!==o?(console.log("ASCSDK","注册成功",n,o),a.mobileToken=n,q.saveData("ServerUserId",o),t(!0)):(console.log("ASCSDK","注册失败",n,o),t(!1)),a.userToken=n,a.userId=o,a.userType=0}},console.log("ASCSDK","发送给服务器的Data：",JSON.stringify(i)),s.open("POST",n,!0),s.setRequestHeader("Content-type","application/json"),s.send(JSON.stringify(i))}getH5SDKUserInfo(e,t,i){var a;switch(console.log("ASCSDK","渠道返回的token：",e),q.getPlatform()){case X.GP_Oppo:a={channelId:ke.channelId,signParam:{token:e,sdkVersion:"1.0.0"},userId:t};break;case X.GP_Vivo:a={channelId:ke.channelId,signParam:{token:e},userId:t};break;case X.GP_Tiktok:case X.GP_QQ:case X.GP_WX:a={channelId:ke.channelId,signParam:{code:e,nickName:q.getData("nickName",""),avatar:q.getData("avatarUrl",""),gender:q.getData("gender","0")},userId:t};break;case X.GP_KS:a={channelId:ke.channelId,signParam:{gameUserId:this.gameUserId,gameToken:e,nickName:q.getData("nickName",""),avatar:q.getData("avatarUrl",""),gender:q.getData("gender","0")},userId:t};break;default:i(!1)}console.log("ASCSDK","封装的Data：",JSON.stringify(a));var n=this,s=`${Pe}/xmini-game-user/mobile/login/getMobileToken`;let o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=o.responseText;e&&console.log("ASCSDK","getMobileToken 服务器返回的data：",e);var t=JSON.parse(e);if(void 0===t||!t||!t.data)return console.log("ASCSDK","error : is not a json"),void i(!1);var a=t.data.token,s=t.data.userId;n.nickName=t.data.nickName,""==t.data.gender?n.gender="0":n.gender=t.data.gender,n.avatar=t.data.avatar,a&&void 0!==a&&s&&void 0!==s?(n.mobileToken=a,q.saveData("ServerUserId",s),i(!0)):(console.log("ASCSDK","注册失败"),i(!1)),n.userToken=a,n.userId=s,n.userType=1}},o.open("POST",s,!0),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify(a))}getSDKOnlineConfig(e){if(this.hasBeenInit)return void console.log("ASCSDK","重复初始化 return");this.hasBeenInit=!0;var t=`https://${ke.host}/${ke.co}/AD/${ke.channelId}/${R.getInstance().getChannel()}/config.json`,i=this;let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var t=a.responseText;if(!t)return void console.log("ASCSDK","初始化失败");if(i.pushAd)return;i.pushAd=!0,console.log("ASCSDK","downAdConfigure 下发广告data：",t);var n=JSON.parse(t);if(void 0===n||!n||!n.data)return void console.log("ASCSDK","error : is not a json");if(void 0!==n.data.mainSwitch){if(!n.data.mainSwitch)return void console.log("ASCSDK","广告开关没有开启")}var s=n.data.advertSwitch;void 0!==s.bannerSwitch&&(ve.getInstance().SW_SystemBannerSwitch=s.bannerSwitch),void 0!==s.intersSwitch&&(ne.getInstance().SW_SystemIntersSwitch=s.intersSwitch),void 0!==s.videoSwitch&&(Be.getInstance().SW_VideoSwitch=s.videoSwitch),void 0!==s.nativeBigIntersSwitch&&(Y.getInstance().SW_NativeMainSwitch=s.nativeBigIntersSwitch),void 0!==s.nativeBannerSwitch&&(ve.getInstance().SW_NativeBannerSwitch=s.nativeBannerSwitch),void 0!==s.nativeIntersSwitch&&(ne.getInstance().SW_NativeIntersSwitch=s.nativeIntersSwitch),void 0!==s.boxSwitch&&(Le.getInstance().SW_BoxSwitch=s.boxSwitch,he.getInstance().SW_BoxSwitch=s.boxSwitch);var o=n.data.advertIdentity;if(o.enableSwitch&&void 0!==o?(o.adBannerId&&(ve.getInstance().ID_BannerId=o.adBannerId),o.adIntersId&&(ne.getInstance().ID_SystemIntersId=o.adIntersId),o.adNativeId&&(Y.getInstance().ID_NativeID=o.adNativeId),o.adVideoId&&(Be.getInstance().ID_VideoID=o.adVideoId),o.adBoxId&&(Le.getInstance().ID_BoxID=o.adBoxId),o.adBrickId&&(Ne.getInstance().ID_BlockID=o.adBrickId)):console.log("ASCSDK","广告ID未启用=================="),null!=n.data.combineInters){var r=n.data.combineInters;void 0!==r&&null!=r.enableSwitch&&r.enableSwitch&&(ne.getInstance().NUM_NativeIntersPercent=r.nativeIntersRatio)}if(null!=n.data.dynamicNativeInters){var h=n.data.dynamicNativeInters;void 0!==h.intersSwitch&&null!=h.intersSwitch&&h.intersSwitch&&(Y.getInstance().NUM_NativeIntersReportFrequency=h.reportFrequency)}if(null!=n.data.baseControl){var l=n.data.baseControl;void 0!==l.bannerSwitch&&null!=l.bannerSwitch&&l&&(void 0!==l.refreshTime&&null!=l.refreshTime&&0!=l.refreshTime&&(ve.getInstance().NUM_BannerUpdateTime=l.refreshTime),void 0!==l.priority&&null!=l.priority&&l.priority&&"nativeBanner"==l.priority&&(ve.getInstance().SW_SystemBannerFirst=!1),void 0!==l.maxClose&&null!=l.maxClose&&0!=l.maxClose&&(ve.getInstance().NUM_BannerMostShowTimes=l.maxClose))}if(null!=n.data.baseControl){var d=n.data.baseControl;void 0!==d&&null!=d&&d&&(ne.getInstance().SW_IntersBaseControlSwitch=d.intersSwitch,void 0!==d.startNum&&null!=d.startNum&&0!=d.startNum&&(ne.getInstance().NUM_IntersStartNum=d.startNum),void 0!==d.intervalNum&&null!=d.intervalNum&&0!=d.intervalNum&&(ne.getInstance().NUM_IntersIntervalNum=d.intervalNum),void 0!==d.intervalTime&&null!=d.intervalTime&&0!=d.intervalTime&&(ne.getInstance().NUM_IntersIntervalTime=d.intervalTime),void 0!==d.delayEject&&null!=d.delayEject&&0!=d.delayEject&&(ne.getInstance().NUM_IntersDelayTime=d.delayEject),void 0!==d.delayProbability&&null!=d.delayProbability&&0!=d.delayProbability&&(ne.getInstance().NUM_IntersDelayPercent=d.delayProbability))}if(null!=n.data.desktopSwitch){var c=n.data.desktopSwitch;void 0!==c.desktopIconSwitch&&null!=c.desktopIconSwitch&&c&&(Z.getInstance().SW_DesktopSwitch=c.desktopIconSwitch),void 0!==c.activateDesktopIconSwitch&&null!=c.activateDesktopIconSwitch&&c&&(Z.getInstance().SW_IntersToDesktop=c.activateDesktopIconSwitch),void 0!==c.autoAddDesktopNumber&&null!=c.autoAddDesktopNumber&&c.desktopIconSwitch&&c.activateDesktopIconSwitch&&0!=c.autoAddDesktopNumber&&(Z.getInstance().NUM_DeskAutoMostTimes=c.autoAddDesktopNumber),void 0!==c.intersAddDesktopNumber&&null!=c.intersAddDesktopNumber&&c.activateDesktopIconSwitch&&0!=c.intersAddDesktopNumber&&(Z.getInstance().NUM_IntersAddDesktopNumber=c.intersAddDesktopNumber)}o.adBannerId&&ve.getInstance().createSystemBanner(),o.adIntersId&&ne.getInstance().createSystemInters(),o.adNativeId&&Y.getInstance().createNativeAd(),o.adVideoId&&Be.getInstance().createVideoAd(),o.adBoxId&&Le.getInstance().createAppBox(),o.adBrickId&&Ne.getInstance().createBlock(),ne.getInstance().runIntersInterval(),q.getInstance().initSystemInfo(e)}},a.onerror=function(e){console.log("ASCSDK","err:"+JSON.stringify(e))},a.open("GET",t,!0),a.setRequestHeader("content-type","application/x-www-form-urlencoded"),a.setRequestHeader("Authorization",this.mobileToken),a.send()}statistics(e){if(this.statisSwitch){var t=`${Pe}/xmini-game-user/mobile/pushdata/collectAdPush?channelId=${ke.channelId}&pushGamePackage=${e.pushGamePackage}`,i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=i.responseText;e&&console.log("ASCSDK","互推统计数据:"+e)}},i.open("POST",t,!0),i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("Authorization",this.mobileToken),i.send()}}getUserData(e){console.log("ASCSDK","getUserData====================="),this.userData={userId:this.userId,token:this.userToken,userType:this.userType},e(this.userData)}getUserInfo(e){console.log("ASCSDK","getUserInfo====================="),this.userInfo={head:"",name:"",sex:"",city:"",province:"",country:"",power:!1};let t=this;switch(q.getPlatform()){case X.GP_Tiktok:1==t.userType?tt.getUserInfo({success(i){console.log("ASCSDK","用户授权成功"),t.userInfo.head=i.userInfo.avatarUrl,t.userInfo.name=i.userInfo.nickName,1==i.userInfo.gender?t.userInfo.sex="M":2==i.userInfo.gender?t.userInfo.sex="F":t.userInfo.sex="0",t.userInfo.city=i.userInfo.city,t.userInfo.province=i.userInfo.province,t.userInfo.country=i.userInfo.country,t.userInfo.power=!0,q.saveData("avatarUrl",t.userInfo.head),q.saveData("nickName",t.userInfo.name),q.saveData("gender",t.userInfo.sex),e(t.userInfo)},fail(i){console.log("ASCSDK","用户拒绝授权"),t.userInfo.power=!1,e(t.userInfo)}}):e(t.userInfo);break;case X.GP_Oppo:t.userInfo.head=t.avatar,t.userInfo.name=t.nickName,t.userInfo.sex=t.gender,t.userInfo.power=!0,e(t.userInfo);break;case X.GP_KS:kwaigame.authorize({scope:"Scope.userInfo",success:()=>{console.log("ASCSDK","授权获取用户信息成功")},fail:e=>{console.log("ASCSDK","授权获取用户信息失败: "+JSON.stringify(e))},complete:()=>{console.log("ASCSDK","授权获取用户信息完成")}}),kwaigame.getUserInfo({success:i=>{console.log("ASCSDK","获取用户信息成功："+JSON.stringify(i)),t.userInfo.head=i.userHead,t.userInfo.name=i.userName,t.userInfo.sex=i.gender,t.userInfo.power=!0,q.saveData("avatarUrl",t.userInfo.head),q.saveData("nickName",t.userInfo.name),q.saveData("gender",t.userInfo.sex),e(t.userInfo)},fail:i=>{console.log("ASCSDK","获取用户信息失败: "+JSON.stringify(i)),t.userInfo.power=!1,e(t.userInfo)},complete:()=>{console.log("ASCSDK","获取用户信息完成")}});break;case X.GP_Test:default:e(t.userInfo)}}}class xe{constructor(){this.videoPath=null,this.shareVideoCallback=null,this.isAutoStop=!1,this.gameRecorder=null,this.moreGameButton=null,this.isShowMoreGames=!1,this.nativeIcon=null,this.moreGamesBanner=null}static getInstance(){return xe.instance||(xe.instance=new xe),xe.instance}share(e){switch(q.getPlatform()){case X.GP_Tiktok:tt.shareAppMessage({templateId:e,query:"",success(){console.log("ASCSDK","Tiktok 分享成功")},fail(e){console.log("ASCSDK","Tiktok 分享失败")}})}}startGameVideo(e){switch(q.getPlatform()){case X.GP_Tiktok:this.videoPath=null,e||(e=10),this.gameRecorder=tt.getGameRecorderManager(),this.gameRecorder.onStart(e=>{console.log("ASCSDK","Tiktok 开始录屏")}),this.gameRecorder.onStop(e=>{console.log("ASCSDK","Tiktok 录屏结束",e.videoPath),this.videoPath=e.videoPath,this.shareVideoCallback?(this.shareVideoCallback(this.videoPath),this.shareVideoCallback=null):this.isAutoStop=!0}),this.gameRecorder.onError(e=>{console.log("ASCSDK","Tiktok 录屏错误:"+JSON.stringify(e))}),this.gameRecorder.start({duration:e});break;case X.GP_KS:if(this.videoPath=null,this.gameRecorder=kwaigame.createMediaRecorder(),null===this.gameRecorder)return void console.log("ASCSDK","当前版本App不支持录屏");this.gameRecorder.onStart(e=>{console.log("ASCSDK","KS 录屏开始")}),this.gameRecorder.onStop(e=>{console.log("ASCSDK","KS 录屏结束",JSON.stringify(e)),this.videoPath=e.videoID,this.shareVideoCallback(this.videoPath)}),this.gameRecorder.onError(e=>{console.log("ASCSDK","发生录屏错误",JSON.stringify(e))}),this.gameRecorder.start()}}pauseGameVideo(){switch(q.getPlatform()){case X.GP_Tiktok:console.log("ASCSDK","Tiktok 暂停录屏"),this.gameRecorder&&this.gameRecorder.pause();break;case X.GP_KS:console.log("ASCSDK","KS 暂停录屏=================="),this.gameRecorder&&this.gameRecorder.pause()}}resumeGameVideo(){switch(q.getPlatform()){case X.GP_Tiktok:console.log("ASCSDK","Tiktok 继续录屏"),this.gameRecorder&&this.gameRecorder.resume();break;case X.GP_KS:console.log("ASCSDK","KS 继续录屏=================="),this.gameRecorder&&this.gameRecorder.resume()}}stopGameVideo(e){switch(q.getPlatform()){case X.GP_Tiktok:if(this.shareVideoCallback=e,console.log("ASCSDK","Tiktok stopGameVideo======================="),this.isAutoStop)return this.shareVideoCallback(this.videoPath),this.shareVideoCallback=null,void(this.isAutoStop=!1);this.gameRecorder&&this.gameRecorder.stop();break;case X.GP_KS:this.shareVideoCallback=e,console.log("ASCSDK","KS stopGameVideo=================="),this.gameRecorder&&this.gameRecorder.stop();break;case X.GP_Test:e("0")}}shareVideo(e,t,i,a,n){switch(console.log("ASCSDK","Tiktok 分享录屏",a),q.getPlatform()){case X.GP_Tiktok:if(!a)return;tt.shareAppMessage({channel:"video",title:e,desc:t,extra:{videoPath:a,videoTopics:[i],hashtag_list:[i]},success(){console.log("ASCSDK","Tiktok 分享视频成功"),n(!0)},fail(e){console.log("ASCSDK","Tiktok 分享视频失败:"+JSON.stringify(e)),n(!1)}});break;case X.GP_Test:console.log("ASCSDK","Test 分享视频成功"),n(!0);break;case X.GP_KS:this.gameRecorder&&this.gameRecorder.publishVideo({mouldId:e,video:a,callback:e=>{if(null!=e&&null!=e)return console.log("ASCSDK","分享录屏失败: "+JSON.stringify(e)),-10014==e.code&&console.log("ASCSDK","录屏时间过短"),void n(!1);console.log("ASCSDK","分享录屏成功"),n(!0)}})}}recordClip(e,t){switch(q.getPlatform()){case X.GP_Tiktok:this.gameRecorder&&this.gameRecorder.recordClip({timeRange:[e,t],success(e){console.log("ASCSDK","Tiktok 裁剪唯一索引",e.index)}})}}clipVideo(e,t){switch(q.getPlatform()){case X.GP_Tiktok:this.gameRecorder&&this.gameRecorder.clipVideo({path:e,success(e){console.log("ASCSDK","Tiktok 录屏地址",e.videoPath),t(!0,e.videoPath)},fail(i){console.error("剪辑失败",i),t(!1,e)}})}}showMoreGames(e,t,i,a,n){switch(q.getPlatform()){case X.GP_Tiktok:{if("android"!=tt.getSystemInfoSync().platform)return void console.log("ASCSDK","非安卓手机,不能展示更多游戏按钮 return");if(!q.getInstance().isversionNewThanEngineVersion("1.23.0"))return void console.log("ASCSDK","平台版本过低,不能展示更多游戏按钮,当前版本:"+tt.getSystemInfoSync().SDKVersion);if(this.isShowMoreGames)return void console.log("ASCSDK","正在展示更多游戏按钮 return");this.isShowMoreGames=!0,console.log("ASCSDK","showMoreGames=====================");let s=Number(tt.getSystemInfoSync().windowWidth),o=Number(tt.getSystemInfoSync().windowHeight);t*=s/Laya.stage.width,i*=o/Laya.stage.height,a*=s/Laya.stage.width,n*=o/Laya.stage.height,this.moreGameButton=tt.createMoreGamesButton({type:"image",image:e,style:{left:a,top:n,width:t,height:i,lineHeight:40,backgroundColor:"#ff0000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,borderWidth:0,borderColor:"#ff0000"},appLaunchOptions:[{appId:"ttXXXXXX",query:"foo=bar&baz=qux",extraData:{}}],onNavigateToMiniGameBox(e){console.log("跳转到小游戏盒子",e)}}),this.moreGameButton.onTap(()=>{console.log("ASCSDK","点击更多游戏")})}break;case X.GP_Test:if(this.nativeIcon)return void console.log("ASCSDK","已存在测试更多游戏自定义按钮 return");console.log("ASCSDK","Test showMoreGames====================="),this.nativeIcon=new Laya.Sprite,this.nativeIcon.loadImage(e),this.nativeIcon.width=t,this.nativeIcon.height=i,this.nativeIcon.x=a,this.nativeIcon.y=n,this.nativeIcon.zOrder=29999,Laya.stage.addChild(this.nativeIcon)}}hideMoreGames(){switch(q.getPlatform()){case X.GP_Test:if(!this.nativeIcon)return void console.log("ASCSDK","Test 不存在更多游戏 return");console.log("ASCSDK","Test hideMoreGames====================="),this.nativeIcon.removeSelf(),this.nativeIcon=null;break;case X.GP_Tiktok:if(!this.moreGameButton)return void console.log("ASCSDK","Tiktok 不存在更多游戏 return");console.log("ASCSDK","hideMoreGames====================="),this.isShowMoreGames=!1,this.moreGameButton.destroy(),this.moreGameButton=null}}showMoreGamesModal(){switch(q.getPlatform()){case X.GP_Tiktok:if("android"!=tt.getSystemInfoSync().platform)return void console.log("ASCSDK","非安卓手机,请隐藏更多游戏按钮 return");if(!q.getInstance().isversionNewThanEngineVersion("1.33.0"))return void console.log("ASCSDK","平台版本过低,无法跳入游戏中心,当前版本:"+tt.getSystemInfoSync().SDKVersion);console.log("ASCSDK","showMoreGamesModal====================="),tt.showMoreGamesModal({appLaunchOptions:[{appId:"ttXXXXXX",query:"foo=bar&baz=qux",extraData:{}}],success(e){console.log("success",e.errMsg)},fail(e){console.log("fail",e.errMsg)}});break;case X.GP_Test:console.log("ASCSDK","showMoreGamesModal=====测试点击更多游戏")}}showFavoriteGuide(e,t,i){switch(q.getPlatform()){case X.GP_Tiktok:tt.showFavoriteGuide({type:e,content:t,position:i,success(e){console.log("ASCSDK","引导组件展示成功")},fail(e){console.log("ASCSDK","引导组件展示失败:"+JSON.stringify(e))}})}}showMoreGamesBanner(){switch(q.getPlatform()){case X.GP_Test:console.log("ASCSDK","Test showMoreGamesBanner==============="),this.moreGamesBanner=new Laya.Sprite,this.moreGamesBanner.loadImage("https://tencentcnd.minigame.xplaymobile.com/Other/SDK/SDKImage_3_0/TestRes/TestMoreGamesBanner.png"),this.moreGamesBanner.width=900,this.moreGamesBanner.height=312,this.moreGamesBanner.x=Laya.stage.width/2-this.moreGamesBanner.width/2,this.moreGamesBanner.y=Laya.stage.height-this.moreGamesBanner.height,this.moreGamesBanner.zOrder=3e4,Laya.stage.addChild(this.moreGamesBanner);break;case X.GP_Tiktok:if("android"!=tt.getSystemInfoSync().platform)return void console.log("ASCSDK","非安卓手机,不能展示更多游戏横幅");if(!q.getInstance().isversionNewThanEngineVersion("1.67.0"))return void console.log("ASCSDK","平台版本过低,不能展示更多游戏横幅,当前版本:"+tt.getSystemInfoSync().SDKVersion);console.log("ASCSDK","Tiktok showMoreGamesBanner==============="),this.moreGamesBanner=tt.createMoreGamesBanner({style:{left:0,top:0,width:150,height:40,verticalAlign:"bottom",horizontalAlign:"center"},appLaunchOptions:[{appId:"ttXXXXXX",query:"foo=bar&baz=qux",extraData:{}}]}),this.moreGamesBanner.onError(e=>{console.log("ASCSDK","Tiktok 更多游戏横幅出错:",JSON.stringify(e))}),this.moreGamesBanner.show()}}hideMoreGamesBanner(){switch(q.getPlatform()){case X.GP_Test:console.log("ASCSDK","Test hideMoreGamesBanner==============="),this.moreGamesBanner&&(this.moreGamesBanner.removeSelf(),this.moreGamesBanner=null);break;case X.GP_Tiktok:console.log("ASCSDK","Tiktok hideMoreGamesBanner==============="),this.moreGamesBanner&&this.moreGamesBanner.hide()}}}class Ge{constructor(){this.hasBeenInit=!1,this.channelArray=["OPPO","VIVO","Tiktok","QQ","Test","WX","KS"]}static getInstance(){return Ge.instance||(Ge.instance=new Ge),Ge.instance}initAd(e){console.log("ASCSDK","initAd"),console.log("ASCSDK","当前SDKVersion："+F.SDKVersion),console.log("ASCSDK","当前渠道："+this.channelArray[q.getPlatform()]),this.hasBeenInit?console.log("ASCSDK","重复初始化initAd return================"):(this.hasBeenInit=!0,q.getPlatform()!=X.GP_Test?Te.getInstance().getSDKOnlineConfig(e):e&&e(!0))}showBanner(){console.log("ASCSDK","showBanner"),ve.getInstance().showBanner()}hideBanner(){console.log("ASCSDK","hideBanner"),ve.getInstance().hideBanner()}getIntersFlag(){return console.log("ASCSDK","getIntersFlag:"+ne.getInstance().getIntersFlag()),ne.getInstance().getIntersFlag()}showInters(){console.log("ASCSDK","showInters"),ne.getInstance().showInters()}getVideoFlag(){return console.log("ASCSDK","getVideoFlag:"+Be.getInstance().getVideoFlag()),Be.getInstance().getVideoFlag()}showVideo(e){console.log("ASCSDK","showVideo"),Be.getInstance().showVideo(e)}getNativeIconFlag(){return console.log("ASCSDK","getNativeIconFlag:"+Y.getInstance().getIconNativeFlag()),Y.getInstance().getIconNativeFlag()}showNativeIcon(e,t,i,a){console.log("ASCSDK","showNativeICON"),Y.getInstance().showNativeIcon(e,t,i,a)}hideNativeIcon(){console.log("ASCSDK","hideNativeIcon"),Y.getInstance().hideNativeIcon()}getImageNativeFlag(){return console.log("ASCSDK","getImageNativeFlag:"+Y.getInstance().getImageNativeFlag()),Y.getInstance().getImageNativeFlag()}showNativeImage(e,t,i,a){console.log("ASCSDK","showNativeImage"),Y.getInstance().showNativeImage(e,t,i,a)}hideNativeImage(){console.log("ASCSDK","hideNativeImage"),Y.getInstance().hideNativeImage()}getNativeInfo(){return console.log("ASCSDK","getNativeInfo"),console.log(JSON.stringify(Y.getInstance().getNativeInfo())),Y.getInstance().getNativeInfo()}reportNative(e){console.log("ASCSDK","reportNativeShow"),Y.getInstance().reportNativeShow(e)}nativeClick(e){console.log("ASCSDK","reportNativeClick"),Y.getInstance().reportNativeClick(e)}getNavigateIconFlag(){return console.log("ASCSDK","getNavigateIconFlag:"+he.getInstance().getNavigateIconFlag()),he.getInstance().getNavigateIconFlag()}showNavigateIcon(e,t,i,a){console.log("ASCSDK","showNavigateIcon"),he.getInstance().showNavigateIcon(e,t,i,a)}hideNavigateIcon(){console.log("ASCSDK","hideNavigateIcon"),he.getInstance().hideNavigateIcon()}getNavigateGroupFlag(){return console.log("ASCSDK","getNavigateGroupFlag:"+he.getInstance().getNavigateGroupFlag()),he.getInstance().getNavigateGroupFlag()}showNavigateGroup(e,t){console.log("ASCSDK","showNavigateGroup"),he.getInstance().showNavigateGroup(e,t)}hideNavigateGroup(){console.log("ASCSDK","hideNavigateGroup"),he.getInstance().hideNavigateGroup()}getNavigateSettleFlag(){return console.log("ASCSDK","getNavigateSettleFlag:"+he.getInstance().getNavigateSettleFlag()),he.getInstance().getNavigateSettleFlag()}showNavigateSettle(e,t,i){console.log("ASCSDK","showNavigateSettle"),he.getInstance().showNavigateSettle(e,t,i)}hideNavigateSettle(){console.log("ASCSDK","hideNavigateSettle"),he.getInstance().hideNavigateSettle()}getNavigateBoxBannerFlag(){return console.log("ASCSDK","getNavigateBoxBannerFlag:"+he.getInstance().getNavigateBoxBannerFlag()),he.getInstance().getNavigateBoxBannerFlag()}showNavigateBoxBanner(){console.log("ASCSDK","showNavigateBoxBanner"),he.getInstance().showNavigateBoxBanner()}hideNavigateBoxBanner(){console.log("ASCSDK","hideNavigateBoxBanner"),he.getInstance().hideNavigateBoxBanner()}getNavigateBoxPortalFlag(){return console.log("ASCSDK","getNavigateBoxPortalFlag:"+he.getInstance().getNavigateBoxPortalFlag()),he.getInstance().getNavigateBoxPortalFlag()}showNavigateBoxPortal(){console.log("ASCSDK","showNavigateBoxPortal"),he.getInstance().showNavigateBoxPortal()}setGroup(e){}getDeskTopFlag(e){return console.log("ASCSDK","getDeskTopFlag"),Z.getInstance().getDeskTopFlag(e)}addDeskTop(e){console.log("ASCSDK","addDeskTop"),Z.getInstance().addDeskTop(e)}showToast(e){console.log("ASCSDK","showToast"),Z.getInstance().showToast(e)}phoneVibrate(e){console.log("ASCSDK","phoneVibrate",e),Z.getInstance().phoneVibrate(e)}reportMonitor(){console.log("ASCSDK","reportMonitor"),Z.getInstance().reportMonitor()}reportAnalytics(e,t){console.log("ASCSDK","reportAnalytics"),Z.getInstance().reportAnalytics(e,t)}share(e){console.log("ASCSDK","share",e),xe.getInstance().share(e)}startGameVideo(e){console.log("ASCSDK","startGameVideo",e),xe.getInstance().startGameVideo(e)}pauseGameVideo(){console.log("ASCSDK","pauseGameVideo"),xe.getInstance().pauseGameVideo()}resumeGameVideo(){console.log("ASCSDK","resumeGameVideo"),xe.getInstance().resumeGameVideo()}stopGameVideo(e){console.log("ASCSDK","stopGameVideo"),xe.getInstance().stopGameVideo(e)}shareVideo(e,t,i,a,n){console.log("ASCSDK","shareVideo"),xe.getInstance().shareVideo(e,t,i,a,n)}recordClip(e,t){console.log("ASCSDK","recordClip"),xe.getInstance().recordClip(e,t)}clipVideo(e,t){console.log("ASCSDK","clipVideo"),xe.getInstance().clipVideo(e,t)}showMoreGames(e,t,i,a,n){console.log("ASCSDK","showMoreGames"),xe.getInstance().showMoreGames(e,t,i,a,n)}hideMoreGames(){console.log("ASCSDK","hideMoreGames"),xe.getInstance().hideMoreGames()}showMoreGamesModal(){console.log("ASCSDK","showMoreGamesModal"),xe.getInstance().showMoreGamesModal()}showMoreGamesBanner(){console.log("ASCSDK","showMoreGamesBanner"),xe.getInstance().showMoreGamesBanner()}hideMoreGamesBanner(){console.log("ASCSDK","hideMoreGamesBanner"),xe.getInstance().hideMoreGamesBanner()}showFavoriteGuide(e,t,i){console.log("ASCSDK","showFavoriteGuide"),xe.getInstance().showFavoriteGuide(e,t,i)}getUserData(e){console.log("ASCSDK","getUserData"),Te.getInstance().getUserData(e)}getUserInfo(e){console.log("ASCSDK","getUserInfo"),Te.getInstance().getUserInfo(e)}getBoxFlag(){return console.log("ASCSDK","getBoxFlag:"+Le.getInstance().getBoxFlag()),Le.getInstance().getBoxFlag()}showAppBox(){console.log("ASCSDK","showAppBox"),Le.getInstance().showAppBox()}getBlockFlag(){return console.log("ASCSDK","getBlockFlag:"+Ne.getInstance().getBlockFlag()),Ne.getInstance().getBlockFlag()}showBlock(e,t,i,a){console.log("ASCSDK","showBlock"),Ne.getInstance().showBlock(e,t,i,a)}hideBlock(){console.log("ASCSDK","hideBlock"),Ne.getInstance().hideBlock()}}class _e{constructor(){this.adLogic=null}init(){w.getPlatformType()==s.wx?(this.adLogic=new H,this.adLogic.init()):w.getPlatformType()==s.qq?(this.adLogic=new M,this.adLogic.init()):w.getPlatformType()==s.oppo?(this.adLogic=new U,this.adLogic.init()):w.getPlatformType()==s.vivo?(Ge.getInstance().initAd(e=>{e&&console.log("初始化成功回调")}),this.adLogic=new E,this.adLogic.init()):w.getPlatformType()==s.tt&&(this.adLogic=new K,this.adLogic.init())}getNativeAdRes(){if(w.getPlatformType()==s.oppo){if(this.adLogic.nativeAdPic)return this.adLogic.nativeAdPic.getNativeAdRes()}else if(w.getPlatformType()==s.vivo){let e=Ge.getInstance().getNativeInfo();if(null==e||null==e.adId)return null;let t={adId:e.adId,title:e.title,desc:e.desc,icon:e.Native_icon,imgUrlList:[e.Native_BigImage]};return console.log("ad data = "),console.log(t),t}return null}reportAdShow(e){w.getPlatformType()==s.oppo?this.adLogic.nativeAdPic&&this.adLogic.nativeAdPic.reportAdShow():w.getPlatformType()==s.vivo&&Ge.getInstance().reportNative(e)}reportAdClick(e){w.getPlatformType()==s.oppo?this.adLogic.nativeAdPic&&this.adLogic.nativeAdPic.reportAdClick():w.getPlatformType()==s.vivo&&Ge.getInstance().nativeClick(e)}refreshNativeAd(e){w.getPlatformType()==s.oppo?this.adLogic.nativeAdPic&&this.adLogic.nativeAdPic.refreshNativeAd(e):(w.getPlatformType(),s.vivo)}showBlock(){this.adLogic&&this.adLogic.showBlock()}showBoxAd(e){this.adLogic?this.adLogic.showBoxAd(e):e&&e(!1)}showBannerAd(e){if(w.getPlatformType()==s.vivo)return Ge.getInstance().hideBanner(),void Ge.getInstance().showBanner();this.adLogic&&(w.getPlatformType()==s.oppo?this.adLogic.showNativeBanner(e):w.getPlatformType()==s.vivo?(Ge.getInstance().hideBanner(),Ge.getInstance().showBanner()):this.adLogic.showBannerAd())}hideBannerAd(){w.getPlatformType()!=s.vivo?this.adLogic&&(w.getPlatformType()==s.vivo?Ge.getInstance().hideBanner():this.adLogic.hideBannerAd()):Ge.getInstance().hideBanner()}showAd(e,t){if(w.getPlatformType()==s.vivo)if(Ge.getInstance().getVideoFlag()){let t=function(t){Laya.SoundManager.playMusic("sound/bgm.mp3",0),e&&e(t)};Laya.SoundManager.stopMusic(),Ge.getInstance().showVideo(t)}else w.showSystemNotice("广告展示失败"),e&&e(!1);else{if(!this.adLogic)return void(e&&e(!0));this.adLogic.showAd(e,t)}}showToastFail(e){let t={title:e,icon:"fail",duration:2e3};wx.showToast(t)}showInterstitialAd(){this.adLogic&&this.adLogic.showInterstitialAd()}}class Me{constructor(){this.isLoadComplete=!1}init(){this.isLoadComplete=!1,this.initSound(),this.initMusic();let e=this;if(Laya.Browser.onMiniGame){let t=function(t){e.mSoundChannel?e.mSoundChannel.play():e.playMusic("sound/bgm.mp3",0)};wx.onShow(t)}}initSound(){let e=!0;var t=localStorage.getItem("soundCacheOpen");null!=t&&""!=t&&(e=JSON.parse(t)),Laya.SoundManager.soundMuted=!e}setSound(e){localStorage.setItem("soundCacheOpen",JSON.stringify(e)),Laya.SoundManager.soundMuted=!e}initMusic(){let e=!0;var t=localStorage.getItem("musicCacheOpen");null!=t&&""!=t&&(e=JSON.parse(t)),Laya.SoundManager.musicMuted=!e}setMusic(e){localStorage.setItem("musicCacheOpen",JSON.stringify(e)),Laya.SoundManager.musicMuted=!e,e&&this.playMusic("sound/bgm.mp3",0)}playSound(e,t,i,a){if(!this.isLoadComplete)return;let n=Laya.SoundManager.playSound(e,t,null,null,a);n&&i&&(n.volume=i)}playMusic(e,t){this.isLoadComplete&&(Laya.SoundManager.autoStopMusic=!1,Laya.SoundManager.stopMusic(),this.mSoundChannel=Laya.SoundManager.playMusic(e,t,null,0))}resumeMusic(){let e=this;e.mSoundChannel?e.mSoundChannel.play():e.playMusic("sound/bgm.mp3",0)}loadSound(){let e=this;if(Laya.Browser.onMiniGame&&w.getPlatformType()!==s.tt){wx.loadSubpackage({name:"sound",success:function(t){e.isLoadComplete=!0,e.playMusic("sound/bgm.mp3",0)},fail:function(e){}})}else if(Laya.Browser.onQQMiniGame){qq.loadSubpackage({name:"sound",success:function(t){e.isLoadComplete=!0,e.playMusic("sound/bgm.mp3",0)},fail:function(e){}})}else e.isLoadComplete=!0,e.playMusic("sound/bgm.mp3",0)}}class He{init(){if(this.isCompleteGuide=!1,1==y.isJumpGuide_Test)return this.isCompleteGuide=!0,void this.allComplete();let e=localStorage.getItem("newGuideComplete");null!=e&&""!=e&&(this.isCompleteGuide=!0),this.isCompleteGuide||I.instance.on(t.newGuide_allComplete,this,this.allComplete)}allComplete(){this.isCompleteGuide=!0,localStorage.setItem("newGuideComplete","1"),w.aldEventByType(c.data_newGuideComplete)}}class Ke{constructor(){this.curIsAdEnterScene=!1,this.curIsAdUser=!1,this.adUserLoginDays=0,this.mServerErrorTouch=!1,this.mServerOpenCity=!1,this.isCloseCity=!1,this.isShowSdkRecommend=!1}init(){this.curIsAdEnterScene=!1,this.mServerErrorTouch=!1,this.isShowSdkRecommend=!1,this.isCloseCity=!1,this.errorTouchProbability=100,this.errorTouchBoxProbability=70;let e="",t=1;w.getPlatformType()==s.wx?(t=y.sdk_line_version_wx,e="https://aly-wx-sdk-1251335839.cos.ap-shanghai.myqcloud.com/alyGameInfo_csxd.json",this.loadNetConfig(e,t)):w.getPlatformType()==s.qq?(e="https://h5game.99aly.com/5agamewx/alywx/gameConfig/group3/data/qq/alyGameInfo_jscq.json",t=y.sdk_line_version_qq,this.loadNetConfig(e,t)):w.getPlatformType()==s.oppo||w.getPlatformType()==s.vivo||(w.getPlatformType()==s.tt?(t=y.sdk_line_version_tt,e="https://aly-wx-sdk-1251335839.cos.ap-shanghai.myqcloud.com/alyGameInfo_jscq-wx.json",this.loadNetConfig(e,t)):(e="https://aly-wx-sdk-1251335839.cos.ap-shanghai.myqcloud.com/alyGameInfo_csxd.json",t=y.sdk_line_version_wx,this.loadNetConfig(e,t)))}loadNetConfig(e,t){Laya.loader.load(e,Laya.Handler.create(this,function(e){if(e){let i=e,a=t%2==0?i.version2:i.version1;this._switches=a.switches,this.mServerErrorTouch=JSON.parse(a.switches.checkSwitch),w.getPlatformType()==s.tt&&(this.mServerErrorTouch=JSON.parse(a.switches.checkSwitch_tt),this.mServerOpenCity=JSON.parse(a.switches.openFirstCity_tt)),a.switches.errorTouchProbability&&(this.errorTouchProbability=JSON.parse(a.switches.errorTouchProbability)),a.switches.errorTouchBox&&(this.errorTouchBoxProbability=JSON.parse(a.switches.errorTouchBox)),console.log(t),console.log(a)}else console.warn("列表文件加载失败")}),null,null,0,!1,"",!0)}checkScene(){if(Laya.Browser.onMiniGame){let e=wx.getLaunchOptionsSync();console.log("后台回来111111 ===  "+JSON.stringify(e)),"1037"==e.scene||"1038"==e.scene||"1045"==e.scene||"1046"==e.scene||"1084"==e.scene||"1095"==e.scene||"1067"==e.scene?this.curIsAdEnterScene=!0:this.curIsAdEnterScene=!1;let t=this;wx.onShow(function(e){console.log(e),"1037"==e.scene||"1038"==e.scene||"1045"==e.scene||"1046"==e.scene||"1084"==e.scene||"1095"==e.scene||"1067"==e.scene?t.curIsAdEnterScene=!0:t.curIsAdEnterScene=!1,t.checkAdUser();t.getIsOpenErrorTouch()})}this.checkAdUser()}checkAdscene(){if(Laya.Browser.onMiniGame){let e=wx.getLaunchOptionsSync();"1095"==e.scene||"1037"==e.scene?this.isShowSdkRecommend=!0:this.isShowSdkRecommend=!1;let t=this;wx.onShow(function(e){console.log(e),"1095"==e.scene||"1037"==e.scene?t.isShowSdkRecommend=!0:t.isShowSdkRecommend=!1})}}checkCity(){let e=this;this.isCloseCity=!0,Laya.loader.load("https://pv.sohu.com/cityjson?ie=utf-8",Laya.Handler.create(this,function(t){if(t){if(null==(t=w.splitStr(t,"{","}")))return;t="{"+t+"}",(t=JSON.parse(t)).cityCode=t.cid,console.log(t.cname),w.getPlatformType()==s.tt?"110000"==t.cityCode||"310000"==t.cityCode||"440300"==t.cityCode||"440100"==t.cityCode||"330100"==t.cityCode||"350200"==t.cityCode||"320100"==t.cityCode||"510100"==t.cityCode||"CN"==t.cityCode?e.isCloseCity=!0:e.isCloseCity=!1:"110000"==t.cityCode||"310000"==t.cityCode||"440300"==t.cityCode||"440100"==t.cityCode?e.isCloseCity=!0:e.isCloseCity=!1,console.log(e.isCloseCity)}else console.warn("列表文件加载失败")}),null,null,0,!1,"",!0)}checkAdUser(){this.curIsAdUser=this.curIsAdEnterScene}getIsOpenErrorTouch(){return!!this.mServerErrorTouch}isShowErrorTouchView(){return!1!==this.getIsOpenErrorTouch()&&(w.getPlatformType()!=s.tt&&this.randomErrorTouchBox())}randomErrorTouchBox(){if(Oe.instance.userData.mIsFirstLoginEveryDay)return!0;let e=this.errorTouchProbability;return w.random(0,100)<=e}isErrorTouchBox(){if(w.getPlatformType()==s.wx)return!1;return w.random(1,100)<=this.errorTouchBoxProbability}isShowRecommend(){return w.getPlatformType()===s.wx&&(!1!==this.getIsOpenErrorTouch()&&(!!this.isShowSdkRecommend&&(this.isShowSdkRecommend=!1,!0)))}}class Oe{constructor(){this.isSubPackageLoadCompleteHamster=!1,this.isSubPackageLoadCompleteNpc=!1}static get instance(){return null==Oe._instance&&(Oe._instance=new Oe),Oe._instance}init(){this.eventManager=I.instance,this.eventManager.init(),this.newGuide=new He,this.newGuide.init(),this.userData=new D,this.userData.init(),this.scenesManager=new T,this.scenesManager.init(),this.loadManager=new x,this.loadManager.init(),this.timeManager=new G,this.timeManager.init(),this.soundManager=new Me,this.soundManager.init(),this.errorTouchManager=new Ke,this.errorTouchManager.init(),this.ad=new _e,this.ad.init(),this.loadScene()}loadScene(){this.scenesManager.openScene(y.startScene,Laya.Handler.create(this,this.onCompleteScene),!0)}loadSubpackageAsyn(){let e=this;wx.loadSubpackage({name:"normalTex2",success:function(i){e.isSubPackageLoadCompleteHamster=!0,e.eventManager.fire(t.subPackageLoadCompleteHamster),console.log("normalTex2 完成")},fail:function(e){}})}loadSubpackageAsynNpc(){let e=this;wx.loadSubpackage({name:"hamsters2",success:function(i){e.isSubPackageLoadCompleteNpc=!0,e.eventManager.fire(t.subPackageLoadCompleteNpc),console.log("hamsters2 完成")},fail:function(e){}})}onCompleteScene(e){this.log("onCompleteScene"),this.setSceneUI(e)}log(e){console.log(e)}setScene3D(e){this.scene3D=e;let t=e.getChildByName("CameraParent");this.camera=t.getChildByName("Main Camera")}setSceneUI(e){this.sceneUI=e}}class Ve{constructor(){this.curProgressCount=0,this.totalCount=1}init(e){this.config=e,this.curProgressCount=0,Oe.instance.timeManager.loop(.1,this,this.update),this.config.achievementType==h.collectHeart&&Oe.instance.eventManager.on(t.mission_colloctHeart,this,this.colloctHeart)}update(){this.check()}check(){switch(this.totalCount=this.config.param2,this.config.achievementType){case h.buyHamster:let e=Oe.instance.userData.getAllHamsterCount();this.curProgressCount=e;break;case h.collectHeart:this.curProgressCount=Oe.instance.userData.achievementColloctHeartTimes;break;case h.completeMission:this.curProgressCount=Oe.instance.userData.mMissionId-1;break;case h.gameTime:let t=Oe.instance.userData.onlineTime;t=Math.floor(t),this.curProgressCount=t;break;case h.unlockIsland:let i=this.config.param1,a=Oe.instance.userData.getIslandInfoById(i);this.totalCount=1,a.islandLevel>0?this.curProgressCount=1:this.curProgressCount=0;break;case h.upgradeIsland:let n=this.config.param1,s=Oe.instance.userData.getIslandInfoById(n);this.curProgressCount=s.islandLevel,this.totalCount=this.config.param2;break;case h.lookAd:this.curProgressCount=Oe.instance.userData.mLookAdTimes,this.totalCount=this.config.param2}}colloctHeart(){let e=Oe.instance.userData.achievementColloctHeartTimes;Oe.instance.userData.setAchievementCollectHeartTimes(e+1),this.curProgressCount=Oe.instance.userData.achievementColloctHeartTimes}getTotalCount(){return this.totalCount}getAchievementProgress(){return this.curProgressCount}resetAchievement(e){this.config=e,this.curProgressCount=0,this.config.achievementType==h.collectHeart&&Oe.instance.userData.setAchievementCollectHeartTimes(0),this.check()}}class Ue{constructor(){Ue._instance=this}static get instance(){return Ue._instance}init(){this.curRemainDoubleTime=Oe.instance.userData.doubleTime,this.curRemainDoubleTime<0&&(this.curRemainDoubleTime=0),Oe.instance.timeManager.loop(1,this,this.update)}update(){this.curRemainDoubleTime<=0||(this.curRemainDoubleTime-=1,this.curRemainDoubleTime<=0&&(this.curRemainDoubleTime=0),Oe.instance.userData.setDoubleTime(this.curRemainDoubleTime))}isDoubleProduce(){return this.curRemainDoubleTime>0}addDoubleTime(e){this.curRemainDoubleTime+=e,Oe.instance.userData.startDouble(e)}getRemainDoubleTime(){return this.curRemainDoubleTime}}class Ee{constructor(){this.allAchievements=[],Ee._instance=this}static get instance(){return Ee._instance}init(){this.createAchievement()}createAchievement(){let e=Oe.instance.userData.mAchievementListInfos;for(let t=0;t<e.length;t++){const i=e[t];let a=Oe.instance.userData.getAchievementConfigByType(i.achievementType);if(null==a)continue;let n=new Ve;n.init(a),this.allAchievements.push(n)}}getAchievement(e){let t=0;switch(e.config.rewardType){case r.heart:t=12*Oe.instance.userData.getHeartProduce()*e.config.rewardParam,Oe.instance.userData.addHeart(t),w.playRewardEffect(r.heart);break;case r.gold:t=60*Oe.instance.userData.getGoldTotalProduce()*e.config.rewardParam,Oe.instance.userData.addGold(t),w.playRewardEffect(r.gold);break;case r.diamond:t=e.config.rewardParam,Oe.instance.userData.addDiamond(t),w.playRewardEffect(r.diamond);break;case r.doubleTicket:Ue.instance.addDoubleTime(60*e.config.rewardParam),w.playRewardEffect(r.doubleTicket)}Oe.instance.userData.completeAchievementInfoByType(e.config.achievementType);let i=Oe.instance.userData.getAchievementConfigByType(e.config.achievementType);null==i?this.removeAchievement(e):e.resetAchievement(i),w.aldEventByTypeParam(c.data_getAchievemnet,e.config.id.toString(),e.config.id.toString())}removeAchievement(e){this.allAchievements=w.removeArr(this.allAchievements,e)}}class Re extends e.AchievementViewUI{constructor(){super(),this.adOffsetX=0,this.boxW=284}onEnable(){this.init(),Oe.instance.eventManager.fire(t.ui_openAchievementView),Oe.instance.eventManager.on(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}onDisable(){Oe.instance.eventManager.fire(t.ui_closeAchievementView),Oe.instance.eventManager.off(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}init(){this.initObj(),this.showAdItem(),this.showList2()}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.adItemBox.on(Laya.Event.CLICK,this,this.onAdItemClick),this.adItemBtn.on(Laya.Event.CLICK,this,this.onAdItemClick)}showList(){this.achievementList.hScrollBarSkin="",this.achievementList.renderHandler=new Laya.Handler(this,this.renderHandler);let e=[],t=Oe.instance.userData.mAchievementListInfos;for(let i=0;i<t.length;i++){const a=t[i];let n=Oe.instance.userData.getAchievementConfigByType(a.achievementType);null!=n?e.push({info:a,config:n}):console.error("没有获取到此类型的配置 achievementType== "+a.achievementType+"//index = "+a.index)}this.achievementList.array=e}renderHandler(e,t){let i=this.achievementList.getItem(t),a=e.getChildByName("title"),n=e.getChildByName("ahievementDesc"),s=e.getChildByName("rewardDesc"),o=e.getChildByName("rewardIcon"),r=e.getChildByName("icon"),h=e.getChildByName("getBtn"),l=i.config;a.text=l.title;let d=l.desc;-1!=l.param2&&(d=w.stringFormat(l.desc,[l.param2])),n.text=d;let c=Oe.instance.userData.getRewardInfoByType(l.rewardType,l.rewardParam);s.text=c.rewardDesc,o.skin=c.iconSkin,r.skin="UI/"+l.icon+".png",h.on(Laya.Event.CLICK,this,this.onGetBtnClick,[l])}showList2(){this.panel.hScrollBarSkin="",this.achievementList.renderHandler=new Laya.Handler(this,this.renderHandler2);let e=[],t=Ee.instance.allAchievements;for(let i=0;i<t.length;i++){const a=t[i];e.push({info:a})}this.achievementList.array=e;let i=e.length*this.boxW;this.achievementList.width=i,this.achievementList.x=0+this.adOffsetX}renderHandler2(e,t){let i=this.achievementList.getItem(t),a=e.getChildByName("title"),n=e.getChildByName("ahievementDesc"),s=e.getChildByName("rewardDesc"),o=e.getChildByName("rewardIcon"),r=e.getChildByName("icon"),h=e.getChildByName("achievementProgress"),l=e.getChildByName("progressLabel"),d=e.getChildByName("getBtn"),c=i.info.config;a.text=c.title;let g=c.desc;-1!=c.param2&&(g=w.stringFormat(c.desc,[c.param2])),n.text=g;let m=Oe.instance.userData.getRewardInfoByType(c.rewardType,c.rewardParam);s.text=m.rewardDesc,o.skin=m.iconSkin,r.skin="UI/"+c.icon+".png";let u=i.info.getTotalCount(),v=i.info.getAchievementProgress();v>=u?(d.visible=!0,h.visible=!1,l.visible=!1,d.on(Laya.Event.CLICK,this,this.onGetBtnClick,[i.info])):(d.visible=!1,h.visible=!0,l.visible=!0,h.value=v/u,l.text=v+"/"+u)}onGetBtnClick(e,t){Ee.instance.getAchievement(e),this.showList2(),console.log("领取成就")}onCloseBtnClick(){this.close()}showAdItem(){if(!Laya.Browser.onQGMiniGame&&!Laya.Browser.onVVMiniGame)return;let e=this,t=Oe.instance.ad.getNativeAdRes();if(this.adRes=t,t&&(t.icon||t.imgUrlList.length>0)){let i="";i=t.icon?t.icon:t.imgUrlList[0];let a="";a=t.imgUrlList.length>0?t.imgUrlList[0]:t.icon,this.adItemIcon.skin=i,this.adItemImage.skin=a,this.adItemName.text=t.title,e.adItemBox.visible=!0,Oe.instance.ad.reportAdShow(t.adId),this.adOffsetX=this.boxW}else this.adOffsetX=0,e.adItemBox.visible=!1,Oe.instance.ad.refreshNativeAd(function(e){})}onAdItemClick(){let e="1";this.adRes&&(e=this.adRes.adId),Oe.instance.ad.reportAdClick(e)}vivoAdReportClick(){this.showAdItem()}}class Fe extends Laya.Button{constructor(){super(),this.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(){Laya.Tween.to(this,{scaleX:1.1,scaleY:1.1},100,null,Laya.Handler.create(this,function(){Laya.Tween.to(this,{scaleX:1,scaleY:1},100)})),Oe.instance.soundManager.playSound("sound/btnClick.mp3")}}class Xe extends e.ClothHamsterViewUI{constructor(){super(),this.adOffsetX=0,this.isClickShareBtn=!1}onEnable(){this.init(),Oe.instance.eventManager.fire(t.ui_openClothHamsterView),Oe.instance.eventManager.on(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}onDisable(){Oe.instance.eventManager.fire(t.ui_closeClothHamsterView),Oe.instance.eventManager.off(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}init(){this.initObj(),this.showAdItem(),this.showInfo(),this.showList()}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.goEggBtn.on(Laya.Event.CLICK,this,this.onGoEggBtnClick),this.adItemBtn.on(Laya.Event.CLICK,this,this.onAdItemClick),this.adItemBox.on(Laya.Event.CLICK,this,this.onAdItemClick)}showInfo(){this.hamsterCountLabel.text=""+Oe.instance.userData.mHamsterCloths.length;let e=Oe.instance.userData.getAddGoldFactor(),t=Oe.instance.userData.getAddHeartFactor();e=Math.round(100*e),t=Math.round(100*t),this.heartAddLabel.text="+"+t+"%",this.goldAddLabel.text="+"+e+"%"}showList(){this.panel.hScrollBarSkin="",this.hamsterList.renderHandler=new Laya.Handler(this,this.renderHandler);let e=Oe.instance.userData.getClothHamsterConfigs(),t=[];for(let i=0;i<e.length;i++){const a=e[i];let n={cfg:a,icon:{skin:"UI/"+a.icon+".png"},hamsterName:{text:a.hamsterName}};t.push(n)}this.hamsterList.array=t;let i=286*t.length;this.hamsterList.width=i,this.hamsterList.x=390+this.adOffsetX}renderHandler(e,t){let i=this.hamsterList.getItem(t),a=(e.getChildByName("lockBox"),e.getChildByName("unlockBox")),n=a.getChildByName("adBtn"),s=a.getChildByName("diamondBtn"),o=a.getChildByName("shareBtn"),r=a.getChildByName("eggBtn"),h=a.getChildByName("countLabel"),d=a.getChildByName("heartLabel"),c=a.getChildByName("goldLabel"),g=i.cfg;n.visible=!1,s.visible=!1,o.visible=!1,r.visible=!1;let m=Oe.instance.userData.getClothAdTimesById(g.id);switch(g.unlockType){case l.ad:n.visible=!0,n.label=m+"/"+g.param,n.on(Laya.Event.CLICK,this,this.onAdBtnClick,[g]);break;case l.diamond:s.visible=!0,s.label=g.param,s.on(Laya.Event.CLICK,this,this.onDiamondBtnClick,[g]);break;case l.share:o.visible=!0,o.label=m+"/"+g.param,o.on(Laya.Event.CLICK,this,this.onShareBtnClick,[g]);break;case l.egg:r.visible=!0,r.label="孵化蛋",r.on(Laya.Event.CLICK,this,this.onEggBtnClick,[g])}let u=Oe.instance.userData.getClothCountById(g.id);h.text=u.toString();let v=g.heartFactor-1;v=Math.round(100*v),d.text="+"+v+"%";let p=g.goldFactor-1;p=Math.round(100*p),c.text="+"+p+"%"}adSuccess(e){let i=Oe.instance.userData.addClothAdTimesById(e.id);if(i>=e.param)return Oe.instance.userData.resetClothAdTimesById(e.id),Oe.instance.userData.buyHamsterCloth(e.id),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,e.id),w.showNoticeLabel("购买成功"),void this.onCloseBtnClick();{let t="再看"+(e.param-i)+"次，获得";w.showNoticeLabel(t)}this.hamsterList.refresh()}onAdBtnClick(e){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let t=this;Oe.instance.ad.showAd(function(i){t.isClickShareBtn=!1,i?(t.adSuccess(e),w.statisticsDataByParam(c.ad_getHamster,e.id,!0)):w.statisticsDataByParam(c.ad_getHamster,e.id,!1)})}onDiamondBtnClick(e){if(e.param>Oe.instance.userData.mDiamond)return Oe.instance.eventManager.fire(t.diamondNotEnough),void w.showNoticeLabel("钻石不足");Oe.instance.userData.subDiamond(e.param),Oe.instance.userData.buyHamsterCloth(e.id),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,e.id),w.showNoticeLabel("购买成功"),this.onCloseBtnClick(),w.aldEventByTypeParam(c.data_diamondHamsterCloth,e.id.toString(),e.id.toString())}onShareBtnClick(e){}onEggBtnClick(e){}onGoEggBtnClick(){Oe.instance.scenesManager.openScene(y.EggView,Laya.Handler.create(this,function(e){}),!1),this.onCloseBtnClick()}onCloseBtnClick(){this.close()}showAdItem(){if(!Laya.Browser.onQGMiniGame&&!Laya.Browser.onVVMiniGame)return;let e=this,t=Oe.instance.ad.getNativeAdRes();if(this.adRes=t,t&&(t.icon||t.imgUrlList.length>0)){let i="";i=t.icon?t.icon:t.imgUrlList[0],this.adItemIcon.skin=i,this.adItemDesc.text=t.desc,this.adItemName.text=t.title,e.adItemBox.visible=!0,Oe.instance.ad.reportAdShow(this.adRes.adId),this.adOffsetX=286}else this.adOffsetX=0,e.adItemBox.visible=!1,Oe.instance.ad.refreshNativeAd(function(e){})}onAdItemClick(){let e="1";this.adRes&&(e=this.adRes.adId),Oe.instance.ad.reportAdClick(e)}vivoAdReportClick(){this.showAdItem()}}class We{constructor(e){this.stateType=a.idle,this.owner=e}onEnter(e){}update(e){}OnExit(e){}}class qe extends We{constructor(e){super(e),this.stateType=a.idle}onEnter(e){}update(e){}OnExit(e){}}class Qe extends We{constructor(e){super(e),this.targetZ=-100,this.targetX=0,this.tempPos=new Laya.Vector3,this.isScaleCamera=!0,this.fieldOfView=0,this.stateType=a.unlock}onEnter(e){if(null==e||0==e.length)return void this.owner.changeState(a.idle);let t=e[0],i=Oe.instance.userData.getIslandConfigById(t),n=new Laya.Vector3(i.areaCenterX,i.areaCenterY,i.areaCenterZ);this.tempPos.x=n.x,this.tempPos.y=n.y,this.tempPos.z=n.z,this.targetZ=n.z-70,this.targetX=n.x,this.isScaleCamera=!0,this.fieldOfView=20.8}update(e){this.moveCamera(),this.scaleCamera()}OnExit(e){}scaleCamera(){if(!this.isScaleCamera)return;let e=ft.instance.mainCamera.fieldOfView;e=Laya.MathUtil.lerp(e,this.fieldOfView,3*Laya.timer.delta/1e3),ft.instance.setFieldOfView(e),Math.abs(e-this.fieldOfView)<=.1&&(this.isScaleCamera=!1)}moveCamera(){let e=ft.instance.mainCamera.transform.localPosition,t=e.z,i=e.x;t=Laya.MathUtil.lerp(t,this.targetZ,6*Laya.timer.delta/1e3),i=Laya.MathUtil.lerp(i,this.targetX,6*Laya.timer.delta/1e3),this.tempPos.x=i,this.tempPos.y=e.y,this.tempPos.z=t,ft.instance.setCameraPos(this.tempPos),this.checkExit()}checkExit(){Math.abs(this.tempPos.z-this.targetZ)<=1&&0==this.isScaleCamera&&this.owner.changeState(a.idle)}}class ze extends We{constructor(e){super(e),this.tempPos=new Laya.Vector3,this.targetZ=-100,this.targetX=0,this.fieldOfView=0,this.isScaleCamera=!0,this.stateType=a.born}onEnter(e){if(null==e||0==e.length)return void this.owner.changeState(a.idle);console.log("仓鼠出生");let i=e[0];this.tempPos.x=i.transform.position.x,this.tempPos.y=i.transform.position.y,this.tempPos.z=i.transform.position.z,this.targetZ=i.transform.position.z-70,this.targetX=i.transform.position.x,this.fieldOfView=9.2,this.isScaleCamera=!0,Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete)}update(e){this.moveCamera(),this.scaleCamera()}OnExit(e){Oe.instance.eventManager.off(t.ui_buyHamsterComplete,this,this.buyHamsterComplete)}buyHamsterComplete(e){this.owner.changeState(a.look,[e])}moveCamera(){let e=ft.instance.mainCamera.transform.localPosition,t=e.z,i=e.x;t=Laya.MathUtil.lerp(t,this.targetZ,6*Laya.timer.delta/1e3),i=Laya.MathUtil.lerp(i,this.targetX,6*Laya.timer.delta/1e3),this.tempPos.x=i,this.tempPos.y=e.y,this.tempPos.z=t,ft.instance.setCameraPos(this.tempPos)}scaleCamera(){if(!this.isScaleCamera)return;let e=ft.instance.mainCamera.fieldOfView;e=Laya.MathUtil.lerp(e,this.fieldOfView,3*Laya.timer.delta/1e3),ft.instance.setFieldOfView(e)}}class Je extends Qe{constructor(e){super(e),this.targetPos=new Laya.Vector3,this.stateType=a.unlockNpc}onEnter(e){if(null!=e&&0!=e.length){if(this.hamsterNpc=e[0],null==this.hamsterNpc.owner){let e=this.hamsterNpc.getStartPos();this.targetPos.x=e.transform.position.x,this.targetPos.y=e.transform.position.y,this.targetPos.z=e.transform.position.z}this.fieldOfView=9.2,this.setTargetPos(),this.isScaleCamera=!0}else this.owner.changeState(a.idle)}OnExit(e){}update(e){this.setTargetPos(),this.moveCamera(),this.scaleCamera()}setTargetPos(){null!=this.hamsterNpc.owner&&(this.targetPos.x=this.hamsterNpc.owner.transform.position.x,this.targetPos.y=this.hamsterNpc.owner.transform.position.y,this.targetPos.z=this.hamsterNpc.owner.transform.position.z);let e=this.targetPos;this.tempPos.x=e.x,this.tempPos.y=e.y,this.tempPos.z=e.z,this.targetZ=e.z-70,this.targetX=e.x}checkExit(){}}class je extends Qe{constructor(e){super(e),this.targetPos=new Laya.Vector3,this.stateType=a.look}onEnter(e){null!=e&&0!=e.length?(this.hamster=e[0],null!=this.hamster&&null!=this.hamster.transform?(this.fieldOfView=9.2,this.setTargetPos(),this.isScaleCamera=!0):this.owner.changeState(a.idle)):this.owner.changeState(a.idle)}update(e){this.setTargetPos(),this.moveCamera(),this.scaleCamera()}OnExit(e){}setTargetPos(){if(null==this.hamster)return void this.owner.changeState(a.idle);this.targetPos.x=this.hamster.transform.position.x,this.targetPos.y=this.hamster.transform.position.y,this.targetPos.z=this.hamster.transform.position.z;let e=this.targetPos;this.tempPos.x=e.x,this.tempPos.y=e.y,this.tempPos.z=e.z,this.targetZ=e.z-70,this.targetX=e.x}checkExit(){}}class Ye extends We{constructor(e){super(e),this.isScaleCamera=!0,this.isMoveCamera=!0,this.fieldOfView=0,this.targetZ=0,this.targetX=0,this.tempPos=new Laya.Vector3,this.stateType=a.zoom}onEnter(e){this.isScaleCamera=!0,this.isMoveCamera=!0,this.fieldOfView=25.8,this.targetZ=-78,this.targetX=-6}update(e){this.scaleCamera(),this.moveCamera()}OnExit(e){}scaleCamera(){if(!this.isScaleCamera)return;let e=ft.instance.mainCamera.fieldOfView;e=Laya.MathUtil.lerp(e,this.fieldOfView,1*Laya.timer.delta/1e3),ft.instance.setFieldOfView(e),Math.abs(e-this.fieldOfView)<=.1&&(this.isScaleCamera=!1)}moveCamera(){if(!this.isMoveCamera)return;let e=ft.instance.mainCamera.transform.localPosition,t=e.z,i=e.x;t=Laya.MathUtil.lerp(t,this.targetZ,1*Laya.timer.delta/1e3),i=Laya.MathUtil.lerp(i,this.targetX,1*Laya.timer.delta/1e3),this.tempPos.x=i,this.tempPos.y=e.y,this.tempPos.z=t,ft.instance.setCameraPos(this.tempPos),Math.abs(this.tempPos.z-this.targetZ)<=1&&Math.abs(this.tempPos.x-this.targetX)<=1&&(this.isMoveCamera=!1)}}class Ze{constructor(){this.stateList=[]}init(){this.registorState(),this.changeState(a.idle)}update(){this.curState&&this.curState.update()}registorState(){let e=new qe(this);this.stateList[a.idle.toString()]=e;let t=new Qe(this);this.stateList[a.unlock.toString()]=t;let i=new ze(this);this.stateList[a.born.toString()]=i;let n=new Je(this);this.stateList[a.unlockNpc.toString()]=n;let s=new je(this);this.stateList[a.look.toString()]=s;let o=new Ye(this);this.stateList[a.zoom.toString()]=o}changeState(e,t){this.preState=this.curState,this.curStateIndex=e,this.preState&&this.preState.OnExit(),this.curState=this.stateList[e.toString()],this.curState.onEnter(t)}getCurStateIndex(){return this.curStateIndex}}class $e{constructor(){this.tempDir=new Laya.Vector3,this.tempCross=new Laya.Vector3,this.tempForward=new Laya.Vector3,this.tempStartPos=new Laya.Vector3,this.tempTargetPos=new Laya.Vector3}init(e){this.id=e}playAnim(e,t){this.animCtr.play(e,0,t)}rotateBody(e,t,i){Laya.Vector3.subtract(t,e,this.tempDir),this.tempDir.y=0,Laya.Vector3.normalize(this.tempDir,this.tempDir),this.rotateBodyByDir(this.tempDir,i)}rotateBodyByDir(e,t){this.owner.transform.getForward(this.tempForward);let i=Laya.Vector3.dot(this.tempForward,e);i=Number(i.toFixed(2));let a=180*Math.acos(i)/Math.PI;Laya.Vector3.cross(this.tempForward,e,this.tempCross),this.tempStartPos=this.owner.transform.rotationEuler,this.tempTargetPos.x=0,this.tempTargetPos.z=0,this.tempCross.y<0?this.tempTargetPos.y=this.tempStartPos.y-a:this.tempTargetPos.y=this.tempStartPos.y+a;let n=this;w.tweenMove(this.tempStartPos,this.tempTargetPos,function(e){n.owner.transform.rotationEuler=e},function(){},t)}}class et extends $e{constructor(){super(...arguments),this.curHamsterPointInfo=null,this.curIndex=-1,this.targetHamsterPointInfo=null,this.targetIndex=0,this.moveSpeed=3,this.isGotoTreasure=!1,this.tempHudPos=new Laya.Vector3,this.curTween=null,this.slideIndex=0,this.outIndex=-1,this.enterIndex=-1}init(e){super.init(e),this.isGotoTreasure=!1,this.loadRes(),Oe.instance.eventManager.on(t.subPackageLoadCompleteHamster,this,this.subPackageLoadComplete)}getHudPos(){return this.tempHudPos.x=this.owner.transform.position.x,this.tempHudPos.y=this.owner.transform.position.y+1.8,this.tempHudPos.z=this.owner.transform.position.z,this.tempHudPos}loadRes(){this.owner=wt.instance.copyNormalHamster(),Oe.instance.scene3D.addChild(this.owner),this.owner.active=!0,this.setNormalHamsterTex(),this.setRandomBornPos()}setRandomBornPos(){let e=wt.instance.getRandomNormalPoint();this.targetIndex=e.randomPoint(),this.targetHamsterPointInfo=e;let t=this.targetHamsterPointInfo.pointObjs[this.targetIndex].transform.position;this.owner.transform.position=t,this.animCtr=this.owner.getComponent(Laya.Animator);let i=w.random(0,8);this.completeTarget(i)}bornHamster(e){this.id=e,this.owner=wt.instance.copyNormalHamster(),Oe.instance.scene3D.addChild(this.owner),this.owner.active=!0;let t=wt.instance.getNormalBornPos(),i=t.transform.position,a=t.transform.rotationEuler;this.owner.transform.position=i,this.owner.transform.rotationEuler=a,this.animCtr=this.owner.getComponent(Laya.Animator),this.playAnim("idle"),this.setNormalHamsterTex(),1==e?this.goToGuideBowPos():this.randomMove()}subPackageLoadComplete(){this.setNormalHamsterTex()}setNormalHamsterTex(){let e=Oe.instance.userData.getNormalConfgById(this.id),t=this.owner.getChildByName("root").getChildByName("hamster"),i="normalTex/";if(!Oe.instance.isSubPackageLoadCompleteHamster)return;this.id>2&&(i="normalTex2/");let a=i+e.tex+".png";Oe.instance.loadManager.loadTexture(a,Laya.Handler.create(this,function(e){t.skinnedMeshRenderer.material.albedoTexture=e,Laya.Resource.destroyUnusedResources()}))}goToGuideBowPos(){this.playAnim("walk");let e=wt.instance.getGuideBowPos().transform.position,i=this.owner.transform.position,a=1e3*Laya.Vector3.distance(i,e)/this.moveSpeed,n=this;this.rotateBody(i,e,500),this.curTween=w.tweenMove(i,e,function(e){n.owner.transform.position=e},function(){n.curTween=null,n.owner.transform.rotationEuler=w.vectorZero,n.playAnim("guideBow"),Oe.instance.timeManager.onceExecute(4,n,function(){n.randomMove(),Oe.instance.eventManager.fire(t.newGuide_guideBowComplete)})},a)}randomMove(){let e=wt.instance.getRandomNormalPoint();this.targetIndex=e.randomPoint(),this.targetHamsterPointInfo=e,this.isGotoTreasure=!1;let t=this;this.gotoIsland(function(){t.completeTarget()})}doMove(){let e=this.owner.transform.position,t=this.targetHamsterPointInfo.pointObjs[this.targetIndex].transform.position,i=1e3*Laya.Vector3.distance(e,t)/2,a=this;this.playAnim("walk"),this.rotateBody(e,t,500),w.tweenMove(e,t,function(e){a.owner.transform.position=e},function(){a.completeTarget()},i)}digTreasureStart(){this.playAnim("dig"),Oe.instance.timeManager.onceExecute(2,this,this.showTreasure),Oe.instance.soundManager.playSound("sound/treasureDig.mp3",3)}showTreasure(){this.playAnim("digShow"),Oe.instance.timeManager.onceExecute(2,this,this.digTreasureComplete)}digTreasureComplete(){this.playAnim("idle"),this.randomMove(),Oe.instance.eventManager.fire(t.treasure_digComplete,this.getHudPos())}goToTreasure(e){console.log("前往 宝藏点"),this.targetIndex=0,this.targetHamsterPointInfo=e,this.isGotoTreasure=!0;let i=this;null!=this.curTween&&this.curTween.clear(),Oe.instance.timeManager.clear(this,this.randomMove),this.gotoIsland(function(){i.curHamsterPointInfo=i.targetHamsterPointInfo,i.curIndex=i.targetIndex,i.digTreasureStart(),Oe.instance.eventManager.fire(t.treasure_arriveTarget,i.owner)})}completeTarget(e=8){this.curHamsterPointInfo=this.targetHamsterPointInfo,this.curIndex=this.targetIndex,this.playAnim("idle"),Oe.instance.timeManager.onceExecute(e,this,this.randomMove)}gotoIsland(e){let t=this;if(null==this.curHamsterPointInfo)this.setMoveSpeed(),t.enterIsland(function(){t.gotoTargetPoint(function(){e&&e()})});else if(this.curHamsterPointInfo.islandId==this.targetHamsterPointInfo.islandId){if(this.targetIndex==this.curIndex&&0==this.isGotoTreasure)return void Oe.instance.timeManager.onceExecute(2,this,this.randomMove);this.setMoveSpeed(),t.gotoTargetPoint(function(){e&&e()})}else{if(this.setMoveSpeed(),4==this.curHamsterPointInfo.islandId){if(w.random(1,100)>=40)return void this.gotoSlidePoint(function(){t.setMoveSpeed(),t.enterIsland(function(){t.gotoTargetPoint(function(){e&&e()})})})}this.gotoOutPoint(function(){t.outIsland(function(){t.curHamsterPointInfo=null,t.enterIsland(function(){t.gotoTargetPoint(function(){e&&e()})})})})}}setMoveSpeed(){if(w.random(1,100)>=70||this.isGotoTreasure)return this.playAnim("run"),this.moveSpeed=4,!0;this.playAnim("walk"),this.moveSpeed=3}gotoSlidePoint(e){if(4!==this.curHamsterPointInfo.islandId)return void e();let t=this.curHamsterPointInfo.getSlidingPaths();this.slideIndex=0,this.doSlide(t,e)}doSlide(e,t){1==this.slideIndex&&(this.playAnim("sliding"),this.moveSpeed=5);let i=e[this.slideIndex],a=this.owner.transform.position,n=1e3*Laya.Vector3.distance(a,i)/this.moveSpeed,s=this;this.rotateBody(a,i,500),this.curTween=w.tweenMove(a,i,function(e){s.owner.transform.position=e},function(){s.slideIndex++,s.slideIndex>=e.length?(s.curTween=null,t()):s.doSlide(e,t)},n)}gotoOutPoint(e){if(null==this.curHamsterPointInfo)return void e();let t=this.curHamsterPointInfo.getOutPaths();if(t.length<=0)return void e();let i=t[0],a=this.owner.transform.position,n=1e3*Laya.Vector3.distance(a,i)/this.moveSpeed,s=this;this.rotateBody(a,i,500),this.curTween=w.tweenMove(a,i,function(e){s.owner.transform.position=e},function(){s.curTween=null,e()},n)}outIsland(e){if(null==this.curHamsterPointInfo)return void e();let t=this.curHamsterPointInfo.getOutPaths();t.length<=0?e():(this.outIndex=0,this.dodoMove(t,e,!0))}enterIsland(e){let t=this.targetHamsterPointInfo.getEnterPaths();t.length<=0?e():(this.enterIndex=0,this.dodoMove(t,e,!1))}gotoTargetPoint(e){let t=this.targetHamsterPointInfo.pointObjs[this.targetIndex].transform.position,i=this.owner.transform.position,a=1e3*Laya.Vector3.distance(i,t)/this.moveSpeed,n=this;this.rotateBody(i,t,500),this.curTween=w.tweenMove(i,t,function(i){if(n.owner.transform.position=i,n.isGotoTreasure&&n.curTween){Laya.Vector3.distance(t,i)<=1.5&&n.curTween&&(n.curTween.clear(),n.curTween=null,e())}},function(){n.curTween=null,e()},a)}dodoMove(e,t,i){let a=0;a=i?this.outIndex:this.enterIndex;let n=this.owner.transform.position,s=e[a],o=1e3*Laya.Vector3.distance(n,s)/this.moveSpeed,r=this;this.rotateBody(n,s,500),this.curTween=w.tweenMove(n,s,function(e){r.owner.transform.position=e},function(){i?(r.outIndex++,r.outIndex>=e.length?(r.curTween=null,t()):r.dodoMove(e,t,i)):(r.enterIndex++,1==r.enterIndex&&(r.curHamsterPointInfo=r.targetHamsterPointInfo),r.enterIndex>=e.length?(r.curTween=null,t()):r.dodoMove(e,t,i))},o)}}class it{constructor(){this.pointObjs=[],this.enterPointObjs=[],this.slidingPointObjs=[]}init(e){this.islandId=e,this.setPointObjs()}setPointObjs(){this.pointObjs=[];let e=Oe.instance.userData.getIslandConfigById(this.islandId).managerPath+"NormalPoint",t=wt.instance.normalPointParent.getChildByName(e);this.normalPointObj=t;let i=t.getChildByName("normalPoint"),a=i.numChildren;for(let e=0;e<a;e++){const t=i.getChildAt(e);this.pointObjs.push(t)}let n=t.getChildByName("enterPoint");if(this.enterPointObjs=[],n){let e=n.numChildren;for(let t=0;t<e;t++){const e=n.getChildAt(t);this.enterPointObjs.push(e)}}let s=t.getChildByName("slidingPoint");if(this.slidingPointObjs=[],s){let e=s.numChildren;for(let t=0;t<e;t++){const e=s.getChildAt(t);this.slidingPointObjs.push(e)}}}randomPoint(){return w.random(0,this.pointObjs.length-1)}getEnterPaths(){let e=[];for(let t=0;t<this.enterPointObjs.length;t++){const i=this.enterPointObjs[t];e.push(i.transform.position)}return e}getOutPaths(){let e=[];for(let t=this.enterPointObjs.length-1;t>=0;t--){const i=this.enterPointObjs[t];e.push(i.transform.position)}return e}getSlidingPaths(){let e=[];for(let t=0;t<this.slidingPointObjs.length;t++){const i=this.slidingPointObjs[t];e.push(i.transform.position)}return e}}class at{constructor(){this.tempPos=new Laya.Vector4}init(e){this.owner=e,this.createParent(),this.createProgress(),this.createGoldImage(),this.createLabel(),this.createGoldHudImage(),Oe.instance.timeManager.framLoop(this,this.updatePos)}createParent(){this.parent=new Laya.Box,this.parent.width=1,this.parent.height=1,this.parent.scaleX=.8,this.parent.scaleY=.8,this.parent.anchorX=0,this.parent.anchorY=0,mt.instance.hudGoldParent.addChild(this.parent),this.parent.visible=!0}createProgress(){this.progress=new Laya.ProgressBar("UI/goldProgress.png"),this.progress.anchorX=.5,this.progress.anchorY=.5,this.progress.scaleX=1.5,this.progress.scaleY=1.6,this.progress.width=84,this.progress.height=21,this.progress.pos(0,0),this.parent.addChild(this.progress),this.progress.visible=!0}createLabel(){this.goldLabel=new Laya.Label,this.goldLabel.font="Microsoft YaHei",this.goldLabel.fontSize=20,this.goldLabel.bold=!0,this.goldLabel.color="#ffffff",this.goldLabel.anchorX=.5,this.goldLabel.anchorY=.5,this.goldLabel.x=0,this.goldLabel.y=0,this.goldLabel.pos(0,0),this.parent.addChild(this.goldLabel),this.goldLabel.visible=!0}createGoldImage(){let e=new Laya.Image("UI/gold1.png");e.width=33,e.height=33,e.x=-59,e.y=0,e.anchorX=.5,e.anchorY=.5,this.parent.addChild(e),e.visible=!0}createGoldHudImage(){let e=new Laya.Image("UI/hudGold.png");e.x=-59,e.y=0,e.anchorX=.5,e.anchorY=.5,mt.instance.hudHeartParent.addChild(e),e.visible=!0,this.hudImage=e,this.hudImage.on(Laya.Event.CLICK,this,this.onHudClick),this.hideHud()}updatePos(){let e=this.owner.getIslandHudPos();ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.parent.pos(this.tempPos.x,this.tempPos.y),this.hudImage.pos(this.tempPos.x,this.tempPos.y)}updateProgress(e){this.progress.value=e}showGoldNum(e){if(this.goldLabel){Ue.instance.isDoubleProduce()&&(e*=2),this.goldLabel.text=w.convert(e)}}showHud(){this.parent.visible=!1,this.hudImage.visible=!0}hideHud(){this.parent.visible=!0,this.hudImage.visible=!1}onHudClick(){this.owner.onHudClick(),this.hideHud(),Oe.instance.soundManager.playSound("sound/goldCollect.mp3")}showCollectGoldEffect(e){let t=w.convert(e),i=this.createEffectLabel(t);this.createRewardImage("UI/gold1.png",i)}createEffectLabel(e){let t=new Laya.Label;t.font="Microsoft YaHei",t.fontSize=25,t.bold=!0,t.color="#ffffff",t.anchorX=.5,t.anchorY=.5,t.x=this.hudImage.x,t.y=this.hudImage.y-20,t.stroke=2,t.strokeColor="#000000",mt.instance.hudHeartParent.addChild(t),t.visible=!0,t.text=e;let i=this.hudImage.y-70;return Laya.Tween.to(t,{y:i},800,null,Laya.Handler.create(this,function(){t.removeSelf(),t.destroy()})),t}createRewardImage(e,t){let i=new Laya.Image(e);return i.x=-59,i.y=0,i.anchorX=.5,i.anchorY=.5,t.addChild(i),i.visible=!0,i.pos(-t.width/2-10,10),i.scaleX=.5,i.scaleY=.5,i}}class nt extends $e{constructor(){super(...arguments),this.points=[],this.curPosIndex=-1,this.posIndexs=[],this.vectorBackZ=new Laya.Vector3(0,0,-1),this.isShowEffect=!1}init(e){super.init(e),this.curPosIndex=-1,this.config=Oe.instance.userData.getIslandConfigById(this.id),this.initPoints(),this.isShowEffect&&(Oe.instance.soundManager.playSound("sound/createNpc.mp3"),this.showUnlockEffect()),this.loadRes(),Oe.instance.eventManager.on(t.subPackageLoadCompleteNpc,this,this.subPackageLoadCompleteNpc)}subPackageLoadCompleteNpc(){this.config.id>2&&this.loadRes()}loadRes(){if(this.owner)return;if(0==Oe.instance.isSubPackageLoadCompleteNpc&&this.config.id>2)return;let e=y.npcHamsterRootPath+this.config.managerRes+".lh";Oe.instance.loadManager.loadPrefab3D(e,this.loadComplete,this)}loadComplete(e){this.owner=e,Oe.instance.scene3D.addChild(this.owner);let t=this.getStartPos();if(this.owner.transform.position=t.transform.position,this.curPosIndex=0,this.animCtr=this.owner.getComponent(Laya.Animator),this.isShowEffect){let e=this;e.owner.active=!1,Oe.instance.timeManager.onceExecute(1,this,function(){e.owner.active=!0,e.animCtr.play("hello"),Oe.instance.timeManager.onceExecute(2.2,this,function(){e.randomMovePos()})})}else this.owner.active=!0,this.randomMovePos()}showUnlockEffect(){let e=y.npcHamsterRootPath+"NpcUnlockEffect.lh";Oe.instance.loadManager.loadPrefab3D(e,this.effectLoadComplete,this)}effectLoadComplete(e){Oe.instance.scene3D.addChild(e);let t=this.getStartPos();e.transform.position=t.transform.position,e.active=!0,Oe.instance.timeManager.onceExecute(1.5,this,function(){e.removeSelf(),e.destroy()})}initPoints(){let e=wt.instance.getManagerPathByName(this.config.managerPath),t=e.numChildren;for(let i=0;i<t;i++){const t=e.getChildAt(i);this.points.push(t)}}getStartPos(){for(let e=0;e<this.points.length;e++){const t=this.points[e];if(-1!=t.name.indexOf("0"))return t}return this.points[0]}upgradeNpc(){}randomMovePos(){this.posIndexs=[];for(let e=0;e<this.points.length;e++)e!=this.curPosIndex&&this.posIndexs.push(e);let e=w.random(0,this.posIndexs.length-1);this.curPosIndex=this.posIndexs[e];let t=this.points[this.curPosIndex],i=t.transform.position,a=this.owner.transform.position,n=1e3*Laya.Vector3.distance(a,i)/2,s=this;this.animCtr.play("walk"),this.rotateBody(a,i,500),w.tweenMove(a,i,function(e){s.owner.transform.position=e},function(){Oe.instance.timeManager.onceExecute(8,s,s.randomMovePos);let e=t.name.indexOf("work");s.vectorBackZ.x=0,s.vectorBackZ.y=0,s.vectorBackZ.z=-1,s.rotateBodyByDir(s.vectorBackZ,200),-1!=e?s.animCtr.play("work"):s.animCtr.play("idle")},n)}}class st{constructor(){this.islandLevel=0,this.managerLevel=0,this.hudGoldLogic=null,this.curOutputTime=0,this.outputTime=0,this.isStartOutput=!1,this.islandNpc=null,this.upgradeEffect=null}init(e){this.islandId=e,this.isStartOutput=!1,this.confg=Oe.instance.userData.getIslandConfigById(e),this.islandCenter=new Laya.Vector3(this.confg.areaCenterX,this.confg.areaCenterY,this.confg.areaCenterZ),this.initData(),this.loadIslandRes(),this.initOutput(),this.initManager(),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.on(t.ui_upgradeManager,this,this.upgradeManager),Oe.instance.eventManager.on(t.ui_unlockManager,this,this.unlockManager),Oe.instance.eventManager.on(t.doubleTimeStart,this,this.doubleTimeStart)}initData(){let e=Oe.instance.userData.getIslandInfoById(this.islandId);null!==e?(this.islandLevel=e.islandLevel,this.managerLevel=e.managerLevel):(this.islandLevel=0,this.managerLevel=0)}initRes(){let e="0"+this.islandId+"-upgrade00",t="0"+this.islandId+"-upgrade01",i="0"+this.islandId+"-upgrade02";this.island0=ot.instance.islandParent.getChildByName(e),this.island1=ot.instance.islandParent.getChildByName(t),this.island2=ot.instance.islandParent.getChildByName(i),this.islandAnchor=this.island0.getChildByName("AreaAnchor"),0==this.islandLevel?(this.island0.active=!1,this.island1.active=!1,this.island2.active=!1):this.islandLevel>=1&&this.islandLevel<y.islandLevel1?(this.island0.active=!0,this.island1.active=!1,this.island2.active=!1):this.islandLevel>=y.islandLevel1&&this.islandLevel<y.islandLevel2?(this.island0.active=!0,this.island1.active=!0,this.island2.active=!1):this.islandLevel>=y.islandLevel2&&(this.island0.active=!0,this.island1.active=!0,this.island2.active=!0)}loadIslandRes(){1==this.islandId?this.doLoadRes():this.islandLevel>=1&&this.doLoadRes()}doLoadRes(e){let t="0"+this.islandId+"-upgrade00.lh",i="0"+this.islandId+"-upgrade01.lh",a="0"+this.islandId+"-upgrade02.lh",n=y.resRootPath+t,s=y.resRootPath+i,o=y.resRootPath+a,r=this;Oe.instance.loadManager.loadPrefab3D(n,function(t){r.loadComplete0(t),Oe.instance.loadManager.loadPrefab3D(s,function(t){r.loadComplete1(t),Oe.instance.loadManager.loadPrefab3D(o,function(t){r.loadComplete2(t),e&&e()},r)},r)},this)}loadComplete0(e){this.island0=e;let t=new Laya.Vector3(e.transform.position.x,e.transform.position.y,e.transform.position.z),i=new Laya.Vector3(e.transform.rotationEuler.x,e.transform.rotationEuler.y,e.transform.rotationEuler.z);ot.instance.islandParent.addChild(e),e.transform.position=t,e.transform.rotationEuler=i,e.active=!0,this.islandAnchor=this.island0.getChildByName("AreaAnchor"),0==this.islandLevel?this.island0.active=!1:this.islandLevel>=1&&this.islandLevel<y.islandLevel1?this.island0.active=!0:this.islandLevel>=y.islandLevel1&&this.islandLevel<y.islandLevel2?this.island0.active=!0:this.islandLevel>=y.islandLevel2&&(this.island0.active=!0)}loadComplete1(e){this.island1=e;let t=new Laya.Vector3(e.transform.position.x,e.transform.position.y,e.transform.position.z),i=new Laya.Vector3(e.transform.rotationEuler.x,e.transform.rotationEuler.y,e.transform.rotationEuler.z);ot.instance.islandParent.addChild(e),e.transform.position=t,e.transform.rotationEuler=i,e.active=!0,0==this.islandLevel?this.island1.active=!1:this.islandLevel>=1&&this.islandLevel<y.islandLevel1?this.island1.active=!1:this.islandLevel>=y.islandLevel1&&this.islandLevel<y.islandLevel2?this.island1.active=!0:this.islandLevel>=y.islandLevel2&&(this.island1.active=!0)}loadComplete2(e){this.island2=e;let t=new Laya.Vector3(e.transform.position.x,e.transform.position.y,e.transform.position.z),i=new Laya.Vector3(e.transform.rotationEuler.x,e.transform.rotationEuler.y,e.transform.rotationEuler.z);ot.instance.islandParent.addChild(e),e.transform.position=t,e.transform.rotationEuler=i,e.active=!0,0==this.islandLevel?this.island2.active=!1:this.islandLevel>=1&&this.islandLevel<y.islandLevel1?this.island2.active=!1:this.islandLevel>=y.islandLevel1&&this.islandLevel<y.islandLevel2?this.island2.active=!1:this.islandLevel>=y.islandLevel2&&(this.island2.active=!0)}initManager(){0!=this.managerLevel&&(this.islandNpc=new nt,this.islandNpc.init(this.islandId))}initOutput(){this.islandLevel<=0||(this.isStartOutput=!0,this.curOutputTime=0,this.outputTime=1e3*this.confg.outputTime,this.showGoldNum(),Oe.instance.timeManager.framLoop(this,this.outputUpdate))}showGoldNum(){null==this.hudGoldLogic&&(this.hudGoldLogic=new at,this.hudGoldLogic.init(this));let e=Oe.instance.userData.getIslandOutputGoldByCfg(this.confg,this.islandLevel,this.managerLevel);this.hudGoldLogic.showGoldNum(e)}getIslandNPC(){return this.islandNpc}doubleTimeStart(){this.initOutput()}outputUpdate(){this.isStartOutput&&(this.curOutputTime+=Laya.timer.delta,this.curOutputTime>=this.outputTime&&this.completeOutput(),this.hudGoldLogic.updateProgress(this.getCurOutputProgress()))}getCurOutputProgress(){return this.curOutputTime/this.outputTime}completeOutput(){this.isStartOutput=!1,this.managerLevel<=0?this.hudGoldLogic.showHud():this.getProduce()}onHudClick(){let e=this.getProduce();this.hudGoldLogic.showCollectGoldEffect(e)}getProduce(){let e=Oe.instance.userData.getIslandOutputGoldByCfg(this.confg,this.islandLevel,this.managerLevel);return Ue.instance.isDoubleProduce()&&(e*=2),Oe.instance.userData.addGold(e),this.nextOutput(),e}nextOutput(){this.curOutputTime=0,this.isStartOutput=!0,this.hudGoldLogic.updateProgress(0)}upgradeIsland(e){if(e!==this.islandId)return;this.initData(),this.showGoldNum();let t=this;if(this.islandLevel==y.islandLevel1)this.showUnlockEffect(),Oe.instance.timeManager.onceExecute(3,this,function(){t.showUpgradeIsland(t.island1)});else if(this.islandLevel==y.islandLevel2)this.showUnlockEffect(),Oe.instance.timeManager.onceExecute(3,this,function(){t.showUpgradeIsland(t.island2)});else{if(null==this.upgradeEffect){let e=Laya.Sprite3D.instantiate(ot.instance.islandUnlockEffect);Oe.instance.scene3D.addChild(e),e.transform.position=this.islandCenter,e.active=!0,this.upgradeEffect=e,e.getComponent(Laya.Animator).play("upgradeIsland");let i=function(){e.removeSelf(),e.destroy(),t.upgradeEffect=null};Oe.instance.timeManager.onceExecute(3,this,i)}Oe.instance.soundManager.playSound("sound/upgradeIsland.mp3")}}showUpgradeIsland(e){if(null==e)return;let t=e.transform.localPosition,i=t.y-6,a=t.y+2,n=new Laya.Vector3;n.x=t.x,n.z=t.z,n.y=i;let s=new Laya.Vector3;s.x=t.x,s.z=t.z,s.y=a;let o=new Laya.Vector3;o.x=t.x,o.y=t.y,o.z=t.z,e.transform.localPosition=n,e.active=!0;let r=this;this.tweenMove(n,s,function(t){e.transform.localPosition=t},function(){r.tweenMove(n,o,function(t){e.transform.localPosition=t},function(){},100)},200)}unlockIsland(e){if(e!==this.islandId)return;let t=this;this.doLoadRes(function(){t.showUnlockEffect();Oe.instance.timeManager.onceExecute(3,t,function(){t.unlockEffectComplete(e)})})}showUnlockEffect(){if(null==this.islandCenter)return;Oe.instance.soundManager.playSound("sound/unlockIsland.mp3");let e=Laya.Sprite3D.instantiate(ot.instance.islandUnlockEffect);Oe.instance.scene3D.addChild(e),e.transform.position=this.islandCenter,e.active=!0,e.getComponent(Laya.Animator).play("unlockIsland");let i=this;Oe.instance.timeManager.onceExecute(5,this,function(){e.removeSelf(),e.destroy(),Oe.instance.eventManager.fire(t.ui_unlockIslandComplete,i.confg)})}unlockEffectComplete(e){this.initData();let t=this,i=function(){t.initOutput()};if(1==e)return this.island0.active=!0,void Oe.instance.timeManager.onceExecute(3,this,i);let a=this.island0.transform.localPosition,n=a.y-6,s=a.y+2,o=new Laya.Vector3;o.x=a.x,o.z=a.z,o.y=n;let r=new Laya.Vector3;r.x=a.x,r.z=a.z,r.y=s;let h=new Laya.Vector3;h.x=a.x,h.y=a.y,h.z=a.z,this.island0.transform.localPosition=o,this.island0.active=!0,this.tweenMove(o,r,function(e){t.island0.transform.localPosition=e},function(){t.tweenMove(o,h,function(e){t.island0.transform.localPosition=e},function(){Oe.instance.timeManager.onceExecute(3,t,i)},100)},200)}unlockManager(e){e===this.islandId&&(this.initData(),this.islandNpc=new nt,this.islandNpc.isShowEffect=!0,this.islandNpc.init(this.islandId),this.showGoldNum(),this.hudGoldLogic.hideHud(),Oe.instance.eventManager.fire(t.logic_unlockManager,this.islandNpc),this.nextOutput())}upgradeManager(e){e===this.islandId&&(this.initData(),this.islandNpc.upgradeNpc(),this.showGoldNum())}tweenMove(e,t,i,a,n){Laya.Tween.to(e,{x:t.x,y:t.y,z:t.z,update:new Laya.Handler(this,function(){i(e)})},n,null,Laya.Handler.create(this,function(){a&&a()}))}getIslandHudPos(){return null==this.islandAnchor?this.islandCenter:this.islandAnchor.transform.position}}class ot{constructor(){this.allIsland=[],ot._instance=this}static get instance(){return ot._instance}init(){this.islandParent=Oe.instance.scene3D.getChildByName("hamstervillage-all");for(let e=1;e<=7;e++){let t=new st;t.init(e),this.allIsland.push(t)}this.islandUnlockEffect=Oe.instance.scene3D.getChildByName("IslandUnlockEffect"),this.islandUnlockEffect.active=!1;let e=Oe.instance.scene3D.getChildByName("sea");this.unlockIslandBg=e.getChildByName("unlockIslandBg"),this.unlockIslandBg.active=!1,Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland)}getIslandById(e){for(let t=0;t<this.allIsland.length;t++){const i=this.allIsland[t];if(i.islandId==e)return i}return null}unlockIsland(){this.unlockIslandBg.active=!0,Oe.instance.timeManager.clear(this,this.hideUnlockIslandBg),Oe.instance.timeManager.onceExecute(6,this,this.hideUnlockIslandBg)}hideUnlockIslandBg(){this.unlockIslandBg.active=!1}}class rt{constructor(){this.touchPos=new Laya.Vector2(1e4,1e4),this.isDrag=!1,this.istouchDown=!1,this.lastDistance=0}init(e){this.touchBox=e,this.touchBox.on(Laya.Event.MOUSE_DOWN,this,this.onTouchBoxDown),this.touchBox.on(Laya.Event.MOUSE_MOVE,this,this.onTouchBoxMove),this.touchBox.on(Laya.Event.MOUSE_UP,this,this.onTouchBoxUp),this.touchBox.on(Laya.Event.MOUSE_OUT,this,this.onTouchBoxUp)}onTouchBoxDown(e){this.isDrag=!1,this.istouchDown=!0;let t=e.touches;t&&2==t.length?this.lastDistance=this.getDistance(t):t&&1==t.length&&(this.touchPos.x=e.stageX,this.touchPos.y=e.stageY,this.isDrag=!0)}onTouchBoxMove(e){let t=e.touches;if(t&&2==t.length){let t=this.getDistance(e.touches);const i=1;let a=(t-this.lastDistance)*i;ft.instance.scaleCamera(a),this.lastDistance=t}else this.isDrag&&t&&1==t.length&&this.dragCamera(e)}onTouchBoxUp(e){this.istouchDown=!1}dragCamera(e){0==this.istouchDown&&(this.touchPos.x=e.stageX,this.touchPos.y=e.stageY,this.istouchDown=!0),1e4==this.touchPos.x&&1e4==this.touchPos.y&&(this.touchPos.x=e.stageX,this.touchPos.y=e.stageY);let t=1*(e.stageX-this.touchPos.x),i=1*(e.stageY-this.touchPos.y);ft.instance.dragCamera(t,i),this.touchPos.x=e.stageX,this.touchPos.y=e.stageY}getDistance(e){let t=0;if(e&&2==e.length){let i=e[0].stageX-e[1].stageX,a=e[0].stageY-e[1].stageY;t=Math.sqrt(i*i+a*a)}return t}}class ht{constructor(){this.isShow=!1,this.husPos=new Laya.Vector3,this.isCanClick=!0}init(){this.ring=Oe.instance.scene3D.getChildByName("lifeRing"),this.ring.active=!1,this.isShow=!1,this.isCanClick=!0,this.createImage(),this.showRing(),Oe.instance.timeManager.framLoop(this,this.updateHudPos),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_closeUpgradeIslandView,this,this.closeUpgradeIslandView),Oe.instance.eventManager.on(t.ui_openUpgradeIslandView,this,this.openUpgradeIslandView),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete)}newGuideAllComplete(){this.showRing()}updateHudPos(){if(0==this.isShow||null==this.ring||null==this.hudImage)return;let e=new Laya.Vector4,t=this.husPos;ft.instance.mainCamera.worldToViewportPoint(t,e),this.hudImage.pos(e.x,e.y)}unlockIsland(){let e=this;this.hideRing(),Oe.instance.timeManager.onceExecute(5,this,function(){e.showRing()})}showRing(){if(0==Oe.instance.newGuide.isCompleteGuide)return void this.hideRing();let e=this.getNextUnlockIsland();if(0==e||1==e)return void this.hideRing();let t=ot.instance.getIslandById(e);if(!t||!t.islandCenter)return void this.hideRing();let i=t.islandCenter,a=new Laya.Vector3;a.x=i.x,a.y=-3.78,a.z=i.z,this.ring.transform.position=a,this.isShow=!0,this.husPos.x=i.x,this.husPos.y=a.y+5,this.husPos.z=i.z;let n="UI/islandHud"+e+".png";this.hudImage.skin=n,this.ring.active=!0,this.hudImage.visible=!0,this.isCanClick=!0}getNextUnlockIsland(){let e=Oe.instance.userData.mIslandDataInfos,t=1e5;for(let i=0;i<e.length;i++){const a=e[i];a.islandLevel<=0&&t>a.islandId&&(t=a.islandId)}return 1e5===t&&(t=0),t}hideRing(){this.ring.active=!1,this.hudImage.visible=!1,this.isShow=!1}createImage(){let e=new Laya.Image("");e.x=-59,e.y=0,e.anchorX=.5,e.anchorY=1,e.visible=!0,mt.instance.hudHeartParent.addChild(e),this.hudImage=e,this.hudImage.on(Laya.Event.CLICK,this,this.onHudClick)}onHudClick(){this.isCanClick&&(this.isCanClick=!1,Oe.instance.scenesManager.openScene(y.UpgradeIslandView,Laya.Handler.create(this,function(e){e.scrollToLock()}),!1))}closeUpgradeIslandView(){this.isCanClick=!0}openUpgradeIslandView(){this.isCanClick=!1}}class lt{constructor(){this.skin="UI/hudMission.png",this.skinComplete="UI/hudMissionComplete.png",this.targetScale=1.2,this.scale=1.2,this.isCanClick=!0,this.tempPos=new Laya.Vector4,this.tempHudPos=new Laya.Vector3}init(){this.missionObj3D=Oe.instance.scene3D.getChildByName("MissionBoard"),this.createImage(),this.anim(),this.showStart(),this.isCanClick=!0,0==Oe.instance.newGuide.isCompleteGuide&&(this.image.visible=!1),Oe.instance.timeManager.framLoop(this,this.updatePos),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete),Oe.instance.eventManager.on(t.ui_openMissionView,this,this.openMissionView),Oe.instance.eventManager.on(t.ui_closeMissionView,this,this.closeMissionView)}newGuideAllComplete(){this.image.visible=!0}openMissionView(){this.isCanClick=!1}closeMissionView(){this.isCanClick=!0}updatePos(){if(null==this.missionObj3D)return;let e=this.getHudPos();ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.image.pos(this.tempPos.x,this.tempPos.y)}getHudPos(){if(null==this.missionObj3D)return;return this.tempHudPos.x=this.missionObj3D.transform.position.x,this.tempHudPos.y=this.missionObj3D.transform.position.y+0,this.tempHudPos.z=this.missionObj3D.transform.position.z,this.tempHudPos}createImage(){let e=new Laya.Image(this.skin);e.x=-59,e.y=0,e.anchorX=.5,e.anchorY=1,e.visible=!0,mt.instance.hudSceneParent.addChild(e),this.image=e,this.image.on(Laya.Event.CLICK,this,this.onHudClick)}onHudClick(){this.isCanClick&&(this.isCanClick=!1,Oe.instance.scenesManager.openScene(y.MissionView,Laya.Handler.create(this,function(e){}),!1))}showStart(){this.image.skin=this.skin}showCompelte(){this.image.skin=this.skinComplete}anim(){Laya.Tween.to(this.image,{scaleX:this.targetScale,scaleY:this.targetScale},500,null,Laya.Handler.create(this,function(){this.targetScale==this.scale?this.targetScale=1:this.targetScale=this.scale,this.anim()}))}showHud(){this.image.visible=!0}hideHud(){this.image.visible=!1}}class dt{constructor(){this.totalCount=1,dt._instance=this}static get instance(){return dt._instance}init(){this.hudLogic=new lt,this.hudLogic.init(),this.initProgress(),Oe.instance.timeManager.loop(.1,this,this.update),Oe.instance.eventManager.on(t.mission_colloctHeart,this,this.colloctHeart),Oe.instance.eventManager.on(t.treasure_digComplete,this,this.digComplete)}initProgress(){this.cfg=Oe.instance.userData.getCurMissionConfig(),this.curProgressCount=0,this.cfg.missionType==o.collectHeart&&(this.curProgressCount=Oe.instance.userData.missionColloctHeartTimes)}update(){this.check()}missionComplete(){this.cfg=Oe.instance.userData.getCurMissionConfig(),this.cfg.missionType==o.collectHeart&&Oe.instance.userData.setMissionCollectHeartTimes(0),this.curProgressCount=0,this.check()}check(){switch(this.cfg.missionType){case o.unlockIsland:let e=this.cfg.param1,t=Oe.instance.userData.getIslandInfoById(e);this.totalCount=1,t.islandLevel>0&&(this.curProgressCount=1);break;case o.collectHeart:this.totalCount=this.cfg.param1;break;case o.upgradeHamster:this.curProgressCount=Oe.instance.userData.mHamsterLevel,this.totalCount=this.cfg.param1;break;case o.upgradeIsland:let i=this.cfg.param1,a=Oe.instance.userData.getIslandInfoById(i);this.curProgressCount=a.islandLevel,this.totalCount=this.cfg.param2;break;case o.upgradeManager:let n=this.cfg.param1,s=Oe.instance.userData.getIslandInfoById(n);this.curProgressCount=s.managerLevel,this.totalCount=this.cfg.param2;break;case o.digTreasure:this.totalCount=this.cfg.param1;break;case o.lookAd:this.curProgressCount=Oe.instance.userData.mLookAdTimes,this.totalCount=this.cfg.param1}this.curProgressCount>=this.totalCount?this.hudLogic.showCompelte():this.hudLogic.showStart()}getCurConfig(){return this.cfg}getTotalCount(){return this.totalCount}getMissionProgress(){return this.curProgressCount}colloctHeart(){this.cfg.missionType==o.collectHeart&&(this.curProgressCount++,Oe.instance.userData.setMissionCollectHeartTimes(this.curProgressCount))}digComplete(){this.cfg.missionType==o.digTreasure&&this.curProgressCount++}}class ct{constructor(){this.targetScale=1.2,this.scale=1.2,this.isStartShow=!1,this.tempPos=new Laya.Vector4,this.tempHudPos=new Laya.Vector3}init(e){this.owner=e,this.isStartShow=!1,this.createImage(),this.anim(),Oe.instance.timeManager.framLoop(this,this.updatePos)}updatePos(){if(null==this.owner||0==this.isStartShow)return;let e=this.getHudPos();ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.image.pos(this.tempPos.x,this.tempPos.y)}getHudPos(){if(null==this.owner)return;return this.tempHudPos.x=this.owner.transform.position.x,this.tempHudPos.y=this.owner.transform.position.y+1,this.tempHudPos.z=this.owner.transform.position.z,this.tempHudPos}createImage(){let e=new Laya.Image("UI/hudTreasure.png");e.x=-59,e.y=0,e.anchorX=.5,e.anchorY=1,mt.instance.hudSceneParent.addChild(e),this.image=e,this.image.on(Laya.Event.CLICK,this,this.onHudClick),e.visible=!1}onHudClick(){this.hide(),Oe.instance.eventManager.fire(t.hud_onClickTreasure,this.pointObj)}anim(){Laya.Tween.to(this.image,{scaleX:this.targetScale,scaleY:this.targetScale},500,null,Laya.Handler.create(this,function(){this.targetScale==this.scale?this.targetScale=1:this.targetScale=this.scale,this.anim()}))}show(e){this.isStartShow=!0,this.image.visible=!0,this.pointObj=e}hide(){this.isStartShow=!1,this.image.visible=!1}}class gt{constructor(){this.treasurePoints=[],this.interval=30,this.tempPos=new Laya.Vector4}init(){this.treasure=Oe.instance.scene3D.getChildByName("treasure"),this.digEffect=this.treasure.getChildByName("digEffect"),this.treasure.active=!1;let e=Oe.instance.scene3D.getChildByName("TreasurePoint"),i=e.numChildren;for(let t=0;t<i;t++){let i=(t+1).toString(),a=e.getChildByName(i);this.treasurePoints.push(a)}this.initHud(),1==Oe.instance.newGuide.isCompleteGuide&&this.randomShowTreasure(),Oe.instance.eventManager.on(t.hud_onClickTreasure,this,this.onClickTreasure),Oe.instance.eventManager.on(t.treasure_arriveTarget,this,this.hamsterArriveTarget),Oe.instance.eventManager.on(t.treasure_digComplete,this,this.digComplete),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete)}initHud(){this.hudLogic=new ct,this.hudLogic.init(this.treasure),this.hudLogic.hide()}newGuideAllComplete(){this.randomShowTreasure()}getTreasurePointObj(){let e=[],t=Oe.instance.userData.mIslandDataInfos;if(0==t.length)e.push(1);else for(let i=0;i<t.length;i++){const a=t[i];(a.islandLevel>=1||1==a.islandId)&&e.push(a.islandId)}let i=w.random(0,e.length-1);return i>=this.treasurePoints.length?this.treasurePoints[0]:this.treasurePoints[i]}randomShowTreasure(){let e=w.random(30,50);Oe.instance.timeManager.onceExecute(e,this,this.showTreasure)}showTreasure(){let e=this.getTreasurePointObj();this.treasure.transform.position=e.transform.position,this.treasure.active=!0,this.digEffect.active=!1,this.hudLogic.show(e)}hideTreasure(){this.treasure.active=!1,this.digEffect.active=!1}onClickTreasure(){}hamsterArriveTarget(e){this.digEffect.transform.rotationEuler=e.transform.rotationEuler,this.digEffect.active=!0}digComplete(e){this.hideTreasure(),Oe.instance.soundManager.playSound("sound/treasureReward.mp3"),Oe.instance.scenesManager.openScene(y.TreasureView,Laya.Handler.create(this,function(e){}),!1),this.randomShowTreasure()}createLabel(e,t,i){let a=new Laya.Label;a.font="Microsoft YaHei",a.fontSize=25,a.bold=!0,a.color="#ffffff",a.anchorX=.5,a.anchorY=.5,a.x=e,a.y=t,a.stroke=2,a.strokeColor="#000000",mt.instance.hudHeartParent.addChild(a),a.visible=!0,a.text=w.convert(i);let n=t-70;return Laya.Tween.to(a,{y:n},1500,null,Laya.Handler.create(this,function(){a.removeSelf(),a.destroy()})),a}createRewardImage(e,t){let i=new Laya.Image(e);return i.anchorX=.5,i.anchorY=.5,t.addChild(i),i.visible=!0,i.pos(-t.width/2+5,10),i.scaleX=.5,i.scaleY=.5,i}}class mt extends Laya.Script3D{constructor(){super(),mt._instance=this}static get instance(){return mt._instance}onAwake(){this.init()}init(){(new ft).init(),this.initHudSceneParent(),this.initHudHeartParent(),this.initTouchBox(),this.initHudGoldParent(),(new wt).init(),(new gt).init(),(new dt).init(),(new Ee).init(),(new Ue).init(),(new ot).init(),(new ht).init(),(new yt).init(),Oe.instance.eventManager.on(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.on(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.on(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.on(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.on(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.timeManager.loop(30,this,this.setGameTime)}setGameTime(){Oe.instance.userData.setGameTime()}eggBornHamster(){this.hideHud()}eggBornHamsterComplete(){this.showHud()}buyHamster(){this.hideHud()}unlockIsland(){this.hideHud()}buyHamsterComplete(){this.showHud()}unlockIslandComplete(){this.showHud()}upgradeIsland(e){let t=Oe.instance.userData.getIslandInfoById(e);t.islandLevel!=y.islandLevel1&&t.islandLevel!=y.islandLevel2||this.hideHud()}showHud(){this.hudHeartParent.visible=!0,this.hudGoldParent.visible=!0,this.hudSceneParent.visible=!0}hideHud(){this.hudHeartParent.visible=!1,this.hudGoldParent.visible=!1,this.hudSceneParent.visible=!1}initTouchBox(){let e=new Laya.Box;e.width=Laya.stage.width,e.height=Laya.stage.height,e.scaleX=1,e.scaleY=1,e.anchorX=0,e.anchorY=0,e.pos(0,0),Laya.stage.addChildAt(e,1),(new rt).init(e)}initHudHeartParent(){this.hudHeartParent=new Laya.Box,this.hudHeartParent.width=Laya.stage.width,this.hudHeartParent.height=Laya.stage.height,this.hudHeartParent.scaleX=1,this.hudHeartParent.scaleY=1,this.hudHeartParent.anchorX=0,this.hudHeartParent.anchorY=0,this.hudHeartParent.pos(0,0),this.hudHeartParent.mouseThrough=!0,Laya.stage.addChildAt(this.hudHeartParent,1),this.hudHeartParent.visible=!0}initHudSceneParent(){this.hudSceneParent=new Laya.Box,this.hudSceneParent.width=Laya.stage.width,this.hudSceneParent.height=Laya.stage.height,this.hudSceneParent.scaleX=1,this.hudSceneParent.scaleY=1,this.hudSceneParent.anchorX=0,this.hudSceneParent.anchorY=0,this.hudSceneParent.pos(0,0),this.hudSceneParent.mouseThrough=!0,Laya.stage.addChildAt(this.hudSceneParent,1),this.hudSceneParent.visible=!0}initHudGoldParent(){this.hudGoldParent=new Laya.Box,this.hudGoldParent.width=1,this.hudGoldParent.height=1,this.hudGoldParent.scaleX=1,this.hudGoldParent.scaleY=1,this.hudGoldParent.anchorX=0,this.hudGoldParent.anchorY=0,Laya.stage.addChildAt(this.hudGoldParent,1),this.hudGoldParent.visible=!0}}class ut{constructor(){this.tempHudPos=new Laya.Vector3,this.tempPos=new Laya.Vector4}initHud(){Oe.instance.timeManager.framLoop(this,this.updatePos)}updatePos(){let e=this.getHudPos();null!=e&&(ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.updateObj.pos(this.tempPos.x,this.tempPos.y))}getHudPos(){return this.tempHudPos}createImage(e){let t=new Laya.Image(e);return t.x=-59,t.y=0,t.anchorX=.5,t.anchorY=.5,t.visible=!0,t}}class vt extends ut{constructor(){super(...arguments),this.isShow=!1}initHud(){super.initHud()}createImage(e){let t=super.createImage(e);return t.anchorX=.5,t.anchorY=1,this.hudParent.addChild(t),this.image=t,this.updateObj=t,t.on(Laya.Event.CLICK,this,this.onHudClick),t}onHudClick(){}createLabel(e){let t=new Laya.Label;t.font="Microsoft YaHei",t.fontSize=25,t.bold=!0,t.color="#ffffff",t.anchorX=.5,t.anchorY=.5,t.x=this.image.x,t.y=this.image.y-20,t.stroke=2,t.strokeColor="#000000",this.hudParent.addChild(t),t.visible=!0,t.text=e;let i=this.image.y-70;return Laya.Tween.to(t,{y:i},800,null,Laya.Handler.create(this,function(){t.removeSelf(),t.destroy()})),t}show(){this.image.visible=!0}hide(){this.image.visible=!1}}class pt extends vt{constructor(){super(...arguments),this.curShowTime=0,this.totalShowTime=5}init(){this.hudParent=mt.instance.hudHeartParent,this.isShow=!1,this.createImage("UI/hudheart.png"),this.initHud()}showHeart(e){this.owner=e,this.totalShowTime=.1*w.random(80,110),this.curShowTime=0,this.show()}updatePos(){null!=this.owner&&(super.updatePos(),this.curShowTime+=.001*Laya.timer.delta,this.curShowTime>=this.totalShowTime&&1==Oe.instance.newGuide.isCompleteGuide&&this.collectHeart())}getHudPos(){return this.owner.getHudPos()}onHudClick(){let e=Laya.Sprite3D.instantiate(wt.instance.heartEffect);Oe.instance.scene3D.addChild(e);let i=this.owner.getHudPos();e.transform.position=i,e.active=!0,Oe.instance.timeManager.onceExecute(5,this,function(){e.removeSelf(),e.destroy()}),this.collectHeart(),Oe.instance.eventManager.fire(t.mission_colloctHeart),Oe.instance.soundManager.playSound("sound/heartCollect.mp3")}collectHeart(){let e=Oe.instance.userData.getHeartProduce(),t=w.convert(e);Ue.instance.isDoubleProduce()?(Oe.instance.userData.addHeart(2*e),t+=" x2"):Oe.instance.userData.addHeart(e);let i=this.createLabel(t);this.createRewardImage("UI/heart.png",i),this.owner=null,this.hide()}createRewardImage(e,t){let i=new Laya.Image(e);return i.x=-59,i.y=0,i.anchorX=.5,i.anchorY=.5,t.addChild(i),i.visible=!0,i.pos(-t.width/2-10,10),i.scaleX=.6,i.scaleY=.6,i}show(){this.isShow=!0,super.show()}hide(){this.isShow=!1,super.hide()}}class St extends vt{constructor(){super(...arguments),this.targetScale=1.2,this.scale=1.2,this.isCanClick=!0}init(){this.hudParent=mt.instance.hudSceneParent,this.bornHouse=wt.instance.bornHouse,this.isShow=!1,this.createImage("UI/hudHamster.png"),this.initHud(),this.anim(),this.isCanClick=!0,Oe.instance.eventManager.on(t.ui_closeHamsterView,this,this.closeHamsterView),Oe.instance.eventManager.on(t.ui_openHamsterView,this,this.openHamsterView)}onHudClick(){this.isCanClick&&(this.isCanClick=!1,Oe.instance.scenesManager.openScene(y.HamsterView,Laya.Handler.create(this,function(e){}),!1))}getHudPos(){if(null==this.bornHouse||0==this.isShow)return null;return this.tempHudPos.x=this.bornHouse.transform.position.x,this.tempHudPos.y=this.bornHouse.transform.position.y+7.5,this.tempHudPos.z=this.bornHouse.transform.position.z,this.tempHudPos}show(){this.isShow=!0,super.show()}hide(){this.isShow=!1,super.hide()}anim(){Laya.Tween.to(this.image,{scaleX:this.targetScale,scaleY:this.targetScale},500,null,Laya.Handler.create(this,function(){this.targetScale==this.scale?this.targetScale=1:this.targetScale=this.scale,this.anim()}))}closeHamsterView(){this.isCanClick=!0}openHamsterView(){this.isCanClick=!1}}class It extends et{init(e){super.init(e)}loadRes(){console.log("this.id == "+this.id);let e=Oe.instance.userData.getClothHamsterConfigById(this.id),t=y.clothHamsterRootPath+e.res+".lh";Oe.instance.loadManager.loadPrefab3D(t,this.loadComplete,this)}loadComplete(e){this.owner=Laya.Sprite3D.instantiate(e),Oe.instance.scene3D.addChild(this.owner),this.owner.active=!0,this.setRandomBornPos()}setNormalHamsterTex(){}buyHamsterCloth(e){this.id=e,this.showUnlockEffect(),Oe.instance.soundManager.playSound("sound/createNpc.mp3");let t=Oe.instance.userData.getClothHamsterConfigById(e),i=y.clothHamsterRootPath+t.res+".lh";Oe.instance.loadManager.loadPrefab3D(i,this.loadCompleteBuy,this)}loadCompleteBuy(e){this.owner=Laya.Sprite3D.instantiate(e),Oe.instance.scene3D.addChild(this.owner),this.owner.active=!1;let i=wt.instance.getClothIslandPos();this.owner.transform.position=i.transform.position,this.animCtr=this.owner.getComponent(Laya.Animator);let a=this;Oe.instance.timeManager.onceExecute(1,this,function(){a.owner.active=!0,a.playAnim("stretch"),Oe.instance.timeManager.onceExecute(2.2,this,function(){Oe.instance.eventManager.fire(t.ui_buyHamsterClothComplete,a.owner),a.randomMove()})})}showUnlockEffect(){let e=y.npcHamsterRootPath+"NpcUnlockEffect.lh";Oe.instance.loadManager.loadPrefab3D(e,this.effectLoadComplete,this)}effectLoadComplete(e){Oe.instance.scene3D.addChild(e);let t=wt.instance.getClothIslandPos();e.transform.position=t.transform.position,e.active=!0,Oe.instance.timeManager.onceExecute(1.5,this,function(){e.removeSelf(),e.destroy()})}bornHamster(e){this.id=e;let t=Oe.instance.userData.getClothHamsterConfigById(e),i=y.clothHamsterRootPath+t.res+".lh";Oe.instance.loadManager.loadPrefab3D(i,this.loadCompleteBorn,this)}loadCompleteBorn(e){this.owner=Laya.Sprite3D.instantiate(e),Oe.instance.scene3D.addChild(this.owner),this.owner.active=!0;let t=wt.instance.getClothBornPos();this.owner.transform.position=t.transform.position,this.animCtr=this.owner.getComponent(Laya.Animator),this.playAnim("stretch"),Oe.instance.timeManager.onceExecute(2.2,this,this.goIsland)}goIsland(){this.playAnim("walk");let e=wt.instance.getClothIslandPos().transform.position,t=this.owner.transform.position,i=1e3*Laya.Vector3.distance(t,e)/this.moveSpeed,a=this;this.rotateBody(t,e,500),this.curTween=w.tweenMove(t,e,function(e){a.owner.transform.position=e},function(){a.curTween=null,a.randomMove()},i)}}class wt{constructor(){this.hamsterPointInfos=[],this.mHUDHeartLogic=[],this.allNormalHamsters=[],this.allClothHamsters=[],this.mHUDHamsterLogic=null,wt._instance=this}static get instance(){return wt._instance}init(){let e=Oe.instance.scene3D.getChildByName("hamstervillage-all");this.normalBornPos=Oe.instance.scene3D.getChildByName("normalBornPos"),this.clothBornPos=Oe.instance.scene3D.getChildByName("clothBornPos"),this.clothIslandPos=Oe.instance.scene3D.getChildByName("clothIslandPos");let i=Oe.instance.scene3D.getChildByName("egg"),a=i.getChildByName("Effects");this.eggBombEffect=a.getChildByName("Explosion"),this.eggBombEffect.active=!1,this.eggAnimCtrl=i.getComponent(Laya.Animator),this.egg=i,this.guideBowPos=Oe.instance.scene3D.getChildByName("guideBowPos"),this.normalHamster=Oe.instance.scene3D.getChildByName("HamsterNormal"),this.heartEffect=Oe.instance.scene3D.getChildByName("HeartEffect"),this.heartEffect.active=!1,this.managerPointParent=Oe.instance.scene3D.getChildByName("NPCPoint");let n=e.getChildByName("0001-island");this.bornHouse=n.getChildByName("BornHouse"),this.houseAnimCtrl=this.bornHouse.getComponent(Laya.Animator);let s=this.bornHouse.getChildByName("root");this.houseHamster=s.getChildByName("hamster"),this.houseHamster.active=!1,this.normalPointParent=Oe.instance.scene3D.getChildByName("NormalPoint"),this.setPoints(),this.initHamster(),this.setNormalHamsterTex(),this.initHUDHamster(),Oe.instance.timeManager.loop(5,this,this.updateHeart),Oe.instance.eventManager.on(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.on(t.ui_buyHamsterCloth,this,this.buyHamsterCloth),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.hud_onClickTreasure,this,this.onClickTreasure),Oe.instance.eventManager.on(t.updateGold,this,this.checkBuyHamster),0==Oe.instance.newGuide.isCompleteGuide&&Oe.instance.eventManager.on(t.newGuide_cgComplete,this,this.startNewGuide),Oe.instance.eventManager.on(t.subPackageLoadCompleteHamster,this,this.subPackageLoadComplete)}initHUDHamster(){null==this.mHUDHamsterLogic&&(this.mHUDHamsterLogic=new St,this.mHUDHamsterLogic.init(),this.checkBuyHamster())}initHamster(){let e=Oe.instance.userData.mHamsterNormals;for(let t=0;t<e.length;t++){const i=e[t];let a=new et;a.init(i),this.allNormalHamsters.push(a)}let t=Oe.instance.userData.mHamsterCloths;for(let e=0;e<t.length;e++){const i=t[e];let a=new It;a.init(i),this.allClothHamsters.push(a)}}startNewGuide(){0==Oe.instance.newGuide.isCompleteGuide&&(Oe.instance.userData.buyHamsterNormal(1),Oe.instance.eventManager.fire(t.ui_buyHamster,1))}subPackageLoadComplete(){this.setNormalHamsterTex()}setNormalHamsterTex(){let e=Oe.instance.userData.mHamsterNormals.length+1,t=Oe.instance.userData.getNormalConfgById(e),i=this.normalHamster.getChildByName("root").getChildByName("hamster"),a="normalTex/";if(!Oe.instance.isSubPackageLoadCompleteHamster)return;e>2&&(a="normalTex2/");let n=a+t.tex+".png";Oe.instance.loadManager.loadTexture(n,Laya.Handler.create(this,function(e){i.skinnedMeshRenderer.material.albedoTexture=e}))}unlockIsland(){this.setPoints()}setPoints(){let e=[],t=Oe.instance.userData.mIslandDataInfos;if(0==t.length)e.push(1);else for(let i=0;i<t.length;i++){const a=t[i];(a.islandLevel>=1||1==a.islandId)&&e.push(a.islandId)}this.hamsterPointInfos=[];for(let t=0;t<e.length;t++){const i=e[t];let a=new it;a.init(i),this.hamsterPointInfos.push(a)}}getIslandNormalPointById(e){for(let t=0;t<this.hamsterPointInfos.length;t++){const i=this.hamsterPointInfos[t];if(i.islandId==e)return i}return null}getRandomNormalPoint(){let e=w.random(0,this.hamsterPointInfos.length-1);return this.hamsterPointInfos[e]}buyHamster(e){console.log("购买 仓鼠id == "+e),this.houseHamster.active=!0;let t=this.normalHamster.getChildByName("root").getChildByName("hamster");this.houseHamster.skinnedMeshRenderer.material.albedoTexture=t.skinnedMeshRenderer.material.albedoTexture,this.houseAnimCtrl.play("openDoor",0,0),Oe.instance.soundManager.playSound("sound/openDoor.mp3");let i=this;this.setNormalHamsterTex(),Oe.instance.timeManager.onceExecute(7.8,this,function(){i.bornHamster(e),i.houseAnimCtrl.play("idle"),i.houseHamster.active=!1})}bornHamster(e){let i=new et;i.bornHamster(e),this.allNormalHamsters.push(i),Oe.instance.eventManager.fire(t.ui_buyHamsterComplete,i.owner)}buyHamsterCloth(e){let t=new It;t.buyHamsterCloth(e),this.allClothHamsters.push(t)}eggHamster(e){this.eggAnimCtrl.play("bomb");let i=this;Oe.instance.timeManager.onceExecute(2.5,this,function(){Oe.instance.soundManager.playSound("sound/eggBomb.mp3"),i.eggBornHamsterCloth(e)}),Oe.instance.timeManager.onceExecute(6.5,this,function(){Oe.instance.eventManager.fire(t.egg_bornHamsterComplete),i.eggAnimCtrl.play("idle"),Oe.instance.soundManager.playSound("sound/eggNew.mp3")}),Oe.instance.eventManager.fire(t.egg_bornHamster,this.egg)}eggBornHamsterCloth(e){let t=Laya.Sprite3D.instantiate(this.eggBombEffect);this.egg.addChild(t),t.transform.localPosition=new Laya.Vector3(0,2.5,0),t.active=!0,Oe.instance.timeManager.onceExecute(2,this,function(){t.removeSelf(),t.destroy()});let i=new It;i.bornHamster(e),this.allClothHamsters.push(i)}getNormalBornPos(){return this.normalBornPos}getClothBornPos(){return this.clothBornPos}getClothIslandPos(){return this.clothIslandPos}getGuideBowPos(){return this.guideBowPos}copyNormalHamster(){return Laya.Sprite3D.instantiate(this.normalHamster)}updateHeart(){0!=Oe.instance.newGuide.isCompleteGuide&&this.createHudHeart()}createHudHeart(){let e=this.getHudHeartHide();if(null==e)return null;let t=this.getNoHeartNormalHamster();return null==t?null:(e.showHeart(t),e)}getHudHeartHide(){if(this.mHUDHeartLogic.length<3){let e=new pt;return e.init(),this.mHUDHeartLogic.push(e),e}for(let e=0;e<this.mHUDHeartLogic.length;e++){const t=this.mHUDHeartLogic[e];if(0==t.isShow)return t}return null}getHudHeartShow(){for(let e=0;e<this.mHUDHeartLogic.length;e++){const t=this.mHUDHeartLogic[e];if(1==t.isShow)return t}return null}getNoHeartNormalHamster(){let e=[];for(let t=0;t<this.allNormalHamsters.length;t++){const i=this.allNormalHamsters[t];let a=!0;for(let e=0;e<this.mHUDHeartLogic.length;e++){if(this.mHUDHeartLogic[e].owner==i){a=!1;break}}a&&e.push(i)}return e.length<=0?null:e[w.random(0,e.length-1)]}onClickTreasure(e){let i=JSON.parse(e.name),a=this.getIslandNormalPointById(i);if(null==a)return void console.log("为什么会没有找到  所在的岛屿呢？  id = "+i);let n=w.random(0,this.allNormalHamsters.length-1),s=this.allNormalHamsters[n],o=new it;o.islandId=i,o.enterPointObjs=a.enterPointObjs,o.slidingPointObjs=a.slidingPointObjs,o.pointObjs.push(e),s.goToTreasure(o),Oe.instance.eventManager.fire(t.treasure_lookHamster,s.owner)}checkBuyHamster(){if(0==Oe.instance.newGuide.isCompleteGuide)return;let e=Oe.instance.userData.mHamsterNormals.length;Oe.instance.userData.getNormalConfgById(e+1).buyCost<=Oe.instance.userData.mHeart?this.mHUDHamsterLogic.show():this.mHUDHamsterLogic.hide()}getManagerPathByName(e){let t=e+"NPCPath";return this.managerPointParent.getChildByName(t)}getHamsterGuide(){let e=this.getHudHeartShow();return null==e&&(e=this.createHudHeart(),console.log("新手引导  18步  获取一个爱心hud == null")),e}}class ft{constructor(){this.maxFieldOfView=45,this.minFieldOfView=8,this.maxZ=-27,this.minZ=-100,this.tempPos=new Laya.Vector3,ft._instance=this}static get instance(){return ft._instance}init(){this.cameraParent=Oe.instance.scene3D.getChildByName("CameraParent"),this.cameraNormal=Oe.instance.scene3D.getChildByName("CameraNormal"),this.cameraNormal.active=!1,this.mainCamera=this.cameraParent.getChildByName("Main Camera"),this.stateMachine=new Ze,this.stateMachine.init(),this.setFieldOfView(30),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.on(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.on(t.ui_buyHamsterCloth,this,this.buyHamsterCloth),Oe.instance.eventManager.on(t.ui_buyHamsterClothComplete,this,this.buyHamsterClothComplete),Oe.instance.eventManager.on(t.logic_unlockManager,this,this.unlockManager),Oe.instance.eventManager.on(t.treasure_lookHamster,this,this.treasureLookHamster),Oe.instance.eventManager.on(t.newGuide_guideBowComplete,this,this.guideBowComplete),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete),Oe.instance.eventManager.on(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.on(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.timeManager.framLoop(this,this.update)}update(){this.stateMachine.update()}scaleCamera(e){let t=this.mainCamera.fieldOfView;t-=.1*e,this.setFieldOfView(t)}setFieldOfView(e){e>this.maxFieldOfView?e=this.maxFieldOfView:e<this.minFieldOfView&&(e=this.minFieldOfView),this.mainCamera.fieldOfView=e}dragCamera(e,t){this.stateMachine.getCurStateIndex()!=a.idle&&this.stateMachine.changeState(a.idle);let i=this.mainCamera.transform.localPosition.x,n=this.mainCamera.transform.localPosition.y,s=this.mainCamera.transform.localPosition.z,o=i+e,r=s+t,h=Laya.MathUtil.lerp(i,o,2*Laya.timer.delta/1e3),l=Laya.MathUtil.lerp(s,r,2*Laya.timer.delta/1e3);this.tempPos.x=h,this.tempPos.y=n,this.tempPos.z=l,this.setCameraPos(this.tempPos)}setCameraPos(e){let t=e.x,i=this.mainCamera.transform.localPosition.y,a=e.z;t>=40&&(t=40),t<=-40&&(t=-40),a>=this.maxZ&&(a=this.maxZ),a<=this.minZ&&(a=this.minZ),this.tempPos.x=t,this.tempPos.y=i,this.tempPos.z=a,this.mainCamera.transform.localPosition=this.tempPos}unlockIsland(e){this.stateMachine.changeState(a.unlock,[e])}upgradeIsland(e){let t=Oe.instance.userData.getIslandInfoById(e);t.islandLevel==y.islandLevel1?this.stateMachine.changeState(a.unlock,[e]):t.islandLevel==y.islandLevel2&&this.stateMachine.changeState(a.unlock,[e])}buyHamster(){let e=wt.instance.getNormalBornPos();this.stateMachine.changeState(a.born,[e])}buyHamsterComplete(){}unlockManager(e){this.stateMachine.changeState(a.unlockNpc,[e])}treasureLookHamster(e){this.stateMachine.changeState(a.look,[e])}guideBowComplete(){this.stateMachine.changeState(a.zoom)}newGuideAllComplete(){this.stateMachine.changeState(a.zoom)}eggBornHamster(e){this.stateMachine.changeState(a.look,[e])}eggBornHamsterComplete(){}buyHamsterCloth(){let e=wt.instance.getClothIslandPos();this.stateMachine.changeState(a.born,[e])}buyHamsterClothComplete(e){this.stateMachine.getCurStateIndex()!=a.idle&&this.stateMachine.changeState(a.look,[e])}}class Ct{constructor(){this.skin="UI/hudEgg2.png",this.skinComplete="UI/hudEgg1.png",this.targetScale=1.2,this.scale=1.2,this.tempPos=new Laya.Vector4,this.tempPos2=new Laya.Vector4,this.tempHudPos=new Laya.Vector3}init(){this.eggObj3D=Oe.instance.scene3D.getChildByName("egg"),this.createImage(),this.createBtn(),this.anim(),this.createParent(),this.createProgress(),this.createGoldImage(),this.createLabel(),0==Oe.instance.newGuide.isCompleteGuide&&(this.image.visible=!1),Oe.instance.timeManager.framLoop(this,this.updatePos),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete)}newGuideAllComplete(){this.image.visible=!0}updatePos(){if(null==this.eggObj3D)return;let e=this.getHudPos(4);ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.image.pos(this.tempPos.x,this.tempPos.y),e=this.getHudPos(5),ft.instance.mainCamera.worldToViewportPoint(e,this.tempPos),this.parent.pos(this.tempPos.x,this.tempPos.y);let t=this.getHudPosLeft();ft.instance.mainCamera.worldToViewportPoint(t,this.tempPos2);let i=Math.abs(this.tempPos2.x-this.tempPos.x);this.btn.width=i,this.btn.height=1.2*i,this.btn.pos(this.tempPos.x,this.tempPos.y)}getHudPos(e){if(null==this.eggObj3D)return;let t=e;return this.tempHudPos.x=this.eggObj3D.transform.position.x,this.tempHudPos.y=this.eggObj3D.transform.position.y+t,this.tempHudPos.z=this.eggObj3D.transform.position.z,this.tempHudPos}getHudPosLeft(){if(null==this.eggObj3D)return;return this.tempHudPos.x=this.eggObj3D.transform.position.x+3,this.tempHudPos.y=this.eggObj3D.transform.position.y,this.tempHudPos.z=this.eggObj3D.transform.position.z,this.tempHudPos}createBtn(){let e=new Laya.Button;e.width=100,e.height=100,e.anchorX=.5,e.anchorY=0,mt.instance.hudSceneParent.addChild(e),e.visible=!0,e.on(Laya.Event.CLICK,this,this.onHudClick),e.alpha=.6,this.btn=e}createImage(){let e=new Laya.Image(this.skin);e.x=0,e.y=0,e.anchorX=.5,e.anchorY=1,this.image=e,mt.instance.hudSceneParent.addChild(this.image),e.visible=!0,this.image.on(Laya.Event.CLICK,this,this.onHudClick)}anim(){Laya.Tween.to(this.image,{scaleX:this.targetScale,scaleY:this.targetScale},500,null,Laya.Handler.create(this,function(){this.targetScale==this.scale?this.targetScale=1:this.targetScale=this.scale,this.anim()}))}onHudClick(){Oe.instance.scenesManager.openScene(y.EggView,Laya.Handler.create(this,function(e){}),!1)}showIdle(){this.image.skin=this.skin,this.image.visible=!0,this.parent.visible=!1}showCompelte(){this.image.skin=this.skinComplete,this.image.visible=!0,this.parent.visible=!1}showDoing(e){let t=y.eggTotalTime;Oe.instance.userData.mIsFirstEgg&&(t=y.firstEggTotalTime);let i=e/t;this.timeLabel.text=w.convertTime(e),this.progress.value=i,this.image.visible=!1,this.parent.visible=!0}hideHud(){this.image.visible=!1,this.parent.visible=!1}createParent(){this.parent=new Laya.Box,this.parent.width=1,this.parent.height=1,this.parent.scaleX=1,this.parent.scaleY=1,this.parent.anchorX=0,this.parent.anchorY=1,mt.instance.hudSceneParent.addChild(this.parent),this.parent.visible=!0}createProgress(){this.progress=new Laya.ProgressBar("UI/missionProgress.png"),this.progress.anchorX=.5,this.progress.anchorY=.5,this.progress.width=170,this.progress.height=34,this.progress.pos(0,0),this.parent.addChild(this.progress),this.progress.visible=!0}createLabel(){let e=new Laya.Label;e.font="Microsoft YaHei",e.fontSize=18,e.bold=!0,e.color="#ffffff",e.anchorX=.5,e.anchorY=.5,e.x=0,e.y=0,e.stroke=2,e.pos(10,0),this.parent.addChild(e),this.timeLabel=e,this.timeLabel.visible=!0}createGoldImage(){let e=new Laya.Image("UI/bgTimeIcon.png");e.width=45,e.height=45,e.x=-80,e.y=0,e.anchorX=.5,e.anchorY=.5,this.parent.addChild(e),e.visible=!0}}class yt{constructor(){this.time=0,yt._instance=this}static get instance(){return yt._instance}init(){let e=Oe.instance.scene3D.getChildByName("egg").getChildByName("Effects");this.eggDoingEffect=e.getChildByName("doing"),this.eggDoingEffect.active=!1,this.time=Oe.instance.userData.eggInfo.time,this.eggState=Oe.instance.userData.eggInfo.state,this.hudLogic=new Ct,this.hudLogic.init(),this.initStateInfo(),Oe.instance.timeManager.loop(1,this,this.update),Oe.instance.eventManager.on(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete)}newGuideAllComplete(){this.initHudState()}initHudState(){this.eggState==d.idle?(this.eggDoingEffect.active=!1,this.hudLogic.showIdle()):this.eggState==d.doing?(this.eggDoingEffect.active=!0,this.hudLogic.showDoing(this.time)):this.eggState==d.wait&&(this.eggDoingEffect.active=!0,this.hudLogic.showCompelte())}initStateInfo(){if(0==Oe.instance.newGuide.isCompleteGuide)return this.eggDoingEffect.active=!1,void this.hudLogic.hideHud();this.initHudState()}update(){if(this.eggState===d.doing){if(this.time-=1,this.time<=0||this.time%5==0){if(this.time<=0)return this.time=0,this.eggState=d.wait,Oe.instance.userData.setEggInfo(this.eggState,this.time),void this.hudLogic.showCompelte();Oe.instance.userData.setEggInfo(this.eggState,this.time)}this.hudLogic.showDoing(this.time)}}startDoing(){if(this.eggState!=d.idle)return;this.eggState=d.doing;let e=y.eggTotalTime;Oe.instance.userData.mIsFirstEgg&&(e=y.firstEggTotalTime),this.time=e,Oe.instance.userData.setStartEgg(this.time),this.initHudState()}complte(){this.eggState=d.wait,this.time=0,Oe.instance.userData.setEggInfo(this.eggState,this.time),this.initHudState()}reduceTime(e){this.time-=e,this.time<=0&&(this.time=0),Oe.instance.userData.setEggInfo(this.eggState,this.time)}getHamster(){let e=this.randomHamsterId();Oe.instance.userData.buyHamsterCloth(e),Oe.instance.userData.mIsFirstEgg&&Oe.instance.userData.setIsFirstEgg(),wt.instance.eggHamster(e),this.eggState=d.idle,this.time=0,Oe.instance.userData.setEggInfo(this.eggState,this.time),this.hudLogic.showIdle(),Oe.instance.soundManager.playSound("sound/eggFly.mp3")}eggBornHamsterComplete(){this.eggState=d.idle,this.time=0,this.initHudState()}randomHamsterId(){let e=w.random(1,100);return e<=70?4:e<=75?1:e<=85?2:e<=88?3:e<=98?5:e<=100?6:void 0}}class Bt extends e.EggViewUI{constructor(){super(),this.remainTime=0,this.isClickShareBtn=!1}onEnable(){this.init()}onDisable(){}init(){this.initObj(),this.showInfo(),Oe.instance.timeManager.loop(1,this,this.update),Oe.instance.timeManager.framLoop(this,this.framLoopUpdate)}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.startBtn.on(Laya.Event.CLICK,this,this.onStartBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onGetBtnClick),this.diamondBtn.on(Laya.Event.CLICK,this,this.onDiamondBtnClick),this.timeBtn.on(Laya.Event.CLICK,this,this.onTimeBtnClick)}showInfo(){this.startBtn.visible=!1,this.getBtn.visible=!1,this.diamondBtn.visible=!1,this.timeBtn.visible=!1;let e=yt.instance.eggState;e==d.idle?(this.startBtn.visible=!0,this.progressLabel.text="孵化仓鼠，准备就绪！",this.timeProgress.value=0):e==d.doing?(this.diamondBtn.visible=!0,this.timeBtn.visible=!0,this.update()):e==d.wait&&(this.getBtn.visible=!0,this.timeProgress.value=1,this.progressLabel.text="孵化完成，请领取！")}framLoopUpdate(){yt.instance.eggState===d.doing&&(this.lightBg.rotation+=1)}update(){if(yt.instance.eggState!==d.doing)return void(this.lightBg.rotation=0);this.progressLabel.visible=!0;let e=yt.instance.time;this.remainTime=e;let t=y.eggTotalTime,i=y.eggTotalDiamond;Oe.instance.userData.mIsFirstEgg&&(t=y.firstEggTotalTime,i=y.firstEggTotalDiamond);let a=e/t;this.progressLabel.text=w.convertTime(e),this.timeProgress.value=a;let n=a*i;this.costDiamond=Math.ceil(n),this.diamondLabel.text=this.costDiamond.toString()}onStartBtnClick(){yt.instance.startDoing(),this.showInfo(),w.aldEventByType(c.data_eggStart)}onGetBtnClick(){yt.instance.getHamster(),this.close(),w.aldEventByType(c.data_eggEnd)}onDiamondBtnClick(){if(this.costDiamond>Oe.instance.userData.mDiamond)return Oe.instance.eventManager.fire(t.diamondNotEnough),void w.showNoticeLabel("钻石不足");Oe.instance.userData.subDiamond(this.costDiamond),yt.instance.complte(),this.showInfo()}onCloseBtnClick(){this.close()}onTimeBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t&&e.adSuccess()})}adSuccess(){this.remainTime<=9e3?(yt.instance.complte(),this.showInfo()):yt.instance.reduceTime(9e3)}}class Lt extends e.HamsterViewUI{constructor(){super(),this.goldCost=0,this.heartCost=0}onEnable(){this.openUIAnim(),this.init(),Oe.instance.eventManager.fire(t.ui_openHamsterView)}onDisable(){Oe.instance.eventManager.fire(t.ui_closeHamsterView),Oe.instance.eventManager.off(t.updateGold,this,this.updateGold),Oe.instance.eventManager.off(t.newGuide_Click,this,this.newGuideClick)}init(){this.initObj(),this.showInfo(),this.showHamster(),Oe.instance.eventManager.on(t.updateGold,this,this.updateGold),0==Oe.instance.newGuide.isCompleteGuide&&Oe.instance.eventManager.on(t.newGuide_Click,this,this.newGuideClick)}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.upgradeBtn.on(Laya.Event.CLICK,this,this.onUpgradeBtnClick),this.buyBtn.on(Laya.Event.CLICK,this,this.onBuyBtnClick)}updateGold(){this.showInfo()}newGuideClick(e){21==e&&this.onBuyBtnClick()}showInfo(){let e=Oe.instance.userData.mHamsterLevel,t=Oe.instance.userData.mHamsterNormals.length;this.hamsterCount.text=t+"/30",this.hamsterLevel.text=e+"/999";let i=Oe.instance.userData.getHeartProduce();this.produceLabel.text=w.convert(i);let a=500*Math.pow(y.upgradeHeartCostFactor,e-1);this.goldCost=a;let n=w.convert(a);this.upgradeBtn.label=n,this.upgradeCost.text=n,a<=Oe.instance.userData.mGold?(this.upgradeBtn.visible=!0,this.upgradeCost.visible=!1):(this.upgradeBtn.visible=!1,this.upgradeCost.visible=!0);let s=i*(y.upgradeHeartProduceFactor-1);this.upgradeDesc.text="+"+w.convert(s);let o=Oe.instance.userData.getNormalConfgById(t+1).buyCost;this.heartCost=o;let r=w.convert(o);this.buyBtn.label=r,this.buyCost.text=r,o<=Oe.instance.userData.mHeart?(this.buyCost.visible=!1,this.buyBtn.visible=!0):(this.buyCost.visible=!0,this.buyBtn.visible=!1)}showHamster(){let e=ft.instance.cameraNormal;e.active=!0;e.renderTarget=new Laya.RenderTexture(356,256),e.clearFlag=Laya.CameraClearFlags.DepthOnly;var t=new Laya.Texture(e.renderTarget,Laya.Texture.DEF_UV);this.hamsterSprite.graphics.drawTexture(t)}onUpgradeBtnClick(){this.goldCost>Oe.instance.userData.mGold||(Oe.instance.userData.subGold(this.goldCost),Oe.instance.userData.upgradeHamsterNormal(),this.showInfo(),w.aldEventByTypeParam(c.data_upgradeHamster,Oe.instance.userData.mHamsterLevel.toString(),Oe.instance.userData.mHamsterLevel.toString()))}onBuyBtnClick(){if(this.heartCost>Oe.instance.userData.mHeart)return void console.log("爱心不够");let e=Oe.instance.userData.mHamsterNormals.length+1;Oe.instance.userData.buyHamsterNormal(e),Oe.instance.eventManager.fire(t.ui_buyHamster,e),w.aldEventByTypeParam(c.data_buyHamster,e.toString(),e.toString()),this.closeUIAnim()}onCloseBtnClick(){this.closeUIAnim()}doCloseUI(){ft.instance.cameraNormal.active=!1,this.close()}closeUIAnim(){Laya.Tween.to(this.animRootBox,{x:400},200,null,Laya.Handler.create(this,this.doCloseUI))}openUIAnim(){Laya.Tween.to(this.animRootBox,{x:-50},200,null,Laya.Handler.create(this,function(){Laya.Tween.to(this.animRootBox,{x:0},100,null,Laya.Handler.create(this,function(){}))}))}}class At extends e.LoadingViewUI{constructor(){super(),this.allLoadCount=0,this.curLoadCount=0,this.isLoading=!1,this.loadTime=0,this.loadTime2=0,this.allloads=[],this.subLoadCount=0}onAwake(){}onEnable(){this.init()}onDisable(){Oe.instance.timeManager.clearAll(this)}init(){this.loadTime=0,this.loadTime2=0,Oe.instance.timeManager.framLoop(this,this.updateProgress),Oe.instance.userData.loadCache(),this.loadConfig(),this.loadRes(),this.isLoading=!0,w.aldEventByType(c.data_loadGameStart),Oe.instance.timeManager.loop(1,this,this.testLoadTime),Oe.instance.ad.showBannerAd(this)}testLoadTime(){this.loadTime2++,this.loadTime2>=20&&(this.loadTime2=20);let e=this.loadTime2;w.aldEventByTypeParam2(c.data_loadGameTimeTest,e.toString(),e.toString())}updateProgress(){if(!this.isLoading)return;let e=0,t=!0;for(let i=0;i<this.allloads.length;i++){const a=this.allloads[i];e+=a.curProgress,0==a.isComplete&&(t=!1)}let i=0,a=this.curLoadCount+e;this.allLoadCount>0&&(i=a/this.allLoadCount),i=i>1?1:i,this.progressNum.text=Math.floor(100*i)+"%",this.loadTime+=.001*Laya.timer.delta,this.allLoadCount<=a&&t&&(this.isLoading=!1,this.allLoadComplete(),Oe.instance.timeManager.clear(this,this.testLoadTime),0==Oe.instance.isSubPackageLoadCompleteHamster&&Oe.instance.loadSubpackageAsyn(),0==Oe.instance.isSubPackageLoadCompleteNpc&&Oe.instance.loadSubpackageAsynNpc(),Oe.instance.soundManager.loadSound())}updateProgress2(){if(!this.isLoading)return;let e=0;this.allLoadCount>0&&(e=this.curLoadCount/this.allLoadCount),e=e>1?1:e,this.progressNum.text=Math.floor(100*e)+"%",this.loadTime+=.001*Laya.timer.delta,this.allLoadCount<=this.curLoadCount&&(this.isLoading=!1,this.allLoadComplete(),Oe.instance.timeManager.clear(this,this.testLoadTime))}allLoadComplete(){this.startLoadScene3D()}loadRes(){w.getPlatformType()!==s.tt&&(Laya.Browser.onMiniGame||Laya.Browser.onQQMiniGame)&&this.startLoadSubpackage(),Laya.Browser.onVVMiniGame?(Oe.instance.isSubPackageLoadCompleteHamster=!0,Oe.instance.isSubPackageLoadCompleteNpc=!0,this.startLoadSubpackage_vivo()):(Oe.instance.isSubPackageLoadCompleteHamster=!0,Oe.instance.isSubPackageLoadCompleteNpc=!0)}startLoadSubpackage_vivo(){this.allLoadCount+=30,this.allLoadCount+=30;let e=new Dt;e.loadName="unity",this.doLoadSubpackage2(e),this.allloads.push(e),(e=new Dt).loadName="hamsters",this.doLoadSubpackage2(e),this.allloads.push(e)}startLoadSubpackage(){this.allLoadCount+=30,this.allLoadCount+=30,this.allLoadCount+=30,this.allLoadCount+=30,this.allLoadCount+=30;let e=new Dt;e.loadName="res",this.doLoadSubpackage2(e),this.allloads.push(e),(e=new Dt).loadName="unity",this.doLoadSubpackage2(e),this.allloads.push(e),(e=new Dt).loadName="normalTex",this.doLoadSubpackage2(e),this.allloads.push(e),(e=new Dt).loadName="hamsters1",this.doLoadSubpackage2(e),this.allloads.push(e),(e=new Dt).loadName="clothHamster",this.doLoadSubpackage2(e),this.allloads.push(e),0==Oe.instance.newGuide.isCompleteGuide&&(this.allLoadCount+=30,(e=new Dt).loadName="cg",this.doLoadSubpackage2(e),this.allloads.push(e)),this.loadHamsterPackage()}loadHamsterPackage(){}doLoadSubpackage2(e){if(Laya.Browser.onQQMiniGame);else if(Laya.Browser.onMiniGame){wx.loadSubpackage({name:e.loadName,success:function(t){e.curProgress=e.tatal,e.isComplete=!0,console.log("111111111111111111")},fail:function(e){}}).onProgressUpdate(function(t){e.curProgress=t.progress*e.tatal,e.curProgress>e.tatal&&(e.curProgress=e.tatal)})}else if(Laya.Browser.onVVMiniGame){qg.loadSubpackage({name:e.loadName,success:function(t){e.curProgress=e.tatal,e.isComplete=!0},fail:function(e){},complete:function(){}}).onProgressUpdate(t=>{e.curProgress=t.progress*e.tatal,e.curProgress>e.tatal&&(e.curProgress=e.tatal)})}}doLoadSubpackage(e,t){let i=this;if(Laya.Browser.onQQMiniGame){qq.loadSubpackage({name:e,success:function(e){i.curLoadCount+=30,t&&t()},fail:function(e){}})}else if(Laya.Browser.onMiniGame){wx.loadSubpackage({name:e,success:function(e){i.curLoadCount+=30,t&&t(),console.log("111111111111111111")},fail:function(e){}}).onProgressUpdate(function(e){})}}startLoadScene3D(){Oe.instance.scenesManager.loadScene3D(y.battleScenePath,Laya.Handler.create(this,this.loadScene3DComplete))}loadScene3DComplete(e){Oe.instance.setScene3D(e),Oe.instance.scene3D.addComponent(mt),this.stageLoadComplete()}stageLoadComplete(){console.log("关卡资源加载完成"),w.aldEventByType(c.data_loadGameComplete),this.loadTime=Math.floor(this.loadTime),w.aldEventByTypeParam2(c.data_loadGameTime,this.loadTime.toString(),this.loadTime.toString()),0==Oe.instance.newGuide.isCompleteGuide?Oe.instance.scenesManager.openScene(y.NewGuideView,Laya.Handler.create(this,function(e){})):Oe.instance.scenesManager.openScene(y.MainView,Laya.Handler.create(this,function(e){Oe.instance.setSceneUI(e)}))}loadConfig(){this.load("config/IslandConfig.json",function(e){Oe.instance.userData.loadIslandConfig(e)}),this.load("config/NormalConfig.json",function(e){Oe.instance.userData.loadNormalConfig(e)}),this.load("config/MissionConfig.json",function(e){Oe.instance.userData.loadMissionConfig(e)}),this.load("config/AchievementConfig.json",function(e){Oe.instance.userData.loadAchievementConfig(e)}),this.load("config/ClothHamsterConfig.json",function(e){Oe.instance.userData.loadClothHamsterConfig(e)})}load(e,t){this.allLoadCount++;let i=this;Oe.instance.loadManager.load(e,function(e){t(e),i.curLoadCount++})}playCg(){if(w.getPlatformType()!==s.tt&&(Laya.Browser.onMiniGame||Laya.Browser.onQQMiniGame)){wx.createVideo({x:0,y:0,width:Laya.stage.width,height:Laya.stage.height,src:"cg/cg.mp4",autoplay:!0}).play()}}}class Dt{constructor(){this.curProgress=0,this.tatal=30,this.isComplete=!1}}class bt extends e.ShopViewUI{constructor(){super(),this.rewardNum=0,this.aldType="",this.isShowAd=!0,this.isClickShareBtn=!1}onEnable(){this.init(),this.pos(0,0),this.width=Laya.stage.width}onDisable(){}init(){this.initObj(),this.showInfo(),this.isShowAd,this.closeBtn.visible=!1,Oe.instance.timeManager.onceExecute(2,this,this.delayShowCloseBtn)}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.adBtn.on(Laya.Event.CLICK,this,this.onAdBtnClick)}delayShowCloseBtn(){this.closeBtn.visible=!0}showInfo(){this.goldBg.visible=!1,this.diamondBg.visible=!1,this.heartBg.visible=!1,this.diamondTitle.visible=!1,this.title2.visible=!1,this.title3.visible=!1;let e=0;switch(this.rewardType){case r.heart:this.bg.skin="UI/bg12.png",this.icon.skin="UI/heartBg3.png";let t=Oe.instance.userData.getHeartProduce();this.rewardNum=12*t*60,this.heartBg.visible=!0,this.title2.visible=!0,this.title3.visible=!0,this.title2.text="爱心礼包",e=Oe.instance.userData.mFreeHeartTimes,this.aldType="爱心";break;case r.diamond:this.bg.skin="UI/bg11.png",this.icon.skin="UI/diamondBg2.png",this.rewardNum=100,this.diamondBg.visible=!0,this.diamondTitle.visible=!0,e=Oe.instance.userData.mFreeDiamondTimes,this.aldType="钻石";break;case r.gold:this.bg.skin="UI/bg10.png",this.icon.skin="UI/goldBg2.png";let i=Oe.instance.userData.getGoldTotalProduce();this.rewardNum=60*i*60,this.goldBg.visible=!0,this.title2.visible=!0,this.title3.visible=!0,this.title2.text="金币礼包",e=Oe.instance.userData.mFreeGoldTimes,this.aldType="金币"}this.rewardLabel.text=w.convert(this.rewardNum),this.adBtn.disabled=e<=0,this.times.text="今日剩余次数:"+e}adSuccess(){switch(this.rewardType){case r.heart:Oe.instance.userData.addHeart(this.rewardNum),Oe.instance.userData.setFreeHeartTimes(Oe.instance.userData.mFreeHeartTimes-1);break;case r.diamond:Oe.instance.userData.addDiamond(this.rewardNum),Oe.instance.userData.setFreeDiamondTimes(Oe.instance.userData.mFreeDiamondTimes-1);break;case r.gold:Oe.instance.userData.addGold(this.rewardNum),Oe.instance.userData.setFreeGoldTimes(Oe.instance.userData.mFreeGoldTimes-1)}w.playRewardEffect(this.rewardType),this.showInfo()}onAdBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adSuccess(),w.statisticsData(c.ad_freeReward+e.aldType,!0)):w.statisticsData(c.ad_freeReward+e.aldType,!1)})}onCloseBtnClick(){this.close()}}class Nt extends e.TopDialogUI{constructor(){super()}onEnable(){this.x=0,this.y=0,this.init()}onDisable(){Oe.instance.eventManager.off(t.updateGold,this,this.showGoldInfo),Oe.instance.eventManager.off(t.updateHamsterCount,this,this.showHamsterCount),Oe.instance.eventManager.off(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.off(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.off(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.off(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.off(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.off(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.off(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.eventManager.off(t.newGuide_Start,this,this.newGuideStart),Oe.instance.eventManager.off(t.newGuide_allComplete,this,this.newGuideAllComplete),Oe.instance.eventManager.off(t.diamondNotEnough,this,this.diamondNotEnough),Oe.instance.eventManager.off(t.goldNotEnough,this,this.goldNotEnough)}init(){this.initObj(),this.showGoldInfo(),this.showHamsterCount(),Oe.instance.eventManager.on(t.updateGold,this,this.showGoldInfo),Oe.instance.eventManager.on(t.updateHamsterCount,this,this.showHamsterCount),Oe.instance.eventManager.on(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.on(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.on(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.on(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.on(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.eventManager.on(t.newGuide_Start,this,this.newGuideStart),Oe.instance.eventManager.on(t.newGuide_allComplete,this,this.newGuideAllComplete),Oe.instance.eventManager.on(t.diamondNotEnough,this,this.diamondNotEnough),Oe.instance.eventManager.on(t.goldNotEnough,this,this.goldNotEnough)}initObj(){this.heartBtn.on(Laya.Event.CLICK,this,this.onHeartBtnClick),this.goldBtn.on(Laya.Event.CLICK,this,this.onGoldBtnClick),this.diamondBtn.on(Laya.Event.CLICK,this,this.onDiamondBtnClick)}newGuideStart(){this.topBox.visible=!1}newGuideAllComplete(){this.topBox.visible=!0}showGoldInfo(){this.goldBtn.label=w.convert(Oe.instance.userData.mGold),this.heartBtn.label=w.convert(Oe.instance.userData.mHeart),this.diamondBtn.label=w.convert(Oe.instance.userData.mDiamond)}showHamsterCount(){let e=Oe.instance.userData.mHamsterNormals.length+Oe.instance.userData.mHamsterCloths.length;this.hamsterLabel.text=e.toString()}eggBornHamster(){this.hideUI()}eggBornHamsterComplete(){this.showUI()}buyHamster(){this.hideUI()}unlockIsland(){this.hideUI()}buyHamsterComplete(){this.showUI()}unlockIslandComplete(){this.showUI()}upgradeIsland(e){let t=Oe.instance.userData.getIslandInfoById(e);t.islandLevel!=y.islandLevel1&&t.islandLevel!=y.islandLevel2||this.hideUI()}showUI(){Laya.Tween.to(this.topBox,{y:0},300,null,Laya.Handler.create(this,function(){}))}hideUI(){Laya.Tween.to(this.topBox,{y:-180},300,null,Laya.Handler.create(this,function(){}))}onHeartBtnClick(){let e=new bt;e.rewardType=r.heart,e.show(!1,!1)}onGoldBtnClick(){this.showGoldShop(!0)}onDiamondBtnClick(){let e=new bt;e.rewardType=r.diamond,e.show(!1,!1)}diamondNotEnough(){this.onDiamondBtnClick()}goldNotEnough(e=!0){this.showGoldShop(e)}showGoldShop(e=!0){let t=new bt;0==e&&(t.isShowAd=!1),t.rewardType=r.gold,t.show(!1,!1)}}class kt extends e.SignViewUI{constructor(){super(),this.closeCallBack=null,this.againRewardNum=0,this.isClickShareBtn=!1}onEnable(){this.init(),this.pos(0,0),this.width=Laya.stage.width}onDisable(){}init(){this.initObj(),this.secondBox.visible=!1,this.showInfo()}initObj(){this.adBtn.on(Laya.Event.CLICK,this,this.onAdBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.adAgainBtn.on(Laya.Event.CLICK,this,this.onAdAgainBtnClick),this.noThankBtn.on(Laya.Event.CLICK,this,this.onNoThankBtnClick)}showInfo(){let e=Oe.instance.userData.mSignTimes;Oe.instance.userData.mIsSign&&(this.adBtn.label="明日再来",this.adBtn.disabled=!0);for(let t=1;t<=7;t++){const i=this.signBox.getChildByName("getBg"+t);i.visible=!1,t-1<e?i.visible=!0:t-1==e&&(Oe.instance.userData.mIsSign?i.visible=!0:i.visible=!1)}}onAdBtnClick(){let e=Oe.instance.userData.mSignTimes,i=0;0==e?(i=50,this.showAgainInfo(i)):1==e?(Oe.instance.userData.buyHamsterCloth(3),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,3)):e>=2&&e<=5?(i=100*e,this.showAgainInfo(i)):6==e&&(i=100*e,Oe.instance.userData.buyHamsterCloth(2),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,2)),0!=i&&(Oe.instance.userData.addDiamond(i),w.playRewardEffect(r.diamond)),Oe.instance.userData.sign(),this.showInfo(),1!=e&&6!=e||this.onCloseBtnClick()}showAgainInfo(e){this.againNumLabel.text=e.toString(),this.secondBox.visible=!0,this.againRewardNum=e}onAdAgainBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t&&e.adSuccess()})}adSuccess(){Oe.instance.userData.addDiamond(this.againRewardNum),w.playRewardEffect(r.diamond),this.onCloseBtnClick()}onNoThankBtnClick(){this.onCloseBtnClick()}onCloseBtnClick(){this.close(),this.closeCallBack&&this.closeCallBack()}}class Pt extends e.MainViewUI{constructor(){super(),this.isCanShowBottomNotice=!0,this.isClickShareBtn=!1,this.isShowLimitTimeGift=!1,this.tatalTime=20,this.curTime=0,this.isPlayMissioning=!1,this.isOpenSignView=!1}onEnable(){this.parent.mouseThrough=!0,this.init()}onDisable(){Oe.instance.eventManager.off(t.updateGold,this,this.showGoldInfo),Oe.instance.eventManager.off(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.off(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.off(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.off(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.off(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.off(t.ui_openUpgradeIslandView,this,this.openUpgradeIslandView),Oe.instance.eventManager.off(t.ui_closeUpgradeIslandView,this,this.closeUpgradeIslandView),Oe.instance.eventManager.off(t.ui_openHamsterView,this,this.openHamsterView),Oe.instance.eventManager.off(t.ui_closeHamsterView,this,this.closeHamsterView),Oe.instance.eventManager.off(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.off(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.eventManager.off(t.gift_get,this,this.giftGet),Oe.instance.eventManager.off(t.mission_get,this,this.missionGet),Oe.instance.eventManager.off(t.ui_closeAchievementView,this,this.closeAchievementView),Oe.instance.eventManager.off(t.ui_openAchievementView,this,this.openAchievementView),Oe.instance.eventManager.off(t.vivo_ad_reportClick,this,this.vivoAdReportClick),Oe.instance.eventManager.off(t.signComplete,this,this.signComplete),Oe.instance.timeManager.clear(this,this.showIconAd)}init(){this.initObj(),this.showGoldInfo(),this.isCanShowBottomNotice=!0,w.getPlatformType()==s.wx||w.getPlatformType()==s.qq||w.getPlatformType()==s.oppo||w.getPlatformType()==s.vivo||(w.getPlatformType(),s.tt),this.showBottomNotice(),this.showTopWidget(),this.initNewGift(),Oe.instance.eventManager.on(t.updateGold,this,this.showGoldInfo),Oe.instance.eventManager.on(t.ui_buyHamster,this,this.buyHamster),Oe.instance.eventManager.on(t.ui_unlockIsland,this,this.unlockIsland),Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete),Oe.instance.eventManager.on(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.on(t.ui_upgradeIsland,this,this.upgradeIsland),Oe.instance.eventManager.on(t.ui_openUpgradeIslandView,this,this.openUpgradeIslandView),Oe.instance.eventManager.on(t.ui_closeUpgradeIslandView,this,this.closeUpgradeIslandView),Oe.instance.eventManager.on(t.ui_openHamsterView,this,this.openHamsterView),Oe.instance.eventManager.on(t.ui_closeHamsterView,this,this.closeHamsterView),Oe.instance.eventManager.on(t.egg_bornHamster,this,this.eggBornHamster),Oe.instance.eventManager.on(t.egg_bornHamsterComplete,this,this.eggBornHamsterComplete),Oe.instance.eventManager.on(t.gift_get,this,this.giftGet),Oe.instance.eventManager.on(t.mission_get,this,this.missionGet),Oe.instance.eventManager.on(t.ui_openAchievementView,this,this.openAchievementView),Oe.instance.eventManager.on(t.ui_closeAchievementView,this,this.closeAchievementView),Oe.instance.eventManager.on(t.vivo_ad_reportClick,this,this.vivoAdReportClick),Oe.instance.eventManager.on(t.signComplete,this,this.signComplete),Oe.instance.timeManager.loop(1,this,this.update),this.update(),this.checkGuide(),this.showMissionInfo(),this.ShowSignInfo(),this.showOfflineView(),this.showIconAd(),Oe.instance.timeManager.loop(30,this,this.showIconAd),this.initLimitTimeGift()}initObj(){this.islandBtn.on(Laya.Event.CLICK,this,this.onIslandBtnClick),this.hamsterBtn.on(Laya.Event.CLICK,this,this.onHamsterBtnClick),this.achievementBtn.on(Laya.Event.CLICK,this,this.onAchievementBtnClick),this.pandaBtn.on(Laya.Event.CLICK,this,this.onPandaBtnClick),this.clothBtn.on(Laya.Event.CLICK,this,this.onClothBtnClick),this.missionBox.on(Laya.Event.CLICK,this,this.onMissionBoxClick),this.signBtn.on(Laya.Event.CLICK,this,this.onSignBtnClick),this.topIconAdAnim.on(Laya.Event.CLICK,this,this.onAdIconClick),this.limitTimeGift.on(Laya.Event.CLICK,this,this.onShowLimitTimeGiftClick)}signComplete(){this.signRedPoint.visible=!1}limitAdSuccess(){1==this.limitTimeType?this.getHamster(this.limitTimeId):2==this.limitTimeType?(Oe.instance.userData.addHeart(this.limitTimeId),w.playRewardEffect(r.heart)):3==this.limitTimeType?(Oe.instance.userData.addGold(this.limitTimeId),w.playRewardEffect(r.gold)):4==this.limitTimeType&&(Oe.instance.userData.addDiamond(this.limitTimeId),w.playRewardEffect(r.diamond)),this.hideLimitTimeGift()}onShowLimitTimeGiftClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t&&e.limitAdSuccess()})}initLimitTimeGift(){let e=new Laya.Sprite;this.limitTimeGiftMaskBox.addChild(e),e.pos(0,0),e.scale(.9,.9),e.graphics.drawTexture(Laya.loader.getRes("UI/bg19.png"),0,0);let t=new Laya.Sprite;t.graphics.drawPie(65,65,200,-18,270,"#ff0000"),e.mask=t,this.limitTimeMask=t,Oe.instance.timeManager.framLoop(this,this.updateLimitTimeGift),this.isShowLimitTimeGift=!1,this.showLimitTimeGift()}showLimitTimeGift(){this.isShowLimitTimeGift=!0,this.limitTimeGift.visible=!0,this.curTime=0;let e=w.random(1,5);if(this.limitTimeType=e,1==e||5==e){let e=Oe.instance.userData.getClothHamsterConfigs(),t=w.random(1,e.length);this.limitTimeId=t;let i=Oe.instance.userData.getClothHamsterConfigById(t);this.timeGiftIcon.skin="UI/"+i.icon+".png",this.limitLabel.text=i.hamsterName+"x1"}else if(2==e){this.timeGiftIcon.skin="UI/heartBg3.png";let e=Oe.instance.userData.getHeartProduce();this.limitTimeId=12*e*60,this.limitLabel.text=w.convert(this.limitTimeId)}else if(3==e){this.timeGiftIcon.skin="UI/goldBg2.png";let e=Oe.instance.userData.getGoldTotalProduce();this.limitTimeId=60*e*60,this.limitLabel.text=w.convert(this.limitTimeId)}else 4==e&&(this.timeGiftIcon.skin="UI/diamondBg2.png",this.limitTimeId=100,this.limitLabel.text="X100")}hideLimitTimeGift(){this.limitTimeGift.visible=!1,this.isShowLimitTimeGift=!1;let e=this;Oe.instance.timeManager.onceExecute(30,this,function(){e.showLimitTimeGift()})}getHamster(e){Oe.instance.userData.buyHamsterCloth(e),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,e)}updateLimitTimeGift(){if(!this.isShowLimitTimeGift)return;if(this.limitTimeMask,this.curTime+=.001*Laya.timer.delta,this.tatalTime-this.curTime<=0)return void this.hideLimitTimeGift();let e=360*(this.curTime/this.tatalTime);this.limitTimeMask.graphics.clear(),this.limitTimeMask.graphics.drawPie(65,65,200,-90+e,270,"#ff0000"),this.limitTimeGift.visible=!0}giftGet(){this.initNewGift()}initNewGift(){Oe.instance.userData.mNewGiftAdTimes>=1?(this.missionBox.y=this.pandaBtn.y,this.pandaBtn.visible=!1):(this.pandaBtn.visible=!0,this.playNewGiftNew())}playNewGiftNew(){Laya.Tween.to(this.pandaBtn,{scaleX:1.1,scaleY:1.1},1e3,null,Laya.Handler.create(this,function(){Laya.Tween.to(this.pandaBtn,{scaleX:1,scaleY:1},1e3,null,Laya.Handler.create(this,function(){this.playNewGiftNew()}))}))}ShowSignInfo(){var e=localStorage.getItem("newUserSign");null!=e&&""!=e?0==Oe.instance.userData.mIsSign?(Oe.instance.timeManager.onceExecute(2,this,this.showSignView),this.signRedPoint.visible=!0):this.signRedPoint.visible=!1:localStorage.setItem("newUserSign","newUserSign")}showOfflineView(){Oe.instance.userData.offlineTime<=60||Oe.instance.timeManager.onceExecute(2,this,function(){Oe.instance.scenesManager.openScene(y.OfflineRewardView,Laya.Handler.create(this,function(e){}),!1)})}missionGet(){this.showMissionInfo()}showMissionInfo(){this.updateMission()}onMissionBoxClick(){Oe.instance.scenesManager.openScene(y.MissionView,Laya.Handler.create(this,function(e){}),!1)}checkGuide(){}showGuideUI(e){}showTopWidget(){(new Nt).show(!1,!1)}showGoldInfo(){this.showBottomNotice()}updateMission(){let e=dt.instance.getMissionProgress(),t=dt.instance.getTotalCount(),i=dt.instance.getCurConfig();this.missionDesc.text=i.simpleDesc+"\n("+e+"/"+t+")",e>=t?(this.missionDesc.color="#66ff5d",this.playMissionAnim()):(this.missionDesc.color="#ffffff",this.stopMissionAnim())}playMissionAnim(){this.isPlayMissioning||(this.isPlayMissioning=!0,this.missionAnim.play())}stopMissionAnim(){this.isPlayMissioning&&(this.isPlayMissioning=!1,this.missionAnim.stop())}update(){this.updateMission();let e=Ue.instance.getRemainDoubleTime();e<=0?this.doubleBox.visible=!1:(this.doubleBox.visible=!0,this.doubleTimeLabel.text=w.convertTime(e))}onIslandBtnClick(){Oe.instance.scenesManager.openScene(y.UpgradeIslandView,Laya.Handler.create(this,function(e){}),!1)}onHamsterBtnClick(){Oe.instance.scenesManager.openScene(y.HamsterView,Laya.Handler.create(this,function(e){}),!1)}showBottomNotice(){if(this.lockItemBox.visible=!1,this.upgradeBox.visible=!1,!this.isCanShowBottomNotice)return;let e=this.checkUnlock();if(null!=e){this.lockItemBox.visible=!0;let t=Oe.instance.userData.getIslandConfigById(e.islandId);return this.lockIslandIcon.skin="UI/"+t.islandIcon+".png",this.lockIslandName.text=t.islandName,this.unlockIslandBtn.label=w.convert(t.upgradeIslandCost),void this.unlockIslandBtn.on(Laya.Event.CLICK,this,this.onUnlockBtnClick,[t])}let t=this.checkIslandUpgrade();if(null!=t){this.upgradeBox.visible=!0;let e=Oe.instance.userData.getIslandConfigById(t.islandId),i=Oe.instance.userData.getIslandOutputGoldByCfg(e,t.islandLevel,t.managerLevel),a=(e.goldOutputFactor-1)*i;this.upgradeGoldDesc.text="+"+w.convert(a),this.upgradeIslandLevel.text="Lv."+t.islandLevel,this.upgradeIslandName.text=e.islandName+"  升级";let n=e.upgradeIslandCost*Math.pow(e.goldCostFactor,t.islandLevel-1);return this.upgradeBtn.on(Laya.Event.CLICK,this,this.onUpgradeBtnClick,[e,n]),this.upgradeBtn.label=w.convert(n),void(this.upgradeIcon.skin="UI/"+e.upgradeIcon+".png")}{t=this.getMinGoldIslandUpgrade(),this.upgradeBox.visible=!0;let e=Oe.instance.userData.getIslandConfigById(t.islandId),i=Oe.instance.userData.getIslandOutputGoldByCfg(e,t.islandLevel,t.managerLevel),a=(e.goldOutputFactor-1)*i;this.upgradeGoldDesc.text="+"+w.convert(a),this.upgradeIslandLevel.text="Lv."+t.islandLevel,this.upgradeIslandName.text=e.islandName+"  升级";let n=e.upgradeIslandCost*Math.pow(e.goldCostFactor,t.islandLevel-1);return this.upgradeBtn.on(Laya.Event.CLICK,this,this.onUpgradeBtnClick,[e,n]),this.upgradeBtn.label=w.convert(n),void(this.upgradeIcon.skin="UI/"+e.upgradeIcon+".png")}}getMinGoldIslandUpgrade(){let e=Oe.instance.userData.getUnlockIslandInfos(),t=0,i=null;for(let a=e.length-1;a>=0;a--){const n=e[a];let s=n.islandLevel,o=Oe.instance.userData.getIslandConfigById(n.islandId),r=o.upgradeIslandCost*Math.pow(o.goldCostFactor,s-1);(0==t||r<t)&&(i=n,t=r)}return i}checkIslandUpgrade(){let e=Oe.instance.userData.getUnlockIslandInfos();for(let t=e.length-1;t>=0;t--){const i=e[t];let a=i.islandLevel,n=Oe.instance.userData.getIslandConfigById(i.islandId);if(n.upgradeIslandCost*Math.pow(n.goldCostFactor,a-1)<=Oe.instance.userData.mGold)return i}return null}checkUnlock(){let e=Oe.instance.userData.getLockIslandInfos();for(let t=0;t<e.length;t++){const i=e[t];if(Oe.instance.userData.getIslandConfigById(i.islandId).upgradeIslandCost<=Oe.instance.userData.mGold)return i}return null}checkHamsterUpgrade(){}checkBuyHamster(){}showUnlandNoticeInfo(e){}onUpgradeBtnClick(e,i,a){if(i>Oe.instance.userData.mGold){let e=Oe.instance.errorTouchManager.getIsOpenErrorTouch();return Oe.instance.eventManager.fire(t.goldNotEnough,e),void w.showNoticeLabel("金币不足!")}Oe.instance.userData.upgradeIslandById(e.id),Oe.instance.userData.subGold(i),Oe.instance.eventManager.fire(t.ui_upgradeIsland,e.id)}onUnlockBtnClick(e,i){e.upgradeIslandCost>Oe.instance.userData.mGold?console.log("金币不足"):(Oe.instance.userData.upgradeIslandById(e.id),Oe.instance.userData.subGold(e.upgradeIslandCost),Oe.instance.eventManager.fire(t.ui_unlockIsland,e.id))}eggBornHamster(){this.hideUI()}eggBornHamsterComplete(){this.showUI(),this.showBottomNotice()}buyHamster(){this.hideUI()}buyHamsterComplete(){this.showUI(),this.showBottomNotice()}unlockIsland(){this.hideUI()}upgradeIsland(e){let t=Oe.instance.userData.getIslandInfoById(e);t.islandLevel!=y.islandLevel1&&t.islandLevel!=y.islandLevel2||this.hideUI()}unlockIslandComplete(){this.showUI(),this.showBottomNotice()}hideUI(){Laya.Tween.to(this.bottomAnimBox,{y:280},300,null,Laya.Handler.create(this,function(){})),Laya.Tween.to(this.bottomRightAnimBox,{y:280},300,null,Laya.Handler.create(this,function(){})),Laya.Tween.to(this.bottomLeftAnimBox,{y:280},300,null,Laya.Handler.create(this,function(){})),this.topBox.visible=!1,this.topRightBox.visible=!1}showUI(){Laya.Tween.to(this.bottomAnimBox,{y:0},300,null,Laya.Handler.create(this,function(){})),Laya.Tween.to(this.bottomRightAnimBox,{y:0},300,null,Laya.Handler.create(this,function(){})),Laya.Tween.to(this.bottomLeftAnimBox,{y:0},300,null,Laya.Handler.create(this,function(){})),this.topBox.visible=!0,this.topRightBox.visible=!0}openUpgradeIslandView(){this.hideBottomNoticeInfo()}closeUpgradeIslandView(){this.isCanShowBottomNotice=!0,this.showBottomNotice()}hideBottomNoticeInfo(){this.isCanShowBottomNotice=!1,this.lockItemBox.visible=!1,this.upgradeBox.visible=!1}openHamsterView(){this.hideBottomNoticeInfo()}closeHamsterView(){this.isCanShowBottomNotice=!0,this.showBottomNotice()}onAchievementBtnClick(){Oe.instance.scenesManager.openScene(y.AchievementView,Laya.Handler.create(this,function(e){}),!1)}onPandaBtnClick(){Oe.instance.scenesManager.openScene(y.NewUserGiftView,Laya.Handler.create(this,function(e){}),!1)}onClothBtnClick(){Oe.instance.scenesManager.openScene(y.ClothHamsterView,Laya.Handler.create(this,function(e){}),!1)}onSignBtnClick(){this.showSignView()}showSignView(){if(this.isOpenSignView)return;this.isOpenSignView=!0;let e=new kt,t=this;e.closeCallBack=function(){t.isOpenSignView=!1},e.show(!1,!1)}showIconAd(){if(!Laya.Browser.onQGMiniGame&&!Laya.Browser.onVVMiniGame)return;let e=this,t=Oe.instance.ad.getNativeAdRes();if(this.adRes=t,t&&(t.icon||t.imgUrlList.length>0)){let i="";i=t.icon?t.icon:t.imgUrlList[0],this.adIcon.skin=i,e.topIconAdAnim.visible=!0,Oe.instance.ad.reportAdShow(this.adRes.adId)}else e.topIconAdAnim.visible=!1}onAdIconClick(){if(Laya.Browser.onQGMiniGame||Laya.Browser.onVVMiniGame){console.log("点击广告");let e="1";this.adRes&&(e=this.adRes.adId),Oe.instance.ad.reportAdClick(e)}}vivoAdReportClick(){this.showIconAd()}openAchievementView(){}closeAchievementView(){}}class Tt extends e.MissionViewUI{constructor(){super(),this.progressNum=0,this.totalNum=0}onEnable(){this.init(),Oe.instance.eventManager.fire(t.ui_openMissionView)}onDisable(){Oe.instance.eventManager.fire(t.ui_closeMissionView)}init(){this.initObj(),this.showInfo()}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onGetBtnClick),this.gotoBtn.on(Laya.Event.CLICK,this,this.onGotoBtnClick)}showInfo(){this.config=Oe.instance.userData.getCurMissionConfig();let e=Oe.instance.userData.getCurMissionDesc();this.missionDesc.text=e,this.progressNum=dt.instance.getMissionProgress(),this.totalNum=dt.instance.getTotalCount(),this.missionProgress.value=this.progressNum/this.totalNum,this.progressLabel.text=this.progressNum+"/"+this.totalNum;let t=Oe.instance.userData.getRewardInfoByType(this.config.rewardType,this.config.rewardParam);this.rewardDesc.text=t.rewardDesc,this.icon.skin=t.iconSkin,this.gotoBtn.visible=!1,this.progressNum>=this.totalNum?this.getBtn.disabled=!1:this.getBtn.disabled=!0}onGetBtnClick(){let e=0;switch(this.config.rewardType){case r.heart:e=12*Oe.instance.userData.getHeartProduce()*this.config.rewardParam,Oe.instance.userData.addHeart(e),w.playRewardEffect(r.heart);break;case r.gold:e=60*Oe.instance.userData.getGoldTotalProduce()*this.config.rewardParam,Oe.instance.userData.addGold(e),w.playRewardEffect(r.gold);break;case r.diamond:e=this.config.rewardParam,Oe.instance.userData.addDiamond(e),w.playRewardEffect(r.diamond);break;case r.doubleTicket:Ue.instance.addDoubleTime(60*this.config.rewardParam),w.playRewardEffect(r.doubleTicket)}w.aldEventByTypeParam(c.data_missionComplete,this.config.id.toString(),this.config.id.toString()),Oe.instance.userData.missionComplete(),dt.instance.missionComplete(),this.showInfo(),Oe.instance.eventManager.fire(t.mission_get)}onGotoBtnClick(){switch(this.config.missionType){case o.unlockIsland:case o.upgradeIsland:case o.upgradeManager:null==this.parent.getChildByName("UpgradeIslandView")&&Oe.instance.scenesManager.openScene(y.UpgradeIslandView,Laya.Handler.create(this,function(e){}),!1);break;case o.collectHeart:break;case o.upgradeHamster:null==this.parent.getChildByName("HamsterView")&&Oe.instance.scenesManager.openScene(y.HamsterView,Laya.Handler.create(this,function(e){}),!1)}this.onCloseBtnClick()}onCloseBtnClick(){this.close()}}class xt extends e.NewGuideViewUI{constructor(){super(),this.curStep=1,this.tempPos=new Laya.Point,this.isClickShareBtn=!1}onEnable(){this.init()}onDisable(){}init(){this.initObj(),this.startBtn.visible=!1,this.dialogueBox.visible=!1,this.handBox.visible=!1,this.islandBtn.visible=!1,this.hamsterBtn.visible=!1,this.hideNoticeBox(3),this.hideNoticeBox(15),this.hideNoticeBox(21),this.hideNoticeBox(25),this.completeRewardBox.visible=!1,this.playVideo(),Oe.instance.eventManager.on(t.newGuide_guideBowComplete,this,this.guideBowComplete),Oe.instance.eventManager.on(t.ui_unlockIslandComplete,this,this.unlockIslandComplete),Oe.instance.eventManager.on(t.ui_buyHamsterComplete,this,this.buyHamsterComplete)}initObj(){this.startBtn.on(Laya.Event.CLICK,this,this.onStartBtnClick),this.confirmBtn.on(Laya.Event.CLICK,this,this.onConfirmBtnClick),this.noticeCloseBtn.on(Laya.Event.CLICK,this,this.onNoticeCloseBtnClick),this.noticeCloseBtn15.on(Laya.Event.CLICK,this,this.onNoticeCloseBtnClick15),this.noticeCloseBtn21.on(Laya.Event.CLICK,this,this.onNoticeCloseBtnClick21),this.noticeCloseBtn25.on(Laya.Event.CLICK,this,this.onNoticeCloseBtnClick25),this.completeRewardCloseBtn.on(Laya.Event.CLICK,this,this.onRewardCloseBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onGetRewardBtnClick),this.guideClickBtn.on(Laya.Event.CLICK,this,this.onGuideClickBtnClick),this.jumpAnimBtn.on(Laya.Event.CLICK,this,this.onJumpAnimBtnClick)}guideBowComplete(){this.startBtn.visible=!0}onStartBtnClick(){this.curStep=1,this.startBtn.visible=!1,this.startDialogue()}startDialogue(){this.confirmBtn.visible=!1,this.dialogueBox.visible=!1,1==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="欢迎来到 “仓鼠小岛”！",this.showCharactersAnim()):2==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="先给可爱的仓鼠建造一个 “农场” 吧！",this.showCharactersAnim()):3==this.curStep?this.dialogueBox.visible=!1:4==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="解锁农场后，小岛会自动生产 金币。",this.showCharactersAnim()):5==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="点击金币图标，可以收集金币。",this.showCharactersAnim()):6==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="您可以使用金币来升级 小岛。",this.showCharactersAnim()):7==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="将 “农场” 升到5级。",this.showCharactersAnim()):11==this.curStep?this.showGuideBtn9():9==this.curStep||10==this.curStep||12==this.curStep?(12==this.curStep&&(this.curStep=15),this.showGuideBtn11()):16==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="抚摸仓鼠可以获得 “爱心”。",this.curStep++,this.curStep++,this.showCharactersAnim()):17==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="您可以使用 “爱心” 邀请新伙伴。",this.showCharactersAnim()):18==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="抚摸仓鼠可以获得 “爱心”。",this.showCharactersAnim()):19==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="可以使用 “爱心” 邀请新伙伴啦！",this.curStep++,this.showCharactersAnim()):20==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="现在，就用爱心邀请一个新伙伴吧！",this.showCharactersAnim()):22==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="给农场邀请一个 “农夫”，可以自动收集金币。",this.showCharactersAnim()):23==this.curStep?(this.dialogueBox.visible=!0,this.contentLabel.text="可以使用 “爱心” 邀请 “农夫”。",this.showCharactersAnim()):24==this.curStep&&(this.dialogueBox.visible=!0,this.contentLabel.text="邀请一个 “农夫”仓鼠，为农场工作。",this.showCharactersAnim()),26==this.curStep&&(this.dialogueBox.visible=!0,this.contentLabel.text="恭喜 完成了所有的引导！",this.showCharactersAnim()),27==this.curStep&&(this.dialogueBox.visible=!0,this.contentLabel.text="现在，我们就去为可爱的 仓鼠 建造美丽的家园吧！",this.showCharactersAnim())}showCharactersAnim(){let e=this.contentLabel.width;this.contentLabel.width=1,Laya.Tween.to(this.contentLabel,{width:e},1500,null,Laya.Handler.create(this,function(){this.dialogueComplete()}))}dialogueComplete(){1==this.curStep?this.confirmBtn.visible=!0:2==this.curStep?this.showGuideBtn2():4==this.curStep?this.confirmBtn.visible=!0:5==this.curStep?this.showGuideBtn5():6==this.curStep?this.confirmBtn.visible=!0:7==this.curStep?this.showGuideBtn2():16==this.curStep||17==this.curStep?this.confirmBtn.visible=!0:18==this.curStep?this.showGuideBtn18():19==this.curStep?this.confirmBtn.visible=!0:20==this.curStep?this.showGuideBtn20():22==this.curStep?(this.curStep+=2,this.showGuideBtn2()):23==this.curStep?this.confirmBtn.visible=!0:24==this.curStep&&this.showGuideBtn2(),26!=this.curStep&&27!=this.curStep||(this.confirmBtn.visible=!0)}onConfirmBtnClick(){27==this.curStep?(this.confirmBtn.visible=!1,this.dialogueBox.visible=!1,this.showGuideCompleteReward()):this.nextStep()}nextStep(){this.curStep++,this.startDialogue(),w.aldEventByTypeParam2(c.data_newGuideStep,this.curStep.toString(),this.curStep.toString())}showGuideBtn2(){this.handBox.visible=!0,this.islandBtn.visible=!0;let e=new Laya.Point(this.islandBtn.x,this.islandBtn.y);e=this.islandBtn.parent.localToGlobal(e),this.handBox.pos(e.x,e.y)}showGuideBtn3(e){this.handBox.visible=!0,this.islandBtn.visible=!1,this.updateGuideBtn3(e),Oe.instance.timeManager.loop(.1,this,this.updateGuideBtn3,[e])}updateGuideBtn3(e){this.tempPos.x=e.x,this.tempPos.y=e.y,this.tempPos=e.parent.localToGlobal(this.tempPos),this.handBox.pos(this.tempPos.x,this.tempPos.y)}showGuideBtn5(){let e=ot.instance.getIslandById(1);this.handBox.visible=!0,this.updateGuideBtn5(e.hudGoldLogic.hudImage),Oe.instance.timeManager.loop(.1,this,this.updateGuideBtn5,[e.hudGoldLogic.hudImage])}updateGuideBtn5(e){this.handBox.pos(e.x,e.y),this.guideClickBtn.visible=e.visible}showGuideBtn8(e){this.btn8=e,this.showGuideBtn3(e)}showGuideBtn9(){this.showGuideBtn5()}showGuideBtn11(){this.showGuideBtn8(this.btn8)}showGuideBtn18(){let e=wt.instance.getHamsterGuide();this.handBox.visible=!0,this.updateGuideBtn18(e.image),Oe.instance.timeManager.loop(.1,this,this.updateGuideBtn18,[e.image])}updateGuideBtn18(e){this.handBox.pos(e.x,e.y),this.guideClickBtn.visible=e.visible}showGuideBtn20(){this.handBox.visible=!0,this.hamsterBtn.visible=!0;let e=new Laya.Point(this.hamsterBtn.x,this.hamsterBtn.y);e=this.hamsterBtn.parent.localToGlobal(e),this.handBox.pos(e.x,e.y)}showGuideBtn21(e){this.handBox.visible=!0,this.hamsterBtn.visible=!1,this.updateGuideBtn21(e),Oe.instance.timeManager.loop(.1,this,this.updateGuideBtn21,[e])}updateGuideBtn21(e){this.tempPos.x=e.x,this.tempPos.y=e.y,this.tempPos=e.parent.localToGlobal(this.tempPos),this.handBox.pos(this.tempPos.x,this.tempPos.y)}showGuideBtn25(e){this.handBox.visible=!0,this.islandBtn.visible=!1,this.updateGuideBtn25(e),Oe.instance.timeManager.loop(.1,this,this.updateGuideBtn25,[e])}updateGuideBtn25(e){this.tempPos.x=e.x,this.tempPos.y=e.y,this.tempPos=e.parent.localToGlobal(this.tempPos),this.handBox.pos(this.tempPos.x,this.tempPos.y)}onGuideClickBtnClick(){if(this.handBox.visible=!1,2==this.curStep)this.onIslandBtnClick();else if(3==this.curStep)Oe.instance.timeManager.clear(this,this.updateGuideBtn3),Oe.instance.eventManager.fire(t.newGuide_Click,this.curStep);else if(5==this.curStep){ot.instance.getIslandById(1).hudGoldLogic.hudImage.event(Laya.Event.CLICK),Oe.instance.timeManager.clear(this,this.updateGuideBtn5),this.nextStep()}else if(7==this.curStep)this.onIslandBtnClick();else if(8==this.curStep||9==this.curStep||10==this.curStep||15==this.curStep)Oe.instance.timeManager.clear(this,this.updateGuideBtn3),Oe.instance.eventManager.fire(t.newGuide_Click,this.curStep),15!==this.curStep&&this.nextStep();else if(11==this.curStep){ot.instance.getIslandById(1).hudGoldLogic.hudImage.event(Laya.Event.CLICK),Oe.instance.timeManager.clear(this,this.updateGuideBtn5),this.nextStep()}else if(18==this.curStep){wt.instance.getHamsterGuide().image.event(Laya.Event.CLICK),Oe.instance.timeManager.clear(this,this.updateGuideBtn18),this.nextStep()}else 20==this.curStep?this.onHamsterBtnClick():21==this.curStep?(Oe.instance.timeManager.clear(this,this.updateGuideBtn21),Oe.instance.eventManager.fire(t.newGuide_Click,this.curStep)):24==this.curStep?this.onIslandBtnClick():25==this.curStep&&(Oe.instance.timeManager.clear(this,this.updateGuideBtn25),Oe.instance.eventManager.fire(t.newGuide_Click,this.curStep),Oe.instance.timeManager.onceExecute(2.5,this,this.buyManagerComplete))}onNoticeCloseBtnClick(){this.hideNoticeBox(3),this.nextStep()}onNoticeCloseBtnClick15(){this.hideNoticeBox(15),Oe.instance.userData.addHeart(500),w.playRewardEffect(r.heart),this.nextStep()}onNoticeCloseBtnClick21(){this.hideNoticeBox(21),this.nextStep()}onNoticeCloseBtnClick25(){this.hideNoticeBox(25),this.nextStep()}showNoticeBox(e){this.noticeBox.visible=!0,3==e?this.notice3.visible=!0:15==e?this.notice15.visible=!0:21==e?this.notice21.visible=!0:25==e&&(this.notice25.visible=!0)}hideNoticeBox(e){this.noticeBox.visible=!1,3==e?this.notice3.visible=!1:15==e?this.notice15.visible=!1:21==e?this.notice21.visible=!1:25==e&&(this.notice25.visible=!1)}onIslandBtnClick(){let e=this.parent.getChildIndex(this),t=this;Oe.instance.scenesManager.openScene(y.UpgradeIslandView,Laya.Handler.create(this,function(i){t.parent.addChildAt(i,e),t.openIslandComplete(i)}),!1)}openIslandComplete(e){let t=this;if(t.nextStep(),3==this.curStep){let i=e.getUnlockIslandBtn();t.showGuideBtn3(i)}else if(8==this.curStep){let t=e.getUpgradeIslandBtn();this.showGuideBtn8(t)}else if(25==this.curStep){let t=e.getUpgradeManagerBtn();this.showGuideBtn25(t)}}onHamsterBtnClick(){let e=this.parent.getChildIndex(this),t=this;Oe.instance.scenesManager.openScene(y.HamsterView,Laya.Handler.create(this,function(i){t.parent.addChildAt(i,e),t.openHamsterComplete(i)}),!1)}openHamsterComplete(e){this.nextStep(),21==this.curStep&&this.showGuideBtn21(e.buyBtn)}unlockIslandComplete(e){15==this.curStep?this.showNoticeBox(15):3==this.curStep&&this.showNoticeBox(3)}buyHamsterComplete(){21==this.curStep&&this.showNoticeBox(21)}buyManagerComplete(){25==this.curStep&&this.showNoticeBox(25)}showGuideCompleteReward(){this.completeRewardBox.visible=!0;let e=this.parent.getChildIndex(this),t=this;Oe.instance.scenesManager.openScene(y.MainView,Laya.Handler.create(this,function(i){t.parent.addChildAt(i,e),Oe.instance.setSceneUI(i)}),!1)}adSuccess(){Oe.instance.userData.addGold(1e4),Oe.instance.userData.addHeart(2e3),w.playRewardEffect(r.gold),w.playRewardEffect(r.heart),Oe.instance.eventManager.fire(t.newGuide_allComplete),this.close()}onRewardCloseBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adSuccess(),w.statisticsData(c.ad_newGuideGift,!0)):w.statisticsData(c.ad_newGuideGift,!1)})}onGetRewardBtnClick(){Oe.instance.userData.addGold(5e3),Oe.instance.userData.addHeart(1e3),w.playRewardEffect(r.gold),w.playRewardEffect(r.heart),Oe.instance.eventManager.fire(t.newGuide_allComplete),this.close()}playVideo(){this.videoIndex1=1,this.videoRepeat1=0,this.videoImg.alpha=0,Laya.Tween.to(this.videoImg,{alpha:.3},600,null,Laya.Handler.create(this,function(){Laya.Tween.to(this.videoImg,{alpha:.6},200,null,Laya.Handler.create(this,function(){Laya.Tween.to(this.videoImg,{alpha:1},200,null,Laya.Handler.create(this,function(){}))}))})),Oe.instance.timeManager.loop(.3,this,this.changeImg1)}changeImg1(){let e="cg/"+this.videoIndex1+".jpg";if(this.videoImg.skin=e,this.videoIndex1++,this.videoIndex1>4&&(this.videoIndex1=1,this.videoRepeat1++,2==this.videoRepeat1))return this.videoIndex2=5,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg1),void Oe.instance.timeManager.loop(.3,this,this.changeImg2)}changeImg2(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>9&&(this.videoIndex2=5,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=10,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg2),void Oe.instance.timeManager.loop(.3,this,this.changeImg3)}changeImg3(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>14&&(this.videoIndex2=10,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=14,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg3),void Oe.instance.timeManager.loop(.3,this,this.changeImg4)}changeImg4(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>20&&(this.videoIndex2=14,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=21,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg4),void Oe.instance.timeManager.loop(.3,this,this.changeImg5)}changeImg5(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>25&&(this.videoIndex2=21,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=26,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg5),void Oe.instance.timeManager.loop(.3,this,this.changeImg6)}changeImg6(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>29&&(this.videoIndex2=26,this.videoRepeat1++,2==this.videoRepeat1))return this.videoIndex2=30,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg6),void Oe.instance.timeManager.loop(.4,this,this.changeImg7)}changeImg7(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>33&&(this.videoIndex2=30,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=34,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg7),void Oe.instance.timeManager.loop(.3,this,this.changeImg8)}changeImg8(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>35&&(this.videoIndex2=34,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=36,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg8),void Oe.instance.timeManager.loop(.3,this,this.changeImg9)}changeImg9(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>41&&(this.videoIndex2=36,this.videoRepeat1++,1==this.videoRepeat1))return this.videoIndex2=42,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg9),void Oe.instance.timeManager.loop(.3,this,this.changeImg10)}changeImg10(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>43&&(this.videoIndex2=42,this.videoRepeat1++,2==this.videoRepeat1))return this.videoIndex2=44,this.videoRepeat1=0,Oe.instance.timeManager.clear(this,this.changeImg10),void Oe.instance.timeManager.loop(.3,this,this.changeImg11)}changeImg11(){let e="cg/"+this.videoIndex2+".jpg";if(this.videoImg.skin=e,this.videoIndex2++,this.videoIndex2>49&&(this.videoIndex2=44,this.videoRepeat1++,1==this.videoRepeat1))return Oe.instance.timeManager.clear(this,this.changeImg11),void this.videoComplete()}videoComplete(){w.aldEventByType(c.data_videoComplete),Laya.Tween.to(this.videoImg,{alpha:0},500,null,Laya.Handler.create(this,function(){this.cgBox.visible=!1,Oe.instance.eventManager.fire(t.newGuide_cgComplete)}))}onJumpAnimBtnClick(){Laya.Tween.clearAll(this.videoImg),Oe.instance.timeManager.clearAll(this),this.videoComplete()}}class Gt extends e.NewUserGiftViewUI{constructor(){super(),this.isClickShareBtn=!1}onEnable(){this.init()}init(){this.initObj(),this.showRewardInfo()}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.adBtn.on(Laya.Event.CLICK,this,this.onAdBtnClick)}showRewardInfo(){Oe.instance.userData.mNewGiftAdTimes;this.adBtn.label="       领取"}adSuccess(){Oe.instance.userData.addNewGiftAdTimes();this.showRewardInfo();let e=0,i=0;e=720*Oe.instance.userData.getHeartProduce(),i=60*Oe.instance.userData.getGoldTotalProduce()*60,Oe.instance.userData.addHeart(e),Oe.instance.userData.addGold(i),Oe.instance.userData.addDiamond(100),w.playRewardEffect(r.heart),w.playRewardEffect(r.gold),w.playRewardEffect(r.diamond),Oe.instance.userData.buyHamsterCloth(1),Oe.instance.eventManager.fire(t.ui_buyHamsterCloth,1),w.showNoticeLabel("领取成功！"),Oe.instance.eventManager.fire(t.gift_get),this.onCloseBtnClick()}onAdBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adSuccess(),w.statisticsData(c.ad_newGift,!0)):w.statisticsData(c.ad_newGift,!1)})}onCloseBtnClick(){this.close()}}class _t extends e.OfflineRewardViewUI{constructor(){super(),this.heartCount=0,this.goldCount=0,this.rewardFactor=2,this.isClickShareBtn=!1}onEnable(){this.init()}onDisable(){}init(){this.initObj(),this.showInfo()}initObj(){this.doubleBtn.on(Laya.Event.CLICK,this,this.onDoubleBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onGetBtnClick)}showInfo(){let e=Oe.instance.userData.offlineTime,t=Oe.instance.userData.getHeartProduce(),i=Oe.instance.userData.getGoldTotalProduce(),a=0,n=0;this.rewardFactor=2,this.rewardFactor=e<=120?10:e>120&&e<=300?5:e>300&&e<=600?3:2,e>600?(a=120*t,n=10*i*60):(a=12*e*t/60,n=e*i),this.heartCount=a,this.goldCount=n,this.heartLabel.text="x "+w.convert(a),this.goldLabel.text="x "+w.convert(n)}adSuccess(){Oe.instance.userData.addGold(this.goldCount*this.rewardFactor),w.playRewardEffect(r.gold),Oe.instance.userData.addGold(this.heartCount*this.rewardFactor),w.playRewardEffect(r.heart),this.close()}onDoubleBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adSuccess(),w.statisticsData(c.ad_offline,!0)):w.statisticsData(c.ad_offline,!1)})}onGetBtnClick(){Oe.instance.userData.addGold(this.goldCount),w.playRewardEffect(r.gold),Oe.instance.userData.addGold(this.heartCount),w.playRewardEffect(r.heart),this.close()}}class Mt extends e.test.TestSceneUI{constructor(){super();var e=Laya.stage.addChild(new Laya.Scene3D),t=e.addChild(new Laya.Camera(0,.1,100));t.transform.translate(new Laya.Vector3(0,3,3)),t.transform.rotate(new Laya.Vector3(-30,0,0),!0,!1);var i=e.addChild(new Laya.DirectionLight);i.color=new Laya.Vector3(.6,.6,.6),i.transform.worldMatrix.setForward(new Laya.Vector3(1,-1,0));var a=e.addChild(new Laya.MeshSprite3D(Laya.PrimitiveMesh.createBox(1,1,1)));a.transform.rotate(new Laya.Vector3(0,45,0),!1,!1);var n=new Laya.BlinnPhongMaterial;Laya.Texture2D.load("res/layabox.png",Laya.Handler.create(null,function(e){n.albedoTexture=e})),a.meshRenderer.material=n}}class Ht extends e.TreasureViewUI{constructor(){super(),this.isClickShareBtn=!1,this.goldRewardNum=0,this.heartRewardNum=0,this.diamondRewardNum=0,this.boxRewardNum=0}onEnable(){this.init()}onDisable(){}init(){this.initObj(),this.showInfo(),this.closeBoxBtn.visible=!1,Oe.instance.timeManager.onceExecute(2,this,this.delayShowCloseBtn)}initObj(){this.openBoxBtn.on(Laya.Event.CLICK,this,this.onOpenBoxBtnClick),this.closeBoxBtn.on(Laya.Event.CLICK,this,this.onCloseBoxBtnClick),this.fiveBoxRewardBtn.on(Laya.Event.CLICK,this,this.onGetBoxBtnClick),this.getBoxBtn.on(Laya.Event.CLICK,this,this.onGetBoxBtnClick),this.adBtn.on(Laya.Event.CLICK,this,this.onAdBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onGetBtnClick)}delayShowCloseBtn(){this.closeBoxBtn.visible=!0}showInfo(){let e=w.random(1,100);Oe.instance.userData.mIsFirstTreasure&&(e=1,this.openBoxBtnAdBg.visible=!1),e<=30?(this.openBox.visible=!0,this.boxReward.visible=!1,this.reward.visible=!1):(this.openBox.visible=!1,this.boxReward.visible=!1,this.reward.visible=!0,this.showReward())}showReward(){let e=Oe.instance.userData.getGoldTotalProduce()*w.random(180,240);this.boxRewardNum=e,this.rewardLabel.text=w.convert(e)}showBoxReward(){this.openBox.visible=!1,this.boxReward.visible=!0,this.reward.visible=!1;let e=Oe.instance.userData.getGoldTotalProduce(),t=w.random(180,240);this.goldRewardNum=e*t;let i=Oe.instance.userData.getHeartProduce(),a=w.random(120,180);this.heartRewardNum=i*a/5,this.diamondRewardNum=w.random(50,100),this.diamondReward.text="x "+this.diamondRewardNum,this.goldReward.text=w.convert(this.goldRewardNum),this.heartReward.text=w.convert(this.heartRewardNum)}adOpenSuccess(){this.showBoxReward()}onOpenBoxBtnClick(){if(Oe.instance.userData.mIsFirstTreasure)return this.adOpenSuccess(),void Oe.instance.userData.setIsFirstTreasure();if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adOpenSuccess(),w.statisticsData(c.ad_openBox,!0)):w.statisticsData(c.ad_openBox,!1)})}onCloseBoxBtnClick(){this.close()}adFiveBoxRewardSuccess(){Oe.instance.userData.addGold(5*this.goldRewardNum),Oe.instance.userData.addHeart(5*this.heartRewardNum),Oe.instance.userData.addDiamond(5*this.diamondRewardNum),w.playRewardEffect(r.diamond),w.playRewardEffect(r.gold),w.playRewardEffect(r.heart),this.onCloseBoxBtnClick()}onFiveBoxRewardBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adFiveBoxRewardSuccess(),w.statisticsData(c.ad_fiveBoxReward,!0)):w.statisticsData(c.ad_fiveBoxReward,!1)})}onGetBoxBtnClick(){Oe.instance.userData.addGold(this.goldRewardNum),Oe.instance.userData.addHeart(this.heartRewardNum),Oe.instance.userData.addDiamond(this.diamondRewardNum),w.playRewardEffect(r.diamond),w.playRewardEffect(r.gold),w.playRewardEffect(r.heart),this.onCloseBoxBtnClick()}adSuccess(){Oe.instance.userData.addGold(5*this.boxRewardNum),w.playRewardEffect(r.gold),this.onCloseBoxBtnClick()}onAdBtnClick(){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let e=this;Oe.instance.ad.showAd(function(t){e.isClickShareBtn=!1,t?(e.adSuccess(),w.statisticsData(c.ad_getBox,!0)):w.statisticsData(c.ad_getBox,!1)})}onGetBtnClick(){Oe.instance.userData.addGold(this.boxRewardNum),w.playRewardEffect(r.gold),this.onCloseBoxBtnClick()}}class Kt extends e.UpgradeIslandViewUI{constructor(){super(),this.adOffsetY=170,this.offsetY=0,this.isClickShareBtn=!1}onEnable(){this.openUIAnim(),Oe.instance.eventManager.fire(t.ui_openUpgradeIslandView),this.init(),Oe.instance.eventManager.on(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}onDisable(){Oe.instance.eventManager.off(t.updateGold,this,this.updateGold),Oe.instance.eventManager.fire(t.ui_closeUpgradeIslandView),Oe.instance.eventManager.off(t.newGuide_Click,this,this.newGuideClick),Oe.instance.eventManager.off(t.vivo_ad_reportClick,this,this.vivoAdReportClick)}init(){this.initObj(),this.showAdItem(),this.showItemList(),Oe.instance.eventManager.on(t.updateGold,this,this.updateGold),0==Oe.instance.newGuide.isCompleteGuide&&Oe.instance.eventManager.on(t.newGuide_Click,this,this.newGuideClick)}initObj(){this.closeBtn.on(Laya.Event.CLICK,this,this.onCloseBtnClick),this.adItemBox.on(Laya.Event.CLICK,this,this.onAdItemClick),this.adItemBtn.on(Laya.Event.CLICK,this,this.onAdItemClick)}newGuideClick(e){if(3==e){let e=this.getUnlockIslandBtn(),t=this.lockList.getItem(0);e.event(Laya.Event.CLICK,t.cfg)}else if(8==e||9==e||10==e||15==e){let e=this.getUpgradeIslandBtn(),t=this.unlockList.getItem(0),i=t.cfg,a=t.cfg.upgradeIslandCost*Math.pow(t.cfg.goldCostFactor,t.info.islandLevel-1);e.event(Laya.Event.CLICK,[i,a])}else if(25==e){let e=this.getUpgradeManagerBtn(),t=this.unlockList.getItem(0),i=t.cfg,a=t.cfg.upgradeManagerHeartCost*Math.pow(t.cfg.managerHeartCostFactor,t.info.managerLevel);e.event(Laya.Event.CLICK,[i,a,t.info.managerLevel])}}updateGold(){this.unlockList.refresh(),this.lockList.refresh()}showItemList(){this.panel.vScrollBarSkin="";let e=Oe.instance.userData.islandConfigs,t=[],i=[];for(let a=0;a<e.length;a++){const n=e[a];let s=Oe.instance.userData.getIslandInfoById(n.id),o={info:s,cfg:n,islandName:{text:n.islandName},icon:{skin:"UI/"+n.islandIcon+".png"},icon2:{skin:"UI/"+n.upgradeIcon+".png"},iconManager:{skin:"UI/"+n.managerIcon+".png"},islandName2:{text:n.islandName+"  升级"}};0==s.islandLevel?t.push(o):i.push(o)}let a=this.adOffsetY;if(0===i.length)this.unlockList.visible=!1;else{this.unlockList.renderHandler=new Laya.Handler(this,this.renderHandler_unlock),this.unlockList.array=i;let e=250*i.length;this.unlockList.height=e,this.unlockList.y=a}if(0===t.length)this.lockList.visible=!1;else{this.lockList.renderHandler=new Laya.Handler(this,this.renderHandler_lock),this.lockList.array=t;let e=250*i.length+a;this.lockList.y=e;let n=108*t.length;this.lockList.height=n,this.offsetY=e}}scrollToLock(){let e=this;Oe.instance.timeManager.frameOnce(2,this,function(){e.panel.scrollTo(0,e.offsetY-30),console.log(e.offsetY)})}renderHandler_lock(e,t){let i=this.lockList.getItem(t),a=e.getChildByName("lockBox"),n=e.getChildByName("unlockBtn"),s=i.cfg;if(s.upgradeIslandCost<=Oe.instance.userData.mGold)a.visible=!1,n.visible=!0,n.label=w.convert(s.upgradeIslandCost),n.on(Laya.Event.CLICK,this,this.onUnlockBtnClick,[s]);else{a.visible=!0,n.visible=!1,a.getChildByName("lockGoldNum").text=w.convert(s.upgradeIslandCost)}}onUnlockBtnClick(e,i){e.upgradeIslandCost>Oe.instance.userData.mGold?console.log("金币不足"):(Oe.instance.userData.upgradeIslandById(e.id),Oe.instance.userData.subGold(e.upgradeIslandCost),Oe.instance.eventManager.fire(t.ui_unlockIsland,e.id),this.onCloseBtnClick(),w.aldEventByType(c.data_unlockIsland+e.id))}renderHandler_unlock(e,t){let i=this.unlockList.getItem(t),a=i.cfg,n=Oe.instance.userData.getIslandOutputGoldByCfg(i.cfg,i.info.islandLevel,i.info.managerLevel);e.getChildByName("addGold").text=w.convert(n)+"/"+i.cfg.outputTime+"秒";let s=(a.goldOutputFactor-1)*n;e.getChildByName("goldDesc").text="+"+w.convert(s);let o=e.getChildByName("upgradeBtn"),r=e.getChildByName("upgradeFreeBtn"),h=e.getChildByName("noGoldBox"),l=i.cfg.upgradeIslandCost*Math.pow(i.cfg.goldCostFactor,i.info.islandLevel-1);if(l<=Oe.instance.userData.mGold)o.visible=!0,r.visible=!1,h.visible=!1,o.label=w.convert(l),o.on(Laya.Event.CLICK,this,this.onUpgradeBtnClick,[a,l]);else{o.visible=!1,r.visible=!0,h.visible=!1,h.getChildByName("noGoldLabel").text=w.convert(l),r.on(Laya.Event.CLICK,this,this.onUpgradeFreeBtnClick,[a])}e.getChildByName("islandLevel").text="Lv."+i.info.islandLevel;let d=e.getChildByName("upgradeManagerBtn"),c=e.getChildByName("upgradeManagerFreeBtn"),g=e.getChildByName("noHeartBox"),m=e.getChildByName("managerLevel"),u=e.getChildByName("managerName");m.text="Lv."+i.info.managerLevel;let v="";v=0==i.info.managerLevel?"  召唤":"  升级",u.text=a.managerName+v;let p=i.cfg.upgradeManagerHeartCost*Math.pow(i.cfg.managerHeartCostFactor,i.info.managerLevel);if(p<=Oe.instance.userData.mHeart)d.visible=!0,c.visible=!1,g.visible=!1,d.label=w.convert(p),d.on(Laya.Event.CLICK,this,this.onUpgradeManagerBtnClick,[a,p,i.info.managerLevel]);else{d.visible=!1,c.visible=!0,g.visible=!1,g.getChildByName("noHeartLabel").text=w.convert(p),c.on(Laya.Event.CLICK,this,this.onUpgradeManagerFreeBtnClick,[a,p,i.info.managerLevel])}let S=100*(a.managerGoldOutputFactor-1);S=Math.round(S),e.getChildByName("managerDesc").text="+"+S+"%"}upgradeFreeAdSuccess(e){Oe.instance.userData.upgradeIslandById(e.id),Oe.instance.eventManager.fire(t.ui_upgradeIsland,e.id);let i=Oe.instance.userData.getIslandInfoById(e.id);w.aldEventByTypeParam(c.data_upgradeIsland,e.id,i.islandLevel.toString()),i.islandLevel!=y.islandLevel1&&i.islandLevel!=y.islandLevel2||this.onCloseBtnClick()}onUpgradeFreeBtnClick(e,t){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let i=this;Oe.instance.ad.showAd(function(t){i.isClickShareBtn=!1,t&&i.upgradeFreeAdSuccess(e)})}onUpgradeBtnClick(e,i,a){if(i>Oe.instance.userData.mGold)return void console.log("金币不足");Oe.instance.userData.upgradeIslandById(e.id),Oe.instance.userData.subGold(i),Oe.instance.eventManager.fire(t.ui_upgradeIsland,e.id);let n=Oe.instance.userData.getIslandInfoById(e.id);w.aldEventByTypeParam(c.data_upgradeIsland,e.id,n.islandLevel.toString()),n.islandLevel!=y.islandLevel1&&n.islandLevel!=y.islandLevel2||this.onCloseBtnClick()}upgradeManagerFreeAdSuccess(e,i){Oe.instance.userData.upgradeManagerLevelById(e.id),0==i?(Oe.instance.eventManager.fire(t.ui_unlockManager,e.id),w.aldEventByType(c.data_unlockManager+e.id),this.onCloseBtnClick()):(Oe.instance.eventManager.fire(t.ui_upgradeManager,e.id),w.aldEventByTypeParam(c.data_upgradeManager,e.id,(i+1).toString()))}onUpgradeManagerFreeBtnClick(e,t,i,a){if(this.isClickShareBtn)return;this.isClickShareBtn=!0;let n=this;Oe.instance.ad.showAd(function(t){n.isClickShareBtn=!1,t&&n.upgradeManagerFreeAdSuccess(e,i)})}onUpgradeManagerBtnClick(e,i,a,n){i>Oe.instance.userData.mHeart?console.log("爱心不足"):(Oe.instance.userData.upgradeManagerLevelById(e.id),Oe.instance.userData.subHeart(i),0==a?(Oe.instance.eventManager.fire(t.ui_unlockManager,e.id),w.aldEventByType(c.data_unlockManager+e.id),this.onCloseBtnClick()):(Oe.instance.eventManager.fire(t.ui_upgradeManager,e.id),w.aldEventByTypeParam(c.data_upgradeManager,e.id,(a+1).toString())))}onCloseBtnClick(){this.closeUIAnim()}doCloseUI(){this.close()}closeUIAnim(){Laya.Tween.to(this.animRootBox,{x:450},200,null,Laya.Handler.create(this,this.doCloseUI))}openUIAnim(){Laya.Tween.to(this.animRootBox,{x:-50},200,null,Laya.Handler.create(this,function(){Laya.Tween.to(this.animRootBox,{x:0},100,null,Laya.Handler.create(this,function(){}))}))}getUnlockIslandBtn(){return this.lockList.getCell(0).getChildByName("unlockBtn")}getUpgradeIslandBtn(){return this.unlockList.getCell(0).getChildByName("upgradeBtn")}getUpgradeManagerBtn(){return this.unlockList.getCell(0).getChildByName("upgradeManagerBtn")}showAdItem(){if(!Laya.Browser.onQGMiniGame&&!Laya.Browser.onVVMiniGame)return;let e=this,t=Oe.instance.ad.getNativeAdRes();if(this.adRes=t,t&&(t.icon||t.imgUrlList.length>0)){let i="";i=t.icon?t.icon:t.imgUrlList[0],this.adItemIcon.skin=i,this.adItemDesc.text=t.desc,this.adItemName.text=t.title,e.adItemBox.visible=!0,Oe.instance.ad.reportAdShow(this.adRes.adId),this.adOffsetY=170}else this.adOffsetY=0,e.adItemBox.visible=!1,Oe.instance.ad.refreshNativeAd(function(e){})}onAdItemClick(){let e="1";this.adRes&&(e=this.adRes.adId),Oe.instance.ad.reportAdClick(e)}vivoAdReportClick(){this.showAdItem()}}class Ot{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("View/AchievementView.ts",Re),e("script/ButtonScale.ts",Fe),e("View/ClothHamsterView.ts",Xe),e("View/EggView.ts",Bt),e("View/HamsterView.ts",Lt),e("View/LoadingView.ts",At),e("View/MainView.ts",Pt),e("View/MissionView.ts",Tt),e("View/NewGuideView.ts",xt),e("View/NewUserGiftView.ts",Gt),e("View/OfflineRewardView.ts",_t),e("View/ShopView.ts",bt),e("View/SignView.ts",kt),e("script/GameUI.ts",Mt),e("View/TopDialog.ts",Nt),e("View/TreasureView.ts",Ht),e("View/UpgradeIslandView.ts",Kt)}}Ot.width=1280,Ot.height=720,Ot.scaleMode="fixedheight",Ot.screenMode="horizontal",Ot.alignV="top",Ot.alignH="left",Ot.startScene="MainView.scene",Ot.sceneRoot="",Ot.debug=!1,Ot.stat=!1,Ot.physicsDebug=!1,Ot.exportSceneToJson=!0,Ot.init();new class{constructor(){window.Laya3D?Laya3D.init(Ot.width,Ot.height):Laya.init(Ot.width,Ot.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=Ot.scaleMode,Laya.stage.screenMode=Ot.screenMode,Laya.stage.alignV=Ot.alignV,Laya.stage.alignH=Ot.alignH,Laya.URL.exportSceneToJson=Ot.exportSceneToJson,(Ot.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),Ot.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),Ot.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){Oe.instance.init()}}}();